(function(a,b){if(typeof define==="function"&&define.amd){define(["angular"],function(c){return(nf.ng.Bridge=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Bridge=b(require("angular")))}else{nf.ng.Bridge=b(a.angular)}}}(this,function(a){function b(){this.rootScope;this.injector}b.prototype={constructor:b,call:function(e,d){var h=e.split(".");var i=this.rootScope;a.forEach(h,function(j){i=i[j]});var f=d.split(".");d=this.rootScope;a.forEach(f,function(j){d=d[j]});var g=Array.prototype.slice.call(arguments,2);var c=d.apply(i,g);if(c){return c}},get:function(c){var d=c.split(".");var e=this.rootScope;a.forEach(d,function(f){e=e[f]});return e},digest:function(){this.rootScope.$digest()}};return new b()}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.ServiceProvider=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ServiceProvider=b())}else{nf.ng.ServiceProvider=b()}}}(this,function(){return function(){function a(){}a.prototype={constructor:a,register:function(c,b){this[c]=b},remove:function(b){delete this[b]}};return new a()}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.ClusterSummary=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ClusterSummary=b(require("jquery")))}else{nf.ClusterSummary=b(a.$)}}}(this,function(d){var c=false;var e=false;var b=false;var a={urls:{clusterSummary:"../nifi-api/flow/cluster/summary"}};return{loadClusterSummary:function(){return d.ajax({type:"GET",url:a.urls.clusterSummary,dataType:"json"}).done(function(f){var g=f;var h=g.clusterSummary;if(e!==h.connectedToCluster){b=true}c=h.clustered;e=h.connectedToCluster})},isClustered:function(){return c===true},isConnectedToCluster:function(){return e===true},didConnectedStateChange:function(){var f=b;b=false;return f}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.Storage=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Storage=b())}else{nf.Storage=b()}}}(this,function(){var g=86400000;var f=g*2;var b=function(h){return typeof h==="undefined"};var e=function(h){return h===null};var d=function(h){return !b(h)&&!e(h)};var c=function(j){if(d(j.expires)){var h=new Date(j.expires);var i=new Date();return h.valueOf()<i.valueOf()}else{return false}};var a=function(h){try{var i=JSON.parse(localStorage.getItem(h));if(d(i)){return i}else{return null}}catch(j){return null}};return{init:function(){for(var j=0;j<localStorage.length;j++){try{var h=localStorage.key(j);this.getItem(h)}catch(k){}}},setItem:function(i,k,h){h=d(h)?h:new Date().valueOf()+f;var j={expires:h,item:k};localStorage.setItem(i,JSON.stringify(j))},hasItem:function(h){return a(h)!==null},getItem:function(h){var i=a(h);if(i===null){return null}if(c(i)){this.removeItem(h);return null}if(d(i.item)){return i.item}else{return null}},getItemExpiration:function(h){var i=a(h);if(i===null){return null}if(d(i.expires)){return i.expires}else{return null}},removeItem:function(h){localStorage.removeItem(h)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Storage"],function(d,c){return(nf.AjaxSetup=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.AjaxSetup=b(require("jquery"),require("nf.Storage")))}else{nf.AjaxSetup=b(a.$,a.nf.Storage)}}}(this,function(b,a){b(document).ready(function(c){c.ajaxSetup({beforeSend:function(f){var d=a.hasItem("jwt");var e=a.getItem("jwt");if(e!==null){f.setRequestHeader("Authorization","Bearer "+e)}else{if(d===true){return false}}}})})}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.UniversalCapture=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.UniversalCapture=b(require("jquery")))}else{nf.UniversalCapture=b(a.$)}}}(this,function(b){b(document).ready(function(c){c(window).on("keydown",function(d){var i=d.ctrlKey||d.metaKey;if(!i&&d.keyCode===27){var g=c("div.value-combo");if(g.is(":visible")&&g.parent().hasClass("combo-editor")){return}if(c("div.property-detail").is(":visible")){a.removeAllPropertyDetailDialogs();d.stopImmediatePropagation();d.preventDefault()}else{var h=c(d.target);if(h.length){var j=c(".cancellable");if(j.length){var e=null;var f=null;c.each(j,function(k,m){var l=c(m);var n=l.css("zIndex");if(l.is(":visible")&&(n!==null&&typeof n!=="undefined")){n=parseInt(n,10);if(e===null||n>e){e=n;f=l}}});if(f!==null){if(f.hasClass("modal")){f.modal("hide")}else{f.hide()}d.stopImmediatePropagation();d.preventDefault();return}}if(top!==window){if(typeof parent.nf!=="undefined"&&typeof parent.nf.Shell!=="undefined"){parent.$("#shell-close-button").click();d.stopImmediatePropagation();d.preventDefault();return}}}}}else{if(i){if(d.keyCode===82){d.preventDefault()}}else{if(!c("input, textarea").is(":focus")&&(d.keyCode==8||d.keyCode===46)){d.preventDefault()}}}})});var a={removeAllPropertyDetailDialogs:function(){var c=b("body").find("div.property-detail");c.find("div.nfel-editor").nfeditor("destroy");c.find("div.value-combo").combo("destroy");c.hide().remove()}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return(nf.Dialog=b(c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Dialog=b(require("jquery")))}else{nf.Dialog=b(a.$)}}}(this,function(b){b(document).ready(function(){b("#nf-ok-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-ok-dialog-content").empty()}}});b("#nf-yes-no-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){b("#nf-yes-no-dialog-content").empty();b("#nf-yes-no-dialog").modal("setButtonModel",[])}}})});var a={showOkDialog:function(c){c=b.extend({headerText:"",dialogContent:""},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-ok-dialog-content").append(d).append("</br>");b("#nf-ok-dialog").modal("setButtonModel",[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-ok-dialog").modal("hide");if(typeof c.okHandler==="function"){c.okHandler.call(this)}}}}]);b("#nf-ok-dialog").modal("setHeaderText",c.headerText).modal("show")},showYesNoDialog:function(c){c=b.extend({headerText:"",dialogContent:"",yesText:"Yes",noText:"No"},c);var d=b("<p></p>").append(c.dialogContent);b("#nf-yes-no-dialog-content").append(d);b("#nf-yes-no-dialog").modal("setButtonModel",[{buttonText:c.yesText,color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.yesHandler==="function"){c.yesHandler.call(this)}}}},{buttonText:c.noText,color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){b("#nf-yes-no-dialog").modal("hide");if(typeof c.noHandler==="function"){c.noHandler.call(this)}}}}]);b("#nf-yes-no-dialog").modal("setHeaderText",c.headerText).modal("show")},showDisconnectedFromClusterMessage:function(){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node is currently not connected to the cluster. Any modifications to the data flow made here will not replicate across the cluster."})},showConnectedToClusterMessage:function(){a.showOkDialog({headerText:"Cluster Connection",dialogContent:"This node just joined the cluster. Any modifications to the data flow made here will replicate across the cluster."})}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Storage"],function(e,d,c){return(nf.Common=b(e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Common=b(require("jquery"),require("d3"),require("nf.Storage")))}else{nf.Common=b(a.$,a.d3,a.nf.Storage)}}}(this,function(e,d,b){e(document).ready(function(){var g="images/bg-error.png";e("<img/>").attr("src",g).on("load",function(){e("div.message-pane").css("background-image",g)});e(document).on("mouseenter","span.link",function(){e(this).addClass("link-over")}).on("mouseleave","span.link",function(){e(this).removeClass("link-over")});e(document).on("click","div.nf-checkbox",function(){var h=e(this);if(h.hasClass("checkbox-unchecked")){h.removeClass("checkbox-unchecked").addClass("checkbox-checked")}else{h.removeClass("checkbox-checked").addClass("checkbox-unchecked")}});e(document).on("click",".nf-checkbox-label",function(h){e(h.target).parent().find(".nf-checkbox").click()});e(document).ajaxStart(function(){e("div.loading-container").addClass("ajax-loading")}).ajaxStop(function(){e("div.loading-container").removeClass("ajax-loading")});if(b.getItem("jwt")!==null){e("#user-logout-container").css("display","block");f.scheduleTokenRefresh()}e("#user-logout").on("click",function(){b.removeItem("jwt");window.location="/nifi/login"});e("#user-home").on("click",function(){if(top!==window){parent.window.location="/nifi"}else{window.location="/nifi"}})});var c=null;var a=[{text:"view the user interface",value:"flow",description:"Allows users to view the user interface"},{text:"access the controller",value:"controller",description:"Allows users to view/modify the controller including Reporting Tasks, Controller Services, and Nodes in the Cluster"},{text:"query provenance",value:"provenance",description:"Allows users to submit a Provenance Search and request Event Lineage"},{text:"access restricted components",value:"restricted-components",description:"Allows users to create/modify restricted components assuming otherwise sufficient permissions"},{text:"access all policies",value:"policies",description:"Allows users to view/modify the policies for all components"},{text:"access users/user groups",value:"tenants",description:"Allows users to view/modify the users and user groups"},{text:"retrieve site-to-site details",value:"site-to-site",description:"Allows other NiFi instances to retrieve Site-To-Site details of this NiFi"},{text:"view system diagnostics",value:"system",description:"Allows users to view System Diagnostics"},{text:"proxy user requests",value:"proxy",description:"Allows proxy machines to send requests on the behalf of others"},{text:"access counters",value:"counters",description:"Allows users to view/modify Counters"}];var f={ANONYMOUS_USER_TEXT:"Anonymous user",config:{sensitiveText:"Sensitive value set",tooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:function(g){e(this).slideDown(100)}},hide:{effect:function(g){e(this).slideUp(100)}},position:{at:"top center",my:"bottom center"}}},SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,currentUser:undefined,sortVersion:function(g,r){if(g===r){return 0}var n=g.split(/-/);var s=r.split(/-/);if(n.length>=1&&s.length>=1){var p=n[0].split(/\./);var m=s[0].split(/\./);if(p.length>=1&&m.length>=1){var k=Math.min(p.length,m.length);for(var l=0;l<k;l++){var q=parseInt(p[l],10);var j=parseInt(m[l],10);if(isNaN(q)&&isNaN(j)){continue}else{if(isNaN(q)){return -1}else{if(isNaN(j)){return 1}}}if(q!==j){return q-j}}if(p.length===m.length){if(n.length===s.length){var o=f.substringAfterFirst(g,n[0]);var h=f.substringAfterFirst(r,s[0]);return o===h?0:o>h?1:-1}else{return s.length-n.length}}else{return p.length-m.length}}else{if(p.length>=1){return 1}else{if(m.length>=1){return -1}else{return 0}}}}else{if(n.length>=1){return 1}else{if(s.length>=1){return -1}else{return 0}}}},sortType:function(g,j){var h=function(m,k){var n=f.formatBundle(m.bundle);var l=f.formatBundle(k.bundle);return n===l?0:n>l?1:-1};var i=function(r,q){if(g.columnId==="version"){var p=f.isDefinedAndNotNull(r.bundle[g.columnId])?r.bundle[g.columnId]:"";var n=f.isDefinedAndNotNull(q.bundle[g.columnId])?q.bundle[g.columnId]:"";var l=f.sortVersion(p,n);return l===0?h(r,q):l}else{if(g.columnId==="type"){var o=f.substringAfterLast(r[g.columnId],".");var m=f.substringAfterLast(q[g.columnId],".");return o===m?0:o>m?1:-1}else{var k=f.isDefinedAndNotNull(r[g.columnId])?r[g.columnId]:"";var s=f.isDefinedAndNotNull(q[g.columnId])?q[g.columnId]:"";return k===s?h(r,q):k>s?1:-1}}};j.sort(i,g.sortAsc)},typeFormatter:function(l,h,k,j,g){var i="";if(f.isBlank(g.usageRestriction)===false){i+='<div class="view-usage-restriction fa fa-shield"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}else{i+='<div class="fa"></div>'}i+=f.escapeHtml(k);return i},genericValueFormatter:function(k,h,j,i,g){return f.escapeHtml(j)},typeBundleFormatter:function(k,h,j,i,g){return f.escapeHtml(f.formatBundle(g.bundle))},typeVersionFormatter:function(l,h,k,j,g){var i="";if(f.isDefinedAndNotNull(g.bundle)){i+=('<div style="float: left;">'+f.escapeHtml(g.bundle.version)+"</div>")}else{i+='<div style="float: left;">unversioned</div>'}if(!f.isEmpty(g.controllerServiceApis)){i+='<div class="controller-service-apis fa fa-list" title="Compatible Controller Service" style="margin-top: 2px; margin-left: 4px;"></div><span class="hidden row-id">'+f.escapeHtml(g.id)+"</span>"}i+='<div class="clear"></div>';return i},instanceTypeFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.escapeHtml(f.formatType(g.component))},instanceBundleFormatter:function(k,h,j,i,g){if(!g.permissions.canRead){return""}return f.typeBundleFormatter(k,h,j,i,g.component)},formatType:function(g){var h=f.substringAfterLast(g.type,".");if(g.bundle.version!=="unversioned"){h+=(" "+g.bundle.version)}return h},formatBundle:function(g){var h="";if(g.group!=="default"){h=g.group+" - "}return h+g.artifact},setCurrentUser:function(g){f.currentUser=g},scheduleTokenRefresh:function(){if(c!==null){clearInterval(c)}var g=f.MILLIS_PER_MINUTE;var h=function(){var j=b.getItemExpiration("jwt");if(j!==null){var l=new Date(j);var k=new Date();var i=l.valueOf()-k.valueOf()-(30*f.MILLIS_PER_SECOND);if(i<g){if(e("#current-user").text()!==f.ANONYMOUS_USER_TEXT&&!e("#anonymous-user-alert").is(":visible")){e("#anonymous-user-alert").show().qtip(e.extend({},f.config.tooltipConfig,{content:"Your session will expire soon. Please log in again to avoid being automatically logged out.",position:{my:"top right",at:"bottom left"}}))}}}};h();c=setInterval(h,g)},setAnonymousUserLabel:function(){var g=e("#anonymous-user-alert");if(g.data("qtip")){g.qtip("api").destroy(true)}g.show().qtip(e.extend({},f.config.tooltipConfig,{content:"You are accessing with limited authority. Log in or request an account to access with additional authority granted to you by an administrator.",position:{my:"top right",at:"bottom left"}}));e("#current-user").text(f.ANONYMOUS_USER_TEXT).show()},getJwtPayload:function(h){if(f.isDefinedAndNotNull(h)){var g=h.split(/\./);if(g.length!==3){return""}var j=e.base64.atob(g[1]);var i=JSON.parse(j);if(f.isDefinedAndNotNull(i)){return i}else{return null}}return null},canAccessProvenance:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.provenancePermissions.canRead===true}else{return false}},canAccessRestrictedComponents:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.restrictedComponentsPermissions.canWrite===true}else{return false}},canAccessCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true}else{return false}},canModifyCounters:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.countersPermissions.canRead===true&&f.currentUser.countersPermissions.canWrite===true}else{return false}},canAccessTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true}else{return false}},canModifyTenants:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.tenantsPermissions.canRead===true&&f.currentUser.tenantsPermissions.canWrite===true}else{return false}},canAccessPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true}else{return false}},canModifyPolicies:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.policiesPermissions.canRead===true&&f.currentUser.policiesPermissions.canWrite===true}else{return false}},canAccessController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true}else{return false}},canModifyController:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.controllerPermissions.canRead===true&&f.currentUser.controllerPermissions.canWrite===true}else{return false}},canAccessSystem:function(){if(f.isDefinedAndNotNull(f.currentUser)){return f.currentUser.systemPermissions.canRead===true}else{return false}},addHoverEffect:function(g,i,h){e(document).on("mouseenter",g,function(){e(this).removeClass(i).addClass(h)}).on("mouseleave",g,function(){e(this).removeClass(h).addClass(i)});return e(g).addClass(i)},toggleScrollable:function(g){if(e(g).is(":visible")){if(g.offsetHeight<g.scrollHeight||g.offsetWidth<g.scrollWidth){e(g).addClass("scrollable")}else{e(g).removeClass("scrollable")}}},determineContrastColor:function(g){if(parseInt(g,16)>16777215/1.5){return"#000000"}return"#ffffff"},showLogoutLink:function(){if(b.getItem("jwt")===null){e("#user-logout-container").css("display","none")}else{e("#user-logout-container").css("display","block")}},isContentViewConfigured:function(){var g=e("#nifi-content-viewer-url").text();return !f.isBlank(g)},populateField:function(h,g){if(f.isUndefined(g)||f.isNull(g)){return e("#"+h).addClass("unset").text("No value set")}else{if(g===""){return e("#"+h).addClass("blank").text("Empty string set")}else{return e("#"+h).text(g)}}},clearField:function(g){return e("#"+g).removeClass("unset blank").text("")},cleanUpTooltips:function(g,h){g.find(h).each(function(){var j=e(this);if(j.data("qtip")){var i=j.qtip("api");i.destroy(true)}})},formatPropertyTooltip:function(h,j){var k=[];if(f.isDefinedAndNotNull(h)){if(!f.isBlank(h.description)){k.push(f.escapeHtml(h.description))}if(!f.isBlank(h.defaultValue)){k.push("<b>Default value:</b> "+f.escapeHtml(h.defaultValue))}if(!f.isBlank(h.supportsEl)){k.push("<b>Supports expression language:</b> "+f.escapeHtml(h.supportsEl))}if(!f.isBlank(h.identifiesControllerService)){var g=f.formatType({type:h.identifiesControllerService,bundle:h.identifiesControllerServiceBundle});var i=f.formatBundle(h.identifiesControllerServiceBundle);k.push("<b>Requires Controller Service:</b> "+f.escapeHtml(g+" from "+i))}}if(f.isDefinedAndNotNull(j)){if(!f.isEmpty(j.previousValues)){var l=[];e.each(j.previousValues,function(n,m){l.push("<li>"+f.escapeHtml(m.previousValue)+" - "+f.escapeHtml(m.timestamp)+" ("+f.escapeHtml(m.userIdentity)+")</li>")});k.push('<b>History:</b><ul class="property-info">'+l.join("")+"</ul>")}}if(k.length>0){return k.join("<br/><br/>")}else{return null}},formatProperty:function(g,h){return'<div><span class="label">'+f.formatValue(g)+": </span>"+f.formatValue(h)+"</div>"},formatValue:function(g){if(f.isDefinedAndNotNull(g)){if(g===""){return'<span class="blank" style="font-size: 13px; padding-top: 2px;">Empty string set</span>'}else{return f.escapeHtml(g)}}else{return'<span class="unset" style="font-size: 13px; padding-top: 2px;">No value set</span>'}},escapeHtml:(function(){var g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2f;"};return function(h){if(f.isDefinedAndNotNull(h)){return String(h).replace(/[&<>"'\/]/g,function(i){return g[i]})}else{return""}}}()),isSensitiveProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.sensitive===true}else{return false}},isRequiredProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.required===true}else{return false}},isDynamicProperty:function(g){if(f.isDefinedAndNotNull(g)){return g.dynamic===true}else{return false}},getAllowableValues:function(g){if(f.isDefinedAndNotNull(g)){return g.allowableValues}else{return null}},supportsEl:function(g){if(f.isDefinedAndNotNull(g)){return g.supportsEl===true}else{return false}},formatUnorderedList:function(h){if(e.isArray(h)){var g=e('<ul class="result"></ul>');e.each(h,function(j,k){var i=e("<li></li>").appendTo(g);if(k instanceof jQuery){i.append(k)}else{i.text(k)}});return g}else{return null}},substringAfterLast:function(k,j){var h="";var i=k.lastIndexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringAfterFirst:function(k,j){var h="";var i=k.indexOf(j);if(i>=0){var g=i+j.length;if(g<k.length){h=k.substr(g)}}return h},substringBeforeFirst:function(j,i){var g="";var h=j.indexOf(i);if(h>=0){g=j.substr(0,h)}return g},setCursor:function(h,g){if(g){e("#"+h).addClass("pointer")}else{e("#"+h).removeClass("pointer")}},getAccessToken:function(g){return e.Deferred(function(h){if(b.hasItem("jwt")){e.ajax({type:"POST",url:g}).done(function(i){h.resolve(i)}).fail(function(){h.reject()})}else{h.resolve("")}}).promise()},MILLIS_PER_DAY:86400000,MILLIS_PER_HOUR:3600000,MILLIS_PER_MINUTE:60000,MILLIS_PER_SECOND:1000,formatDuration:function(j){j=j<1?0:j;var l=j/f.MILLIS_PER_DAY;l=l>=1?parseInt(l,10):0;j%=f.MILLIS_PER_DAY;var g=j/f.MILLIS_PER_HOUR;g=g>=1?parseInt(g,10):0;j%=f.MILLIS_PER_HOUR;var h=j/f.MILLIS_PER_MINUTE;h=h>=1?parseInt(h,10):0;j%=f.MILLIS_PER_MINUTE;var k=j/f.MILLIS_PER_SECOND;k=k>=1?parseInt(k,10):0;j=Math.floor(j%f.MILLIS_PER_SECOND);var i=f.pad(g,2,"0")+":"+f.pad(h,2,"0")+":"+f.pad(k,2,"0")+"."+f.pad(j,3,"0");if(l>0){return l+" days and "+i}else{return i}},BYTES_IN_KILOBYTE:1024,BYTES_IN_MEGABYTE:1048576,BYTES_IN_GIGABYTE:1073741824,BYTES_IN_TERABYTE:1099511627776,formatDataSize:function(h){var g=parseFloat(h/f.BYTES_IN_TERABYTE);if(g>1){return g.toFixed(2)+" TB"}g=parseFloat(h/f.BYTES_IN_GIGABYTE);if(g>1){return g.toFixed(2)+" GB"}g=parseFloat(h/f.BYTES_IN_MEGABYTE);if(g>1){return g.toFixed(2)+" MB"}g=parseFloat(h/f.BYTES_IN_KILOBYTE);if(g>1){return g.toFixed(2)+" KB"}return parseFloat(h).toFixed(2)+" bytes"},formatInteger:function(h){var g=h+"";var i=/(\d+)(\d{3})/;while(i.test(g)){g=g.replace(i,"$1,$2")}return f.escapeHtml(g)},formatFloat:function(g){if(f.isUndefinedOrNull(g)){return 0+""}return g.toFixed(2)+""},pad:function(j,h,i){var g=j+"";while(g.length<h){g=i+g}return g},formatDateTime:function(g){return f.pad(g.getMonth()+1,2,"0")+"/"+f.pad(g.getDate(),2,"0")+"/"+f.pad(g.getFullYear(),2,"0")+" "+f.pad(g.getHours(),2,"0")+":"+f.pad(g.getMinutes(),2,"0")+":"+f.pad(g.getSeconds(),2,"0")+"."+f.pad(g.getMilliseconds(),3,"0")},parseDateTime:function(k){if(!f.isDefinedAndNotNull(k)){return new Date()}if(k==="No value set"){return new Date()}if(k==="Empty string set"){return new Date()}var r=k.split(/ /);if(r.length!==3){return new Date()}var h=r[0].split(/\//);var g=r[1].split(/:/);if(h.length!==3||g.length!==3){return new Date()}var m=parseInt(h[2],10);var l=parseInt(h[0],10)-1;var n=parseInt(h[1],10);var o=parseInt(g[0],10);var j=parseInt(g[1],10);var q=g[2].split(/\./);var p=parseInt(q[0],10);var i=0;if(q.length===2){i=parseInt(q[1],10)}return new Date(m,l,n,o,j,p,i)},parseDuration:function(g){var h=g.split(/:/);if(h.length!==3){return 0}var i=h[2].split(/\./);if(i.length===2){return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(i[0],10),parseInt(i[1],10)).getTime()}else{return new Date(1970,0,1,parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10),0).getTime()}},parseSize:function(i){var j=i.split(/ /);var h=parseFloat(j[0].replace(/,/g,""));var g=j[1];if(g==="KB"){return h*1024}else{if(g==="MB"){return h*1024*1024}else{if(g==="GB"){return h*1024*1024*1024}else{if(g==="TB"){return h*1024*1024*1024*1024}else{return h}}}}},parseCount:function(i){var h=i.split(/ /,1);if(h.length!==1){return 0}var g=parseInt(h[0].replace(/,/g,""),10);if(isNaN(g)){return 0}return g},isDefinedAndNotNull:function(g){return !f.isUndefined(g)&&!f.isNull(g)},isUndefinedOrNull:function(g){return f.isUndefined(g)||f.isNull(g)},isUndefined:function(g){return typeof g==="undefined"},isBlank:function(g){return f.isUndefined(g)||f.isNull(g)||e.trim(g)===""},isNull:function(g){return g===null},isEmpty:function(g){return e.isArray(g)?g.length===0:true},doBulletinsDiffer:function(h,j){if(e.isArray(h)&&e.isArray(j)){if(h.length===j.length){for(var g=0;g<h.length;g++){if(h[g].id!==j[g].id||h[g].canRead!==j[g].canRead){return true}}}else{return true}}else{if(e.isArray(h)||e.isArray(j)){return true}}return false},getFormattedBulletins:function(h){var g=[];e.each(h,function(k,l){if(l.canRead===true){var i=l.bulletin;var o="";if(f.isDefinedAndNotNull(i.nodeAddress)){o="-&nbsp;"+f.escapeHtml(i.nodeAddress)+"&nbsp;-&nbsp;"}var n=e("<pre></pre>").css({"white-space":"pre-wrap"}).text(i.message);var m=e("<div>"+f.escapeHtml(i.timestamp)+"&nbsp;"+o+"&nbsp;<b>"+f.escapeHtml(i.level)+"</b>&nbsp;</div>").append(n);g.push(m)}});return g},getFormattedServiceApis:function(h){var g=[];e.each(h,function(l,m){var j=f.formatType({type:m.type,bundle:m.bundle});var k=f.formatBundle(m.bundle);g.push(e("<div></div>").text(j+" from "+k))});return g},getFormattedGarbageCollections:function(h){h.sort(function(j,i){return i.collectionCount-j.collectionCount});var g=[];e.each(h,function(k,i){var j=e('<span style="font-weight: bold;"></span>').text(i.name);var l=e("<span></span>").text(" - "+i.collectionCount+" times ("+i.collectionTime+")");var m=e("<div></div>").append(j).append(l);g.push(m)});return g},getPolicyTypeListing:function(h){var g=d.nest().key(function(i){return i.value}).map(a,d.map);return g.get(h)[0]}};return f}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Dialog","nf.Common"],function(d,c,e){return(nf.ErrorHandler=b(d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("jquery"),require("nf.Dialog"),require("nf.Common")))}else{nf.ErrorHandler=b(a.$,a.nf.Dialog,a.nf.Common)}}}(this,function(b,a,c){return{handleAjaxError:function(g,d,e){if(d==="canceled"){if(b("#splash").is(":visible")){b("#message-title").text("Session Expired");b("#message-content").text("Your session has expired. Please reload to log in again.");b("#message-pane").show()}else{a.showOkDialog({headerText:"Session Expired",dialogContent:"Your session has expired. Please press Ok to log in again.",okHandler:function(){window.location="/nifi"}})}return}if(b("#splash").is(":visible")){if(g.status===401){b("#message-title").text("Unauthorized")}else{if(g.status===403){b("#message-title").text("Insufficient Permissions")}else{if(g.status===409){b("#message-title").text("Invalid State")}else{b("#message-title").text("An unexpected error has occurred")}}}if(b.trim(g.responseText)===""){b("#message-content").text("Please check the logs.")}else{b("#message-content").text(g.responseText)}b("#message-pane").show();return}if(g.status===400||g.status===404||g.status===409||g.status===503){a.showOkDialog({headerText:"Error",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status===403){a.showOkDialog({headerText:"Insufficient Permissions",dialogContent:c.escapeHtml(g.responseText)})}else{if(g.status<99||g.status===12007||g.status===12029){var f="Please ensure the application is running and check the logs for any errors.";if(c.isDefinedAndNotNull(d)){if(d==="timeout"){f="Request has timed out. Please ensure the application is running and check the logs for any errors."}else{if(d==="abort"){f="Request has been aborted."}else{if(d==="No Transport"){f="Request transport mechanism failed. Please ensure the host where the application is running is accessible."}}}}b("#message-title").text("Unable to communicate with NiFi");b("#message-content").text(f)}else{if(g.status===401){b("#message-title").text("Unauthorized");if(b.trim(g.responseText)===""){b("#message-content").text("Authentication is required to use this NiFi.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===500){b("#message-title").text("An unexpected error has occurred");if(b.trim(g.responseText)===""){b("#message-content").text("An error occurred communicating with the application core. Please check the logs and fix any configuration issues before restarting.")}else{b("#message-content").text(g.responseText)}}else{if(g.status===200||g.status===201){b("#message-title").text("Parse Error");if(b.trim(g.responseText)===""){b("#message-content").text("Unable to interpret response from NiFi.")}else{b("#message-content").text(g.responseText)}}else{b("#message-title").text(g.status+": Unexpected Response");b("#message-content").text("An unexpected error has occurred. Please check the logs.")}}}}b("#message-pane").show()}}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ClusterSummary","nf.ErrorHandler","nf.Dialog","nf.Common"],function(e,h,c,g,d,f){return(nf.ComponentState=b(e,h,c,g,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("Slick"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ComponentState=b(a.$,a.Slick,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,k,j,d,c){var g=function(){var n=f("#component-state-table").data("gridInstance");if(c.isDefinedAndNotNull(n)){var o=n.getData();o.setFilterArgs({searchString:l()});o.refresh()}};var a=function(p,o){if(o.searchString===""){return true}try{var t=new RegExp(o.searchString,"i")}catch(q){return false}var s=p.key.search(t)>=0;var n=p.value.search(t)>=0;var r=false;if(c.isDefinedAndNotNull(p.scope)){r=p.scope.search(t)>=0}return s||n||r};var e=function(n,p){var o=function(s,q){var r=c.isDefinedAndNotNull(s[n.columnId])?s[n.columnId]:"";var t=c.isDefinedAndNotNull(q[n.columnId])?q[n.columnId]:"";return r===t?0:r>t?1:-1};p.sort(o,n.sortAsc)};var l=function(){return f("#component-state-filter").val()};var i=function(){var n=f("#component-state-table").data("gridInstance");var o=n.getData();o.setItems([]);f("#component-state-partial-results-container").hide();f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")};var h=function(n,o){var p=0;var r=0;var s=false;var q=f("#component-state-table").data("gridInstance");var t=q.getData();t.beginUpdate();if(c.isDefinedAndNotNull(n)){f.each(n.state,function(u,v){t.addItem(f.extend({id:p++,scope:v.clusterNodeAddress},v))});r+=n.totalEntryCount;if(c.isDefinedAndNotNull(n.state)&&n.totalEntryCount!==n.state.length){s=true}}if(c.isDefinedAndNotNull(o)){f.each(o.state,function(u,v){t.addItem(f.extend({id:p++,scope:"Cluster"},v))});r+=o.totalEntryCount;if(c.isDefinedAndNotNull(o.state)&&o.totalEntryCount!==o.state.length){s=true}}t.endUpdate();t.reSort();if(s){f("#component-state-partial-results-container").show()}f("#total-component-state-entries").text(c.formatInteger(r))};var m=function(){f("#component-state-name").text("");f("#component-state-description").text("");f("#component-state-filter").val("");f("#clear-link").removeClass("disabled").attr("title","");i();f("#component-state-table").removeData("component")};return{init:function(){f("#component-state-filter").on("keyup",function(){g()});f("#component-state-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component State",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f(this).modal("hide")}}}],handler:{close:function(){m()},resize:function(){f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(f("#component-state-description").attr("title")).ellipsis()}}});f("#clear-link").on("click",function(){if(f(this).hasClass("disabled")===false){var s=f("#component-state-table");var u=s.data("gridInstance");var t=u.getDataLength();if(t>0){var r=s.data("component");f.ajax({type:"POST",url:r.uri+"/state/clear-requests",dataType:"json"}).done(function(v){i();h()}).fail(j.handleAjaxError)}else{d.showOkDialog({headerText:"Component State",dialogContent:"This component has no state to clear."})}}});var o=[{id:"key",field:"key",name:"Key",sortable:true,resizable:true,formatter:c.genericValueFormatter},{id:"value",field:"value",name:"Value",sortable:true,resizable:true,formatter:c.genericValueFormatter}];if(k.isClustered()){o.push({id:"scope",field:"scope",name:"Scope",sortable:true,resizable:true,formatter:c.genericValueFormatter})}var n={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var q=new b.Data.DataView({inlineFilters:false});q.setItems([]);q.setFilterArgs({searchString:"",property:"key"});q.setFilter(a);e({columnId:"key",sortAsc:true},q);var p=new b.Grid("#component-state-table",q,o,n);p.setSelectionModel(new b.RowSelectionModel());p.registerPlugin(new b.AutoTooltips());p.setSortColumn("key",true);p.onSort.subscribe(function(s,r){e({columnId:r.sortCol.field,sortAsc:r.sortAsc},q)});q.onRowCountChanged.subscribe(function(s,r){p.updateRowCount();p.render();f("#displayed-component-state-entries").text(r.current)});q.onRowsChanged.subscribe(function(s,r){p.invalidateRows(r.rows);p.render()});f("#component-state-table").data("gridInstance",p);f("#displayed-component-state-entries").text("0");f("#total-component-state-entries").text("0")},showState:function(n,o){return f.ajax({type:"GET",url:n.uri+"/state",dataType:"json"}).done(function(q){var r=q.componentState;var p=f("#component-state-table");h(r.localState,r.clusterState);f("#component-state-dialog").modal("show");f("#component-state-name").text(n.component.name);f("#component-state-description").width(f("#component-state-dialog").find(".dialog-content").innerWidth()-1).text(r.stateDescription).ellipsis();p.data("component",n);if(o===false){f("#clear-link").addClass("disabled").attr("title","Component state can only be cleared when the component is not actively running")}var s=p.data("gridInstance");s.resizeCanvas()}).fail(j.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Shell=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Shell=b(require("jquery"),require("nf.Common")))}else{nf.Shell=b(a.$,a.nf.Common)}}}(this,function(b,e){b(document).ready(function(){b("#shell-dialog").modal({scrollableContentStyle:"scrollable",header:false,footer:false,responsive:{x:false,y:false}});b("#shell-close-button").click(function(){b("#shell-dialog").modal("hide")});b("#shell-undock-button").click(function(){var f=b("#shell-iframe").attr("src");if(!e.isBlank(f)){window.open(f);b("#shell-dialog").modal("hide")}})});var d=null;var c=null;var a=null;return{init:function(f){a=f},resizeContent:function(f){var g=f.find(".shell-content-container");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:content:resize")},resizeIframe:function(f){var g=f.find("#shell-iframe");g.css({width:f.width(),height:f.height()-28-40});f.trigger("shell:iframe:resize")},showPage:function(f,g){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(h){var i=b("#shell");if(e.isNull(g)||e.isUndefined(g)){g=true}b("#shell-dialog").modal("setCloseHandler",function(){i.empty();h.resolve()});b("#shell-dialog").modal("setOpenHandler",function(){e.toggleScrollable(b("#"+this.find(".tab-container").attr("id")+"-content").get(0))});b("#shell-dialog").modal("show");if(g){b("#shell-undock-button").show()}else{b("#shell-undock-button").hide()}var j=b("<iframe/>",{id:"shell-iframe",frameBorder:"0",src:f}).css({width:i.width(),height:i.height()-28}).appendTo(i)}).promise()},showContent:function(f){if(e.isDefinedAndNotNull(a)){a.hide()}return b.Deferred(function(g){var k=b(f);if(k.length){var h=b("#shell");var j=k.parent();k.detach();b("#shell-dialog").modal("setCloseHandler",function(){var m=b(".combo");for(var n=0,l=m.length;n<l;n++){if(b(m[n]).is(":visible")){b(m[n]).combo("close")}}g.resolve();k.hide().detach().appendTo(j);h.empty()});b("#shell-undock-button").hide();b("#shell-dialog").modal("show");var i=b("<div>").addClass("shell-content-container").css({width:h.width(),height:h.height()}).append(k).appendTo(h);k.show()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Client=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Client=b(require("jquery"),require("nf.Common")))}else{nf.Client=b(a.$,a.nf.Common)}}}(this,function(b,c){var a=null;return{init:function(){return b.ajax({type:"GET",url:"../nifi-api/flow/client-id",}).done(function(d){a=d})},getRevision:function(e){return{clientId:a,version:e.revision.version}},isNewerRevision:function(f,d){if(c.isDefinedAndNotNull(f)){var g=f.revision;var e=d.revision;return e.version>=g.version}else{return true}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.Clipboard=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Clipboard=b(require("jquery"),require("nf.Common")))}else{nf.Clipboard=b(a.$,a.nf.Common)}}}(this,function(e,f){var a="copy";var d="paste";var c=null;var b={};return{addListener:function(h,g){b[h]=g},removeListener:function(g){if(f.isDefinedAndNotNull(b[g])){delete b[g]}},copy:function(h){c=h;for(var g in b){b[g].call(g,a,c)}},isCopied:function(){return f.isDefinedAndNotNull(c)},paste:function(){return e.Deferred(function(g){if(f.isDefinedAndNotNull(c)){var i=c;g.resolve(i);c=null;for(var h in b){b[h].call(h,d,i)}}else{g.reject()}}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Shell","nf.Dialog","nf.Client"],function(f,g,c,e,d){return(nf.CustomUi=b(f,g,c,e,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CustomUi=b(require("jquery"),require("nf.Common"),require("nf.Shell"),require("nf.Dialog"),require("nf.Client")))}else{nf.CustomUi=b(a.$,a.nf.Common,a.nf.Shell,a.nf.Dialog,a.nf.Client)}}}(this,function(d,e,a,c,b){return{showCustomUi:function(f,h,g){return d.Deferred(function(i){e.getAccessToken("../nifi-api/access/ui-extension-token").done(function(k){d("#shell-close-button");var j=b.getRevision(f);var l={id:f.id,revision:j.version,clientId:j.clientId,editable:g};if(!e.isBlank(k)){l.access_token=k}a.showPage(".."+h+"?"+d.param(l),false).done(function(){i.resolve()})}).fail(function(){c.showOkDialog({headerText:"Advanced Configuration",dialogContent:"Unable to generate access token for accessing the advanced configuration dialog."});i.resolve()})}).promise()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","jquery","nf.Common","nf.ErrorHandler","nf.Dialog","nf.Clipboard","nf.Storage"],function(e,g,h,i,f,d,c){return(nf.CanvasUtils=b(e,g,h,i,f,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.CanvasUtils=b(require("d3"),require("jquery"),require("nf.Common"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Clipboard"),require("nf.Storage")))}else{nf.CanvasUtils=b(a.d3,a.$,a.nf.Common,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Clipboard,a.nf.Storage)}}}(this,function(q,i,g,m,h,l,j){var o;var e;var p;var a;var k;var c={storage:{namePrefix:"nifi-view-"},urls:{controller:"../nifi-api/controller"}};var d=2*Math.PI;var n=function(v,t){var s=0;var w=v-1;var u;var r=0;while(s<=w){u=~~((s+w)/2);r=t(u);if(r<0){w=u-1}else{if(r>0){s=u+1}else{break}}}return u};var b=function(s,r){return i.Deferred(function(u){var t=f.getGroupId();var v=p.marshal(s,t);p.create(v).done(function(w){p.move(w.snippet.id,r).done(function(){var y=q.map();var x=function(z,A){if(!y.has(z)){y.set(z,[])}y.get(z).push(A)};s.each(function(z){x(z.type,z.id)});y.forEach(function(A,z){f.getComponentByType(A).remove(z)});a.refresh();u.resolve()}).fail(m.handleAjaxError).fail(function(){u.reject()})}).fail(m.handleAjaxError).fail(function(){u.reject()})}).promise()};var f={init:function(v,t,s,u,r){o=v;e=t;p=s;a=u;k=r},config:{systemTooltipConfig:{style:{classes:"nifi-tooltip"},show:{solo:true,effect:false},hide:{effect:false},position:{at:"bottom right",my:"top left"}}},getComponentByType:function(r){return k.getComponentByType(r)},getPerimeterPoint:function(r,A){var s=Math.atan2(A.height,A.width);var x=A.width/2;var w=A.height/2;var v=A.x+x;var t=A.y+w;var B=r.x-v;var z=r.y-t;var u=Math.atan2(z,B);u=u%d;if(u<0){u+=d}var y=(Math.PI/2)-u;if((u>=0&&u<s)||(u>=(d-s)&&u<d)){return{x:A.x+A.width,y:t+Math.tan(u)*x}}else{if(u>=s&&u<(Math.PI-s)){return{x:v+Math.tan(y)*w,y:A.y+A.height}}else{if(u>=(Math.PI-s)&&u<(Math.PI+s)){return{x:A.x,y:t-Math.tan(u)*x}}else{return{x:v-Math.tan(y)*w,y:A.y}}}}},showComponent:function(s,r){if(g.isDefinedAndNotNull(s)){var t=i.Deferred(function(u){if(s!==o.getGroupId()){o.setGroupId(s);o.reload().done(function(){u.resolve()}).fail(function(x,v,w){h.showOkDialog({headerText:"Error",dialogContent:"Unable to load the group for the specified component."});u.reject(x,v,w)})}else{u.resolve()}}).promise();t.done(function(){var u=q.select("#id-"+r);if(!u.empty()){e.show(u)}else{h.showOkDialog({headerText:"Error",dialogContent:"Unable to find the specified component."})}})}},showDeepLink:function(r){f.getSelection().classed("selected",false);if(i("#nf-ok-dialog").is(":visible")===true){i("#nf-ok-dialog").modal("hide")}if("URLSearchParams" in window){var u=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(u)){u=new URLSearchParams(new URL(window.location).search)}var s=f.getGroupId();if(nf.Common.isDefinedAndNotNull(u)){var t=[];if(u.get("processGroupId")){s=u.get("processGroupId")}if(u.get("componentIds")){t=u.get("componentIds").split(",")}if(t.length>=1){return f.showComponents(s,t,r)}else{return f.getComponentByType("ProcessGroup").enterGroup(s)}}else{return f.getComponentByType("ProcessGroup").enterGroup(s)}}},showComponents:function(s,u,r){if(g.isDefinedAndNotNull(s)){var t=i.Deferred(function(v){if(s!==o.getGroupId()||r){o.setGroupId(s);o.reload().done(function(){v.resolve()}).fail(function(y,w,x){h.showOkDialog({headerText:"Error",dialogContent:"Unable to enter the selected group."});v.reject(y,w,x)})}else{v.resolve()}}).promise();t.done(function(){var v=q.selectAll("g.component, g.connection").filter(function(x){if(u.indexOf(x.id)>=0){u.splice(u.indexOf(x.id),1);return x}});if(u.length>0){var w=i("<p></p>").text("Specified component(s) not found: "+u.join(", ")+".").append("<br/><br/>").append(i("<p>Unable to select component(s).</p>"));h.showOkDialog({headerText:"Error",dialogContent:w})}e.show(v)});return t}},MAX_URL_LENGTH:2000,setURLParameters:function(t,u){if("URLSearchParams" in window){if(!g.isDefinedAndNotNull(t)){t=f.getGroupId()}if(!g.isDefinedAndNotNull(u)){u=f.getSelection()}var r=[];u.each(function(x){r.push(x.id)});var s=new URL(window.location);var w=new URL(window.location).searchParams;if(!nf.Common.isDefinedAndNotNull(w)){w=new URLSearchParams(s.search)}if(nf.Common.isDefinedAndNotNull(w)){var w=new URLSearchParams(s.search);w.set("processGroupId",t);w.set("componentIds",r.sort());var v=s.origin+s.pathname;if(g.isDefinedAndNotNull(f.getParentGroupId())||r.length>0){if(!g.isDefinedAndNotNull(f.getParentGroupId())){w.set("processGroupId","root")}if((s.origin+s.pathname+"?"+w.toString()).length<=f.MAX_URL_LENGTH){v=s.origin+s.pathname+"?"+w.toString()}else{if(g.isDefinedAndNotNull(f.getParentGroupId())){w.set("componentIds","");v=s.origin+s.pathname+"?"+w.toString()}}}window.history.replaceState({previous_url:s.href},window.document.title,v)}}},getSelection:function(){return q.selectAll("g.component.selected, g.connection.selected")},centerBoundingBox:function(s){var u=o.View.scale();var w=i("#canvas-container");var t=w.width()/u;var v=w.height()/u;var r=[(t/2)-(s.width/2),(v/2)-(s.height/2)];o.View.translate([(r[0]-s.x)*u,(r[1]-s.y)*u])},editable:function(r,s,t){if(f.canModify(r)){if(!r.classed("connectable")){r.call(s.activate)}if(!r.classed("moveable")){r.call(t.activate)}}else{if(r.classed("connectable")){r.call(s.deactivate)}if(r.classed("moveable")){r.call(t.deactivate)}}},transition:function(r,s){if(s&&!r.empty()){return r.transition().duration(400)}else{return r}},position:function(r,s){if(r.empty()){return}return f.transition(r,s).attr("transform",function(t){return"translate("+t.position.x+", "+t.position.y+")"})},ellipsis:function(t,v){v=v.trim();var s=parseInt(t.attr("width"),10);var u=t.node();t.text(v);if(v.length>0&&u.getSubStringLength(0,v.length-1)>s){s-=5;var r=n(v.length,function(w){var y=u.getSubStringLength(0,w);if(y>s){return -1}else{if(y<s){return 1}}return 0});t.text(v.substring(0,r)+String.fromCharCode(8230))}},multilineEllipsis:function(A,D,C){var t=1;var u=C.split(/\s+/).reverse();var z=parseInt(A.attr("x"),10);var w=parseInt(A.attr("y"),10);var s=parseInt(A.attr("width"),10);var E=[];var v=A.append("tspan").attr({x:z,y:w,width:s});var r=u.pop();while(g.isDefinedAndNotNull(r)){E.push(r);v.text(E.join(" "));if(v.node().getComputedTextLength()>s){E.pop();v.text(E.join(" "));v=A.append("tspan").attr({x:z,dy:"1.2em",width:s});if(++t>=D){var B=[r].concat(u.reverse());f.ellipsis(v,B.join(" "));break}else{v.text(r);E=[r]}}r=u.pop()}},activeThreadCount:function(r,t,u){if(t.status.aggregateSnapshot.activeThreadCount>0){var s=r.select("text.active-thread-count").text(function(){return t.status.aggregateSnapshot.activeThreadCount}).style("display","block").each(function(){var v=this.getBBox();q.select(this).attr("x",function(){return t.dimensions.width-v.width-15})});r.select("text.active-thread-count-icon").attr("x",function(){var v=s.node().getBBox();if(typeof u==="function"){u(v.width+6)}return t.dimensions.width-v.width-20}).style("display","block")}else{r.selectAll("text.active-thread-count, text.active-thread-count-icon").style("display","none")}},disableImageHref:function(r){r.on("click.disableImageHref",function(){if(q.event.ctrlKey||q.event.shiftKey){q.event.preventDefault()}})},bulletins:function(r,x,y,w){w=g.isDefinedAndNotNull(w)?w:0;var u=q.select("#bulletin-tip-"+x.id);var t=false;if(!g.isEmpty(x.bulletins)){var v=g.getFormattedBulletins(x.bulletins);t=v.length>0;if(t){var s=g.formatUnorderedList(v)}}if(t){r.select("text.bulletin-icon").each(function(){if(u.empty()){u=y().append("div").attr("id",function(){return"bulletin-tip-"+x.id}).attr("class","tooltip nifi-tooltip")}u.html(function(){return i("<div></div>").append(s).html()});f.canvasTooltip(u,q.select(this))});r.select("text.bulletin-icon").style("visibility","visible");r.select("rect.bulletin-background").style("visibility","visible")}else{if(!u.empty()){u.remove()}r.select("text.bulletin-icon").style("visibility","hidden");r.select("rect.bulletin-background").style("visibility","hidden")}},canvasTooltip:function(r,s){s.on("mouseenter",function(){r.style("top",(q.event.pageY+15)+"px").style("left",(q.event.pageX+15)+"px").style("display","block")}).on("mousemove",function(){r.style("top",(q.event.pageY+15)+"px").style("left",(q.event.pageX+15)+"px")}).on("mouseleave",function(){r.style("display","none")})},canAlign:function(t){var s=true;var r=t.filter(function(v){var u=q.select(this);return f.isConnection(u)});if(t.size()-r.size()<2){s=false}if(f.canModify(t)===false){s=false}return s},isColorable:function(t){if(t.empty()){return false}if(f.canRead(t)===false||f.canModify(t)===false){return false}var s=t.filter(function(x){var w=q.select(this);return f.isProcessor(w)&&f.canModify(w)});var v=t.filter(function(x){var w=q.select(this);return f.isLabel(w)&&f.canModify(w)});var r=s.size()===t.size();var u=v.size()===t.size();return r||u},isConnection:function(r){return r.classed("connection")},isRemoteProcessGroup:function(r){return r.classed("remote-process-group")},isProcessor:function(r){return r.classed("processor")},isLabel:function(r){return r.classed("label")},isInputPort:function(r){return r.classed("input-port")},isOutputPort:function(r){return r.classed("output-port")},isProcessGroup:function(r){return r.classed("process-group")},isFunnel:function(r){return r.classed("funnel")},areRunnable:function(r){if(r.empty()){return true}var s=true;r.each(function(){if(!f.isRunnable(q.select(this))){s=false;return false}});return s},isRunnable:function(r){if(r.size()!==1){return false}if(f.isProcessGroup(r)){return true}if(f.canModify(r)===false){return false}var t=false;var s=r.datum();if(f.isProcessor(r)||f.isInputPort(r)||f.isOutputPort(r)){t=f.supportsModification(r)&&s.status.aggregateSnapshot.runStatus==="Stopped"}return t},areStoppable:function(r){if(r.empty()){return true}var s=true;r.each(function(){if(!f.isStoppable(q.select(this))){s=false;return false}});return s},isStoppable:function(r){if(r.size()!==1){return false}if(f.isProcessGroup(r)){return true}if(f.canModify(r)===false){return false}var t=false;var s=r.datum();if(f.isProcessor(r)||f.isInputPort(r)||f.isOutputPort(r)){t=s.status.aggregateSnapshot.runStatus==="Running"}return t},filterEnable:function(r){return r.filter(function(u){var s=q.select(this);var t=s.datum();return((f.isProcessor(s)||f.isInputPort(s)||f.isOutputPort(s))&&f.supportsModification(s)&&t.status.aggregateSnapshot.runStatus==="Disabled")})},canEnable:function(r){if(r.empty()){return false}if(f.canModify(r)===false){return false}return f.filterEnable(r).size()===r.size()},filterDisable:function(r){return r.filter(function(u){var s=q.select(this);var t=s.datum();return((f.isProcessor(s)||f.isInputPort(s)||f.isOutputPort(s))&&f.supportsModification(s)&&(t.status.aggregateSnapshot.runStatus==="Stopped"||t.status.aggregateSnapshot.runStatus==="Invalid"))})},canDisable:function(r){if(r.empty()){return false}if(f.canModify(r)===false){return false}return f.filterDisable(r).size()===r.size()},canAllStartTransmitting:function(r){if(r.empty()){return false}var s=true;r.each(function(){if(!f.canStartTransmitting(q.select(this))){s=false}});return s},canStartTransmitting:function(r){if(r.size()!==1){return false}if(f.canModify(r)===false||f.canRead(r)===false){return false}return f.isRemoteProcessGroup(r)},canAllStopTransmitting:function(r){if(r.empty()){return false}var s=true;r.each(function(){if(!f.canStopTransmitting(q.select(this))){s=false}});return s},canStopTransmitting:function(r){if(r.size()!==1){return false}if(f.canModify(r)===false||f.canRead(r)===false){return false}return f.isRemoteProcessGroup(r)},areDeletable:function(r){if(r.empty()){return false}var s=true;r.each(function(){if(!f.isDeletable(q.select(this))){s=false}});return s},isDeletable:function(r){if(r.size()!==1){return false}if(o.canWrite()===false){return false}if(f.canModify(r)===false){return false}return f.supportsModification(r)},isConfigurable:function(r){if(r.size()!==1){if(r.empty()){return true}else{return false}}if(f.isProcessGroup(r)){return true}if(f.canRead(r)===false||f.canModify(r)===false){return false}if(f.isFunnel(r)){return false}return f.supportsModification(r)},hasDetails:function(r){if(r.size()!==1){return false}if(f.canRead(r)===false){return false}if(f.canModify(r)){if(f.isProcessor(r)||f.isInputPort(r)||f.isOutputPort(r)||f.isRemoteProcessGroup(r)||f.isConnection(r)){return !f.isConfigurable(r)}}else{return f.isProcessor(r)||f.isConnection(r)||f.isInputPort(r)||f.isOutputPort(r)||f.isRemoteProcessGroup(r)}return false},canManagePolicies:function(){var r=f.getSelection();if(r.size()<=1){if(!r.empty()&&f.isConnection(r)){return false}return g.canAccessTenants()}return false},canModify:function(t){var s=t.size();var r=t.filter(function(u){return u.permissions.canWrite}).size();return s===r},canRead:function(s){var r=s.size();var t=s.filter(function(u){return u.permissions.canRead}).size();return r===t},supportsModification:function(y){if(y.size()!==1){return false}var w=y.datum();var u=false;if(f.isProcessor(y)||f.isInputPort(y)||f.isOutputPort(y)){u=!(w.status.aggregateSnapshot.runStatus==="Running"||w.status.aggregateSnapshot.activeThreadCount>0)}else{if(f.isRemoteProcessGroup(y)){u=!(w.status.transmissionStatus==="Transmitting"||w.status.aggregateSnapshot.activeThreadCount>0)}else{if(f.isProcessGroup(y)){u=true}else{if(f.isFunnel(y)){u=true}else{if(f.isLabel(y)){u=true}else{if(f.isConnection(y)){var x=false;var s=false;var z=f.getConnectionSourceComponentId(w);var r=q.select("#id-"+z);if(!r.empty()){if(f.isRemoteProcessGroup(r)||f.isProcessGroup(r)){x=true}else{x=f.supportsModification(r)}}var t=f.getConnectionDestinationComponentId(w);var v=q.select("#id-"+t);if(!v.empty()){if(f.isRemoteProcessGroup(v)||f.isProcessGroup(v)){s=true}else{s=f.supportsModification(v)}}u=x&&s}}}}}}return u},getConnectableTypeForSource:function(s){var r;if(f.isProcessor(s)){r="PROCESSOR"}else{if(f.isRemoteProcessGroup(s)){r="REMOTE_OUTPUT_PORT"}else{if(f.isProcessGroup(s)){r="OUTPUT_PORT"}else{if(f.isInputPort(s)){r="INPUT_PORT"}else{if(f.isFunnel(s)){r="FUNNEL"}}}}}return r},getConnectableTypeForDestination:function(s){var r;if(f.isProcessor(s)){r="PROCESSOR"}else{if(f.isRemoteProcessGroup(s)){r="REMOTE_INPUT_PORT"}else{if(f.isProcessGroup(s)){r="INPUT_PORT"}else{if(f.isOutputPort(s)){r="OUTPUT_PORT"}else{if(f.isFunnel(s)){r="FUNNEL"}}}}}return r},isCopyable:function(s){if(s.empty()){return false}if(f.canRead(s)===false){return false}var r=s.filter(function(w){var u=q.select(this);if(f.isConnection(u)){var t=!s.filter(function(x){var y=f.getConnectionSourceComponentId(w);return y===x.id}).empty();var v=!s.filter(function(x){var y=f.getConnectionDestinationComponentId(w);return y===x.id}).empty();return t&&v}else{return f.isProcessor(u)||f.isFunnel(u)||f.isLabel(u)||f.isProcessGroup(u)||f.isRemoteProcessGroup(u)||f.isInputPort(u)||f.isOutputPort(u)}});return s.size()===r.size()},isPastable:function(){return o.canWrite()&&l.isCopied()},persistUserView:function(){var r=c.storage.namePrefix+o.getGroupId();var t=o.View.translate();var s={scale:o.View.scale(),translateX:t[0],translateY:t[1]};j.setItem(r,s)},formatConnectionName:function(r){if(!g.isBlank(r.name)){return r.name}else{if(g.isDefinedAndNotNull(r.selectedRelationships)){return r.selectedRelationships.join(", ")}}return""},reloadConnectionSourceAndDestination:function(u,t){if(g.isBlank(u)===false){var s=q.select("#id-"+u);if(s.empty()===false){k.reload(s)}}if(g.isBlank(t)===false){var r=q.select("#id-"+t);if(r.empty()===false){k.reload(r)}}},getConnectionSourceComponentId:function(r){var s=r.sourceId;if(r.sourceGroupId!==o.getGroupId()){s=r.sourceGroupId}return s},getConnectionDestinationComponentId:function(r){var s=r.destinationId;if(r.destinationGroupId!==o.getGroupId()){s=r.destinationGroupId}return s},restoreUserView:function(){var t=false;try{var r=c.storage.namePrefix+o.getGroupId();var s=j.getItem(r);if(g.isDefinedAndNotNull(s)){if(isFinite(s.scale)&&isFinite(s.translateX)&&isFinite(s.translateY)){o.View.translate([s.translateX,s.translateY]);o.View.scale(s.scale);o.View.refresh({transition:true});t=true}}}catch(u){}return t},getOrigin:function(s){var r={};s.each(function(u){var t=q.select(this);if(!f.isConnection(t)){if(g.isUndefined(r.x)||u.position.x<r.x){r.x=u.position.x}if(g.isUndefined(r.y)||u.position.y<r.y){r.y=u.position.y}}});return r},moveComponentsToParent:function(s){var r=o.getParentGroupId();if(r===null){h.showOkDialog({headerText:"Process Group",dialogContent:"Components are already in the topmost group."})}else{b(s,r)}},moveComponents:function(s,t){var r=t.datum();b(s,r.id).done(function(){f.getComponentByType("ProcessGroup").reload(r.id)})},trimDanglingEdges:function(r){var s=function(t){var x=f.getConnectionSourceComponentId(t);var w=f.getConnectionDestinationComponentId(t);var v=false;var u=false;r.each(function(y){if(y.id===x){v=true}if(y.id===w){u=true}});return v&&u};return r.filter(function(t){if(t.type==="Connection"){return s(t)}else{return true}})},isValidConnectionSource:function(r){if(r.size()!==1){return false}if(f.isProcessGroup(r)){return true}if(f.canRead(r)===false||f.canModify(r)===false){return false}return f.isProcessor(r)||f.isRemoteProcessGroup(r)||f.isInputPort(r)||f.isFunnel(r)},isValidConnectionDestination:function(s){if(s.size()!==1){return false}if(f.isProcessGroup(s)){return true}if(f.canModify(s)===false){return false}if(f.isRemoteProcessGroup(s)||f.isOutputPort(s)||f.isFunnel(s)){return true}if(f.isProcessor(s)){var r=s.datum();return r.inputRequirement!=="INPUT_FORBIDDEN"}},isConfigurableAuthorizer:function(){return o.isConfigurableAuthorizer()},setGroupId:function(r){return o.setGroupId(r)},getGroupId:function(){return o.getGroupId()},getGroupName:function(){return o.getGroupName()},getParentGroupId:function(){return o.getParentGroupId()},reload:function(){return o.reload({transition:true})},canReadFromGroup:function(){return o.canRead()},canWrite:function(){return o.canWrite()},refreshCanvasView:function(r){return o.View.refresh(r)},scaleCanvasView:function(r){return o.View.scale(r)},translateCanvasView:function(r){return o.View.translate(r)},fitCanvasView:function(){return o.View.fit()},zoomCanvasViewIn:function(){return o.View.zoomIn()},zoomCanvasViewOut:function(){return o.View.zoomOut()},actualSizeCanvasView:function(){return o.View.actualSize()},shouldRenderPerScale:function(){return o.View.shouldRenderPerScale()},getCanvasOffset:function(){return o.CANVAS_OFFSET}};return f}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.CanvasUtils"],function(d,e,c){return(nf.GoTo=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.GoTo=b(require("jquery"),require("nf.ErrorHandler"),require("nf.CanvasUtils")))}else{nf.GoTo=b(a.$,a.nf.ErrorHandler,a.nf.CanvasUtils)}}}(this,function(h,j,e){var b={urls:{api:"../nifi-api",processGroups:"../nifi-api/flow/process-groups/"}};var a;var f;var c=function(u,q,r,p){var o=h('<div class="source-destination-connection"></div>').appendTo("#connections-container");if(q.sourceType==="OUTPUT_PORT"){d(u,o,q,r)}else{if(q.sourceType==="REMOTE_OUTPUT_PORT"){i(u,o,q,p)}else{g(o,q)}}var t=h('<div class="connection-entry"></div>').appendTo(o);var w="unset";var s="Connection";if(q.permissions.canRead===true){var v=e.formatConnectionName(q.component);if(v!==""){w="";s=v}}h('<div class="search-result-icon icon-connect"></div>').appendTo(t);h('<div class="connection-entry-name go-to-link"></div>').attr("title",s).addClass(w).text(s).on("click",function(){e.showComponent(u,q.id);h("#connections-dialog").modal("hide")}).appendTo(t);h('<div class="clear"></div>').appendTo(t);if(q.destinationType==="INPUT_PORT"){l(u,o,q,r)}else{if(q.destinationType==="REMOTE_INPUT_PORT"){k(u,o,q,p)}else{m(o,q)}}h('<div class="clear"></div>').appendTo(o)};var m=function(o,p){var q="icon-funnel";if(p.destinationType==="PROCESSOR"){q="icon-processor"}else{if(p.destinationType==="OUTPUT_PORT"){q="icon-port-out"}}var r=p.destinationId;if(p.permissions.canRead===true){r=p.component.destination.name}else{if(a===p.destinationId){r=f}}var s=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(q).appendTo(s);h('<div class="destination-component-name go-to-link"></div>').attr("title",r).text(r).on("click",function(){e.showComponent(p.destinationGroupId,p.destinationId);h("#connections-dialog").modal("hide")}).appendTo(s);h('<div class="clear"></div>').appendTo(s)};var l=function(w,p,s,t){var v;h.each(t,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var o=n(v);var r=h('<div class="destination-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(r);h('<div class="destination-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(w,v.id);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r);var u=s.destinationId;if(s.permissions.canRead===true){u=s.component.destination.name}else{if(a===s.destinationId){u=f}}var q=h('<div class="destination-input-port"></div>').appendTo(r);h('<div class="search-result-icon icon-port-in"></div>').appendTo(q);h('<div class="destination-input-port-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(s.destinationGroupId,s.destinationId);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(r)};var k=function(t,o,s,r){var v;h.each(r,function(x,y){if(s.destinationGroupId===y.id){v=y;return false}});var u=n(v);var q=h('<div class="destination-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="destination-component-name go-to-link"></div>').attr("title",u).text(u).on("click",function(){e.showComponent(t,v.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var w=s.destinationId;if(s.permissions.canRead===true){w=s.component.destination.name}else{if(a===s.destinationId){w=f}}var p=h('<div class="destination-input-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-in"></div>').appendTo(p);h('<div class="destination-input-port-name"></div>').attr("title",w).text(w).appendTo(p);h('<div class="clear"></div>').appendTo(q)};var g=function(o,q){var s="icon-funnel";if(q.sourceType==="PROCESSOR"){s="icon-processor"}else{if(q.sourceType==="INPUT_PORT"){s="icon-port-in"}}var p=q.sourceId;if(q.permissions.canRead===true){p=q.component.source.name}else{if(a===q.sourceId){p=f}}var r=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon"></div>').addClass(s).appendTo(r);h('<div class="source-component-name go-to-link"></div>').attr("title",p).text(p).on("click",function(){e.showComponent(q.sourceGroupId,q.sourceId);h("#connections-dialog").modal("hide")}).appendTo(r);h('<div class="clear"></div>').appendTo(r)};var d=function(v,p,r,s){var u;h.each(s,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var o=n(u);var q=h('<div class="source-component"></div>').appendTo(p);h('<div class="search-result-icon icon-group"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",o).text(o).on("click",function(){e.showComponent(v,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var t=r.sourceId;if(r.permissions.canRead===true){t=r.component.source.name}else{if(a===r.sourceId){t=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(r.sourceGroupId,r.sourceId);h("#connections-dialog").modal("hide")}).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var i=function(s,o,r,p){var u;h.each(p,function(x,y){if(r.sourceGroupId===y.id){u=y;return false}});var t=n(u);var q=h('<div class="source-component"></div>').appendTo(o);h('<div class="search-result-icon icon-group-remote"></div>').appendTo(q);h('<div class="source-component-name go-to-link"></div>').attr("title",t).text(t).on("click",function(){e.showComponent(s,u.id);h("#connections-dialog").modal("hide")}).appendTo(q);h('<div class="clear"></div>').appendTo(q);var v=r.sourceId;if(r.permissions.canRead===true){v=r.component.source.name}else{if(r.sourceId===a){v=f}}var w=h('<div class="source-output-port"></div>').appendTo(q);h('<div class="search-result-icon icon-port-out"></div>').appendTo(w);h('<div class="source-output-port-name"></div>').attr("title",v).text(v).appendTo(w);h('<div class="clear"></div>').appendTo(q)};var n=function(o){if(o.permissions.canRead===true){return o.component.name}else{if(a===o.id){return f}else{return o.id}}};return{init:function(){h("#connections-dialog").modal({scrollableContentStyle:"scrollable",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){h("#connections-dialog").modal("hide")}}}],handler:{close:function(){h("#connections-context").empty();h("#connections-container").empty()}}})},showDownstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.sourceId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromProcessor:function(s){var t=s.datum();var q=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();var o=n(t);a=t.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-processor"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(q,function(u,v){if(v.destinationId===t.id){c(e.getGroupId(),v,p,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.sourceGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromGroup:function(r){var s=r.datum();var p=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var q=e.getComponentByType("RemoteProcessGroup").get();var u="icon-group";if(e.isRemoteProcessGroup(r)){u="icon-group-remote"}var t=n(s);a=s.id;f=t;h("#connections-context").append(h('<div class="search-result-icon"></div>').addClass(u)).append(h('<div class="connections-component-name"></div>').text(t)).append('<div class="clear"></div>');h.each(p,function(v,w){if(w.destinationGroupId===s.id){c(e.getGroupId(),w,o,q)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromInputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-in"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.sourceId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromInputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-in" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.destinationId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}).fail(j.handleAjaxError)},showDownstreamFromOutputPort:function(p){var o=p.datum();h.ajax({type:"GET",url:b.urls.processGroups+encodeURIComponent(e.getParentGroupId()),dataType:"json"}).done(function(s){var r=s.processGroupFlow.flow;var u=r.connections;var t=r.processGroups;var v=r.remoteProcessGroups;var q=n(o);a=o.id;f=q;h("#connections-context").append('<div class="search-result-icon icon-group"></div>').append(h('<div class="connections-component-name"></div>').text(e.getGroupName())).append('<div class="clear"></div>').append('<div class="search-result-icon icon-port-out" style="margin-left: 20px;"></div>').append(h('<div class="connections-component-name"></div>').text(q)).append('<div class="clear"></div>');h.each(u,function(w,x){if(x.sourceId===o.id){c(e.getParentGroupId(),x,t,v)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")}).fail(j.handleAjaxError)},showUpstreamFromOutputPort:function(t){var q=t.datum();var r=e.getComponentByType("Connection").get();var p=e.getComponentByType("ProcessGroup").get();var s=e.getComponentByType("RemoteProcessGroup").get();var o=n(q);a=q.id;f=o;h("#connections-context").append('<div class="search-result-icon icon-port-out"></div>').append(h('<div class="connections-component-name"></div>').text(o)).append('<div class="clear"></div>');h.each(r,function(u,v){if(v.destinationId===q.id){c(e.getGroupId(),v,p,s)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")},showDownstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="connections-component-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.sourceId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No downstream components</span>')}h("#connections-dialog").modal("setHeaderText","Downstream Connections").modal("show")},showUpstreamFromFunnel:function(s){var p=s.datum();var q=e.getComponentByType("Connection").get();var o=e.getComponentByType("ProcessGroup").get();var r=e.getComponentByType("RemoteProcessGroup").get();a=p.id;f="Funnel";h("#connections-context").append('<div class="search-result-icon icon-funnel"></div>').append(h('<div class="upstream-destination-name"></div>').text("Funnel")).append('<div class="clear"></div>');h.each(q,function(t,u){if(u.destinationId===p.id){c(e.getGroupId(),u,o,r)}});if(h("#connections-container").is(":empty")){h("#connections-container").html('<span class="unset">No upstream components</span>')}h("#connections-dialog").modal("setHeaderText","Upstream Connections").modal("show")}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.CanvasUtils","nf.Client"],function(f,e,d,c){return(nf.Snippet=b(f,e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Snippet=b(require("jquery"),require("d3"),require("nf.CanvasUtils"),require("nf.Client")))}else{nf.Snippet=b(a.$,a.d3,a.nf.CanvasUtils,a.nf.Client)}}}(this,function(e,d,c,b){var a={urls:{snippets:"../nifi-api/snippets",processGroups:"../nifi-api/process-groups"}};return{marshal:function(g,f){var h={parentGroupId:f,processors:{},funnels:{},inputPorts:{},outputPorts:{},remoteProcessGroups:{},processGroups:{},connections:{},labels:{}};g.each(function(j){var i=d.select(this);if(c.isProcessor(i)){h.processors[j.id]=b.getRevision(i.datum())}else{if(c.isFunnel(i)){h.funnels[j.id]=b.getRevision(i.datum())}else{if(c.isLabel(i)){h.labels[j.id]=b.getRevision(i.datum())}else{if(c.isInputPort(i)){h.inputPorts[j.id]=b.getRevision(i.datum())}else{if(c.isOutputPort(i)){h.outputPorts[j.id]=b.getRevision(i.datum())}else{if(c.isProcessGroup(i)){h.processGroups[j.id]=b.getRevision(i.datum())}else{if(c.isRemoteProcessGroup(i)){h.remoteProcessGroups[j.id]=b.getRevision(i.datum())}else{if(c.isConnection(i)){h.connections[j.id]=b.getRevision(i.datum())}}}}}}}}});return h},create:function(g){var f={snippet:g};return e.ajax({type:"POST",url:a.urls.snippets,data:JSON.stringify(f),dataType:"json",contentType:"application/json"})},copy:function(h,f,i){var g={snippetId:h,originX:f.x,originY:f.y};return e.ajax({type:"POST",url:a.urls.processGroups+"/"+encodeURIComponent(i)+"/snippet-instance",data:JSON.stringify(g),dataType:"json",contentType:"application/json"})},remove:function(f){return e.ajax({type:"DELETE",url:a.urls.snippets+"/"+encodeURIComponent(f)})},move:function(g,h){var f={snippet:{id:g,parentGroupId:h}};return e.ajax({type:"PUT",url:a.urls.snippets+"/"+encodeURIComponent(g),data:JSON.stringify(f),dataType:"json",contentType:"application/json"})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler","nf.Client","nf.CanvasUtils"],function(g,e,h,f,i,c,d){return(nf.Connection=b(g,e,h,f,i,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connection=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Connection=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(C,M,K,i,d,f,Q){var m;var r;var y;var I={width:200};var g=(I.width/2)-15-2;var P=function(V){var X=V.datum();var U,Y;if(X.bends.length>0){var W=Math.min(Math.max(0,X.labelIndex),X.bends.length-1);U=X.bends[W].x;Y=X.bends[W].y}else{U=(X.start.x+X.end.x)/2;Y=(X.start.y+X.end.y)/2}U-=(I.width/2);Y-=(V.attr("height")/2);return{x:U,y:Y}};var o;var z;var w;var q;var S;var N;var s;var A;var j=function(V,U){return Math.pow(V.x-U.x,2)+Math.pow(V.y-U.y,2)};var t=function(V,U){return Math.sqrt(j(V,U))};var F=function(Y,X,V){var U=j(X,V);if(U===0){return Math.sqrt(j(Y,X))}var W=((Y.x-X.x)*(V.x-X.x)+(Y.y-X.y)*(V.y-X.y))/U;if(W<0){return Math.sqrt(j(Y,X))}if(W>1){return Math.sqrt(j(Y,V))}return Math.sqrt(j(Y,{x:X.x+W*(V.x-X.x),y:X.y+W*(V.y-X.y)}))};var b=function(Y,aa){if(aa.bends.length===0){return 0}var W;var V;var U=[aa.start].concat(aa.bends,[aa.end]);for(var X=0;X<U.length;X++){if(X+1<U.length){var Z=F(Y,U[X],U[X+1]);if(K.isUndefined(W)||Z<W){W=Z;V=X}}}return V};var E=function(U){return U.indexOf("INPUT_PORT")>=0};var x=function(U){return U.indexOf("OUTPUT_PORT")>=0};var J=function(U){return U.groupId!==Q.getGroupId()&&(E(U.type)||x(U.type))};var n=function(U){if(K.isDefinedAndNotNull(U.flowFileExpiration)){var V=U.flowFileExpiration.match(/^(\d+).*/);if(V!==null&&V.length>0){if(parseInt(V[0],10)>0){return true}}}return false};var R=function(U){U.sort(function(W,V){return W.zIndex===V.zIndex?0:W.zIndex>V.zIndex?1:-1})};var L=function(){return q.selectAll("g.connection").data(o.values(),function(U){return U.id})};var O=function(W,V){if(W.empty()){return}var U=W.append("g").attr({id:function(X){return"id-"+X.id},"class":"connection"}).classed("selected",V);U.append("path").attr({"class":"connection-path","pointer-events":"none"});U.append("path").attr({"class":"connection-selection-path","pointer-events":"none"});U.append("path").attr({"class":"connection-path-selectable","pointer-events":"stroke"}).on("mousedown.selection",function(){m.select(M.select(this.parentNode));Q.setURLParameters()}).call(y.activate)};var v=function(V){var U=false;if(K.isDefinedAndNotNull(V.component.selectedRelationships)&&K.isDefinedAndNotNull(V.component.availableRelationships)){C.each(V.component.selectedRelationships,function(W,X){if(C.inArray(X,V.component.availableRelationships)===-1){U=true;return false}})}return U};var p=function(V){var U="normal";if(V.permissions.canRead){if(H(V)||l(V)){U="full"}else{if(v(V)){U="ghost"}}}else{U="unauthorized"}return"url(#"+U+")"};var c=function(U){if(l(U)||H(U)){return"url(#connection-full-drop-shadow)"}else{return"url(#component-drop-shadow)"}};var l=function(U){return U.status.aggregateSnapshot.percentUseCount===100};var e=function(V){var U=V.status.aggregateSnapshot.percentUseCount;if(K.isDefinedAndNotNull(U)){return U>=61&&U<=85}return false};var k=function(V){var U=V.status.aggregateSnapshot.percentUseCount;if(K.isDefinedAndNotNull(U)){return U>85}return false};var H=function(U){return U.status.aggregateSnapshot.percentUseBytes===100};var B=function(V){var U=V.status.aggregateSnapshot.percentUseBytes;if(K.isDefinedAndNotNull(U)){return U>=61&&U<=85}return false};var G=function(V){var U=V.status.aggregateSnapshot.percentUseBytes;if(K.isDefinedAndNotNull(U)){return U>85}return false};var a=function(U,V){if(U.empty()){return}var W=true;var X=true;var Y=false;if(K.isDefinedAndNotNull(V)){W=K.isDefinedAndNotNull(V.updatePath)?V.updatePath:W;X=K.isDefinedAndNotNull(V.updateLabel)?V.updateLabel:X;Y=K.isDefinedAndNotNull(V.transition)?V.transition:Y}if(W===true){U.classed("grouped",function(aa){var Z=false;if(aa.permissions.canRead){if(K.isDefinedAndNotNull(aa.component.selectedRelationships)&&aa.component.selectedRelationships.length>1){Z=true}}return Z}).classed("ghost",function(aa){var Z=false;if(aa.permissions.canRead){if(v(aa)){Z=true}}return Z});U.select("path.connection-path").classed("unauthorized",function(Z){return Z.permissions.canRead===false});U.select("path.connection-path-selectable").on("dblclick",function(ae){if(ae.permissions.canWrite&&ae.permissions.canRead){var Z=M.mouse(this.parentNode);var ac=b({x:Z[0],y:Z[1]},ae);var ab=ae.component.bends.slice();ab.splice(ac,0,{x:Z[0],y:Z[1]});var aa={id:ae.id,bends:ab};var ad=ae.component.labelIndex;if(ab.length===1){aa.labelIndex=0}else{if(ac<=ad){aa.labelIndex=ad+1}}u(ae,aa);M.event.stopPropagation()}else{return null}})}U.each(function(aB){var ar=M.select(this);if(W===true){var aA=Q.getConnectionSourceComponentId(aB);var af=M.select("#id-"+aA).datum();var ag;var an;if(aB.bends.length>0){an=aB.bends[aB.bends.length-1]}else{an={x:af.position.x+(af.dimensions.width/2),y:af.position.y+(af.dimensions.height/2)}}if(K.isDefinedAndNotNull(aB.end)&&aB.end.dragging===true){ag=aB.end;var aC=M.select("g.hover.connectable-destination");if(!aC.empty()){var aw=aC.datum();var Z=Q.getPerimeterPoint(an,{x:aw.position.x,y:aw.position.y,width:aw.dimensions.width,height:aw.dimensions.height});ag.x=Z.x;ag.y=Z.y}}else{var ab=Q.getConnectionDestinationComponentId(aB);var aE=M.select("#id-"+ab).datum();ag=Q.getPerimeterPoint(an,{x:aE.position.x,y:aE.position.y,width:aE.dimensions.width,height:aE.dimensions.height})}var ap;if(aB.bends.length>0){ap=aB.bends[0]}else{ap=ag}var aj=Q.getPerimeterPoint(ap,{x:af.position.x,y:af.position.y,width:af.dimensions.width,height:af.dimensions.height});aB.start=aj;aB.end=ag;Q.transition(ar.select("path.connection-path"),Y).attr({d:function(){var aF=[aB.start].concat(aB.bends,[aB.end]);return A(aF)}});Q.transition(ar.select("path.connection-selection-path"),Y).attr({d:function(){var aF=[aB.start].concat(aB.bends,[aB.end]);return A(aF)}});Q.transition(ar.select("path.connection-path-selectable"),Y).attr({d:function(){var aF=[aB.start].concat(aB.bends,[aB.end]);return A(aF)}});var am=ar.selectAll("rect.startpoint");var ak=ar.selectAll("rect.endpoint");var au=ar.selectAll("rect.midpoint");if(aB.permissions.canWrite&&aB.permissions.canRead){am=am.data([aB.start]);am.enter().append("rect").attr({"class":"startpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(){m.select(M.select(this.parentNode));Q.setURLParameters()}).call(y.activate);Q.transition(am,Y).attr("transform",function(aF){return"translate("+(aF.x-4)+", "+(aF.y-4)+")"});am.exit().remove();var ak=ak.data([aB.end]);ak.enter().append("rect").call(N).attr({"class":"endpoint linepoint","pointer-events":"all",width:8,height:8}).on("mousedown.selection",function(){m.select(M.select(this.parentNode));Q.setURLParameters()}).call(y.activate);Q.transition(ak,Y).attr("transform",function(aF){return"translate("+(aF.x-4)+", "+(aF.y-4)+")"});ak.exit().remove();var au=au.data(aB.bends);au.enter().append("rect").attr({"class":"midpoint linepoint","pointer-events":"all",width:8,height:8}).call(S).on("dblclick",function(aI){M.event.stopPropagation();var aF=M.select(this.parentNode);var aM=aF.datum();var aL=Q.getConnectionSourceComponentId(aM);var aK=Q.getConnectionDestinationComponentId(aM);if(aL===aK&&aB.component.bends.length<=2){i.showOkDialog({headerText:"Connection",dialogContent:"Looping connections must have at least two bend points."});return}var aH=[];var aG=-1;C.each(aM.component.bends,function(aO,aN){if(aI.x!==aN.x&&aI.y!==aN.y){aH.push(aN)}else{aG=aO}});if(aG<0){return}var aF={id:aM.id,bends:aH};var aJ=aM.component.labelIndex;if(aH.length<=1){aF.labelIndex=0}else{if(aG<=aJ){aF.labelIndex=Math.max(0,aJ-1)}}u(aM,aF)}).on("mousedown.selection",function(){m.select(M.select(this.parentNode));Q.setURLParameters()}).call(y.activate);Q.transition(au,Y).attr("transform",function(aF){return"translate("+(aF.x-4)+", "+(aF.y-4)+")"});au.exit().remove()}else{am.remove();ak.remove();au.remove()}}if(X===true){var ah=ar.select("g.connection-label-container");if(ar.classed("visible")){if(ah.empty()){ah=ar.insert("g","rect.startpoint").attr({"class":"connection-label-container","pointer-events":"all"}).on("mousedown.selection",function(){m.select(M.select(this.parentNode));Q.setURLParameters()}).call(y.activate);ah.append("rect").attr({"class":"body",width:I.width,x:0,y:0});ah.append("rect").attr({"class":"border",width:I.width,fill:"transparent",stroke:"transparent"})}var at=0;var ad=19;var az=[];var ai=[];var aq=ah.select("g.connection-from-container");var aD=ah.select("g.connection-to-container");var av=ah.select("g.connection-name-container");if(aB.permissions.canRead){if(J(aB.component.source)){if(aq.empty()){aq=ah.append("g").attr({"class":"connection-from-container"});az.push(aq.append("rect").attr({"class":"connection-label-background",width:I.width,height:ad}));ai.push(aq.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));aq.append("text").attr({"class":"stats-label",x:5,y:14}).text("From");aq.append("text").attr({"class":"stats-value connection-from",x:43,y:14,width:130});aq.append("text").attr({"class":"connection-from-run-status",x:185,y:14})}else{az.push(aq.select("rect.connection-label-background"));ai.push(aq.select("rect.connection-label-border"))}aq.attr("transform",function(){var aF=(ad*at++);return"translate(0, "+aF+")"});aq.select("text.connection-from").each(function(){var aF=M.select(this);aF.text(null).selectAll("title").remove();Q.ellipsis(aF,aB.component.source.name)}).append("title").text(function(){return aB.component.source.name});aq.select("text.connection-from-run-status").text(function(){if(aB.component.source.exists===false){return"\uf071"}else{if(aB.component.source.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aB.component.source.exists===false){return false}else{return aB.component.source.running}}).classed("stopped",function(){if(aB.component.source.exists===false){return false}else{return !aB.component.source.running}}).classed("is-missing-port",function(){return aB.component.source.exists===false})}else{aq.remove()}if(J(aB.component.destination)){if(aD.empty()){aD=ah.append("g").attr({"class":"connection-to-container"});az.push(aD.append("rect").attr({"class":"connection-label-background",width:I.width,height:ad}));ai.push(aD.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));aD.append("text").attr({"class":"stats-label",x:5,y:14}).text("To");aD.append("text").attr({"class":"stats-value connection-to",x:25,y:14,width:145});aD.append("text").attr({"class":"connection-to-run-status",x:185,y:14})}else{az.push(aD.select("rect.connection-label-background"));ai.push(aD.select("rect.connection-label-border"))}aD.attr("transform",function(){var aF=(ad*at++);return"translate(0, "+aF+")"});aD.select("text.connection-to").each(function(aG){var aF=M.select(this);aF.text(null).selectAll("title").remove();Q.ellipsis(aF,aG.component.destination.name)}).append("title").text(function(aF){return aF.component.destination.name});aD.select("text.connection-to-run-status").text(function(){if(aB.component.destination.exists===false){return"\uf071"}else{if(aB.component.destination.running===true){return"\uf04b"}else{return"\uf04d"}}}).classed("running",function(){if(aB.component.destination.exists===false){return false}else{return aB.component.destination.running}}).classed("stopped",function(){if(aB.component.destination.exists===false){return false}else{return !aB.component.destination.running}}).classed("is-missing-port",function(){return aB.component.destination.exists===false})}else{aD.remove()}var ae=Q.formatConnectionName(aB.component);if(!K.isBlank(ae)){if(av.empty()){av=ah.append("g").attr({"class":"connection-name-container"});az.push(av.append("rect").attr({"class":"connection-label-background",width:I.width,height:ad}));ai.push(av.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));av.append("text").attr({"class":"stats-label",x:5,y:14}).text("Name");av.append("text").attr({"class":"stats-value connection-name",x:45,y:14,width:142})}else{az.push(av.select("rect.connection-label-background"));ai.push(av.select("rect.connection-label-border"))}av.attr("transform",function(){var aF=(ad*at++);return"translate(0, "+aF+")"});av.select("text.connection-name").each(function(){var aF=M.select(this);aF.text(null).selectAll("title").remove();Q.ellipsis(aF,ae)}).append("title").text(function(){return ae})}else{av.remove()}}else{aq.remove();aD.remove();av.remove()}var ay=3;var aa=ah.select("g.queued-container");if(aa.empty()){aa=ah.append("g").attr({"class":"queued-container"});az.push(aa.append("rect").attr({"class":"connection-label-background",width:I.width,height:ad+ay}));ai.push(aa.append("rect").attr({"class":"connection-label-border",width:I.width,height:1}));aa.append("text").attr({"class":"stats-label",x:5,y:14}).text("Queued");var ax=aa.append("text").attr({"class":"stats-value queued",x:55,y:14});ax.append("tspan").attr({"class":"count"});ax.append("tspan").attr({"class":"size"});aa.append("text").attr({"class":"expiration-icon",x:185,y:14}).text(function(){return"\uf017"}).append("title");var ac=ad+ay-4;aa.append("rect").attr({"class":"backpressure-tick object",width:1,height:3,x:5,y:ac});var ao=6;aa.append("rect").attr({"class":"backpressure-object",width:g,height:3,x:ao,y:ac}).append("title");aa.append("rect").attr({"class":"backpressure-tick object",width:1,height:3,x:ao+g,y:ac});aa.append("rect").attr({"class":"backpressure-percent object",width:0,height:3,x:ao,y:ac});aa.append("rect").attr({"class":"backpressure-tick data-size",width:1,height:3,x:(I.width/2)+10,y:ac});var al=(I.width/2)+10+1;aa.append("rect").attr({"class":"backpressure-data-size",width:g,height:3,x:al,y:ac}).append("title");aa.append("rect").attr({"class":"backpressure-tick data-size",width:1,height:3,x:al+g,y:ac});aa.append("rect").attr({"class":"backpressure-percent data-size",width:0,height:3,x:al,y:ac})}else{az.push(aa.select("rect.connection-label-background"));ai.push(aa.select("rect.connection-label-border"))}aa.attr("transform",function(){var aF=(ad*at++);return"translate(0, "+aF+")"});ah.select("rect.body").attr("height",function(){return(ad*at)+ay}).classed("unauthorized",function(){return aB.permissions.canRead===false});ah.select("rect.border").attr("height",function(){return(ad*at)+ay}).classed("unauthorized",function(){return aB.permissions.canRead===false});C.each(az,function(aG,aF){if(aG%2===0){aF.attr("fill","#f4f6f7")}else{aF.attr("fill","#ffffff")}});C.each(ai,function(aG,aF){if(aG>0){aF.attr("fill","#c7d2d7")}else{aF.attr("fill","transparent")}});ah.select("text.expiration-icon").classed("hidden",function(){if(aB.permissions.canRead){return !n(aB.component)}else{return true}}).select("title").text(function(){if(aB.permissions.canRead){return"Expires FlowFiles older than "+aB.component.flowFileExpiration}else{return""}});ah.select("rect.backpressure-object").classed("not-configured",function(){return K.isUndefinedOrNull(aB.status.aggregateSnapshot.percentUseCount)});ah.selectAll("rect.backpressure-tick.object").classed("not-configured",function(){return K.isUndefinedOrNull(aB.status.aggregateSnapshot.percentUseCount)});ah.select("rect.backpressure-data-size").classed("not-configured",function(){return K.isUndefinedOrNull(aB.status.aggregateSnapshot.percentUseBytes)});ah.selectAll("rect.backpressure-tick.data-size").classed("not-configured",function(){return K.isUndefinedOrNull(aB.status.aggregateSnapshot.percentUseBytes)});if(aB.permissions.canWrite){ah.call(s)}ar.call(D)}else{if(!ah.empty()){ah.remove()}}}Q.transition(ar.select("g.connection-label-container"),Y).attr("transform",function(){var aG=M.select(this).select("rect.body");var aF=P(aG);return"translate("+aF.x+", "+aF.y+")"})})};var D=function(U){if(U.empty()){return}var V=C.Deferred(function(X){U.select("text.queued tspan.count").text(function(Z){return K.substringBeforeFirst(Z.status.aggregateSnapshot.queued," ")});var Y=U.select("rect.backpressure-percent.data-size");Y.transition().duration(400).attr({width:function(Z){if(K.isDefinedAndNotNull(Z.status.aggregateSnapshot.percentUseBytes)){return(g*Z.status.aggregateSnapshot.percentUseBytes)/100}else{return 0}}}).each("end",function(){Y.classed("warning",function(Z){return B(Z)}).classed("error",function(Z){return G(Z)});X.resolve()});U.select("rect.backpressure-data-size").select("title").text(function(Z){if(K.isDefinedAndNotNull(Z.status.aggregateSnapshot.percentUseBytes)){return"Queue is "+Z.status.aggregateSnapshot.percentUseBytes+"% full based on Back Pressure Data Size Threshold"}else{return"Back Pressure Data Size Threshold is not configured"}})}).promise();var W=C.Deferred(function(X){U.select("text.queued tspan.size").text(function(Z){return" "+K.substringAfterFirst(Z.status.aggregateSnapshot.queued," ")});var Y=U.select("rect.backpressure-percent.object");Y.transition().duration(400).attr({width:function(Z){if(K.isDefinedAndNotNull(Z.status.aggregateSnapshot.percentUseCount)){return(g*Z.status.aggregateSnapshot.percentUseCount)/100}else{return 0}}}).each("end",function(){Y.classed("warning",function(Z){return e(Z)}).classed("error",function(Z){return k(Z)});X.resolve()});U.select("rect.backpressure-object").select("title").text(function(Z){if(K.isDefinedAndNotNull(Z.status.aggregateSnapshot.percentUseCount)){return"Queue is "+Z.status.aggregateSnapshot.percentUseCount+"% full based on Back Pressure Object Threshold"}else{return"Back Pressure Object Threshold is not configured"}})}).promise();C.when(V,W).done(function(){U.select("path.connection-path").classed("full",function(X){return l(X)||H(X)}).attr({"marker-end":p});U.select("rect.border").classed("full",function(X){return l(X)||H(X)});U.select("rect.body").attr({filter:c})})};var u=function(W,V){var U={revision:f.getRevision(W),component:V};return C.ajax({type:"PUT",url:W.uri,data:JSON.stringify(U),dataType:"json",contentType:"application/json"}).done(function(X){T.set(X)}).fail(function(Z,X,Y){if(Z.status===400||Z.status===404||Z.status===409){i.showOkDialog({headerText:"Connection",dialogContent:K.escapeHtml(Z.responseText)})}else{d.handleAjaxError(Z,X,Y)}})};var h=function(U){U.each(function(V){Q.reloadConnectionSourceAndDestination(V.sourceId,V.destinationId)});U.remove()};var T={config:{selfLoopXOffset:(I.width/2)+5,selfLoopYOffset:25},init:function(U,V,W){m=U;y=V;r=W;o=M.map();z=M.map();w=M.map();q=M.select("#canvas").append("g").attr({"pointer-events":"stroke","class":"connections"});A=M.svg.line().x(function(X){return X.x}).y(function(X){return X.y}).interpolate("linear");S=M.behavior.drag().on("dragstart",function(){M.event.sourceEvent.stopPropagation()}).on("drag",function(X){X.x=M.event.x;X.y=M.event.y;M.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("dragend",function(){var X=M.select(this.parentNode);var ab=X.datum();var Z=X.selectAll("rect.midpoint").data();if(Z.length===ab.component.bends.length){var aa=false;for(var Y=0;Y<Z.length&&!aa;Y++){if(Z[Y].x!==ab.component.bends[Y].x||Z[Y].y!==ab.component.bends[Y].y){aa=true}}if(aa){u(ab,{id:ab.id,bends:Z}).fail(function(){ab.bends=C.map(ab.component.bends,function(ac){return{x:ac.x,y:ac.y}});X.call(a,{updatePath:true,updateLabel:false})})}}M.event.sourceEvent.stopPropagation()});N=M.behavior.drag().on("dragstart",function(X){X.dragging=true;M.event.sourceEvent.stopPropagation()}).on("drag",function(X){X.x=M.event.x-8;X.y=M.event.y-8;M.select("g.hover").classed("connectable-destination",function(){return Q.isValidConnectionDestination(M.select(this))});M.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}).on("dragend",function(af){af.dragging=false;var Y=M.select(this.parentNode);var ah=Y.datum();var X=ah.destinationId;var ag=M.select("g.connectable-destination");if(ag.empty()){Y.call(a,{updatePath:true,updateLabel:false})}else{if(Q.isProcessGroup(ag)||Q.isRemoteProcessGroup(ag)){r.showConfiguration(Y,ag).done(function(){Q.reloadConnectionSourceAndDestination(null,X)}).fail(function(){Y.call(a,{updatePath:true,updateLabel:false})})}else{var ab=ag.datum();var ad=Q.getConnectableTypeForDestination(ag);var ac={revision:f.getRevision(ah),component:{id:ah.id,destination:{id:ab.id,groupId:Q.getGroupId(),type:ad}}};if(ah.bends.length<2&&ah.sourceId===ab.id){var Z={x:ab.position.x+(ab.dimensions.width),y:ab.position.y+(ab.dimensions.height/2)};var ae=T.config.selfLoopXOffset;var aa=T.config.selfLoopYOffset;ac.component.bends=[];ac.component.bends.push({x:(Z.x+ae),y:(Z.y-aa)});ac.component.bends.push({x:(Z.x+ae),y:(Z.y+aa)})}C.ajax({type:"PUT",url:ah.uri,data:JSON.stringify(ac),dataType:"json",contentType:"application/json"}).done(function(aj){var ai=aj.component;T.set(aj);Q.reloadConnectionSourceAndDestination(null,X);Q.reloadConnectionSourceAndDestination(aj.sourceId,aj.destinationId)}).fail(function(ak,ai,aj){if(ak.status===400||ak.status===401||ak.status===403||ak.status===404||ak.status===409){i.showOkDialog({headerText:"Connection",dialogContent:K.escapeHtml(ak.responseText)});Y.call(a,{updatePath:true,updateLabel:false})}else{d.handleAjaxError(ak,ai,aj)}})}}M.event.sourceEvent.stopPropagation()});s=M.behavior.drag().on("dragstart",function(X){M.event.sourceEvent.stopPropagation()}).on("drag",function(ac){if(ac.bends.length>1){var Z=M.select("rect.label-drag");if(Z.empty()){var ab=M.select(this).select("rect.body");var aa=P(ab);var X=I.width;var ag=ab.attr("height");Z=M.select("#canvas").append("rect").attr("x",aa.x).attr("y",aa.y).attr("class","label-drag").attr("width",X).attr("height",ag).attr("stroke-width",function(){return 1/Q.scaleCanvasView()}).attr("stroke-dasharray",function(){return 4/Q.scaleCanvasView()}).datum({x:aa.x,y:aa.y,width:X,height:ag})}else{Z.attr("x",function(ah){ah.x+=M.event.dx;return ah.x}).attr("y",function(ah){ah.y+=M.event.dy;return ah.y})}var ad=Z.datum();var af={x:ad.x+(ad.width/2),y:ad.y+(ad.height/2)};var Y=-1;var ae;C.each(ac.bends,function(aj,ai){var ah={x:ai.x,y:ai.y};var ak=t(af,ah);if(Y===-1||ak<ae){Y=aj;ae=ak}});ac.labelIndex=Y;M.select(this.parentNode).call(a,{updatePath:true,updateLabel:false})}}).on("dragend",function(Z){if(Z.bends.length>1){var Y=M.select("rect.label-drag");if(!Y.empty()){Y.remove()}if(Z.labelIndex!==Z.component.labelIndex){var X=M.select(this.parentNode);u(Z,{id:Z.id,labelIndex:Z.labelIndex}).fail(function(){Z.labelIndex=Z.component.labelIndex;X.call(a,{updatePath:true,updateLabel:false})})}}M.event.sourceEvent.stopPropagation()})},add:function(U,W){var Y=false;if(K.isDefinedAndNotNull(W)){Y=K.isDefinedAndNotNull(W.selectAll)?W.selectAll:Y}var V=new Date().getTime();var Z=function(aa){w.set(aa.id,V);o.set(aa.id,C.extend({type:"Connection"},aa))};if(C.isArray(U)){C.each(U,function(aa,ab){Z(ab)})}else{if(K.isDefinedAndNotNull(U)){Z(U)}}var X=L();X.enter().call(O,Y);X.call(a,{updatePath:true,updateLabel:false}).call(R)},isDisconnected:function(W){if(W.empty()){return false}var V=M.map();var X=M.map();var U=true;W.filter(function(Y){return Y.type==="Connection"}).each(function(Y){V.set(Y.id,Y)});W.filter(function(Y){return Y.type!=="Connection"}).each(function(Y){X.set(Y.id,Y.component);C.each(T.getComponentConnections(Y.id),function(aa,Z){if(!V.has(Z.id)){U=false;return false}})});if(U){V.forEach(function(Z,Y){if(U){U=X.has(Q.getConnectionSourceComponentId(Y))&&X.has(Q.getConnectionDestinationComponentId(Y))}})}return U},set:function(U,V){var Y=false;var Z=false;var X=false;if(K.isDefinedAndNotNull(V)){Y=K.isDefinedAndNotNull(V.selectAll)?V.selectAll:Y;Z=K.isDefinedAndNotNull(V.transition)?V.transition:Z;X=K.isDefinedAndNotNull(V.overrideRevisionCheck)?V.overrideRevisionCheck:X}var aa=function(ab){var ac=o.get(ab.id);if((f.isNewerRevision(ac,ab)&&!z.has(ab.id))||X===true){o.set(ab.id,C.extend({type:"Connection"},ab))}};if(C.isArray(U)){C.each(o.keys(),function(ac,ad){var ae=o.get(ad);var ab=C.grep(U,function(af){return af.id===ae.id});if(ab.length===0&&!w.has(ad)){o.remove(ad)}});C.each(U,function(ab,ac){aa(ac)})}else{if(K.isDefinedAndNotNull(U)){aa(U)}}var W=L();W.enter().call(O,Y);W.call(a,{updatePath:true,updateLabel:true,transition:Z}).call(R);W.exit().call(h)},refresh:function(U){if(K.isDefinedAndNotNull(U)){M.select("#id-"+U).call(a,{updatePath:true,updateLabel:true})}else{M.selectAll("g.connection").call(a,{updatePath:true,updateLabel:true})}},pan:function(){M.selectAll("g.connection.entering, g.connection.leaving").call(a,{updatePath:false,updateLabel:true})},remove:function(V){var U=new Date().getTime();if(C.isArray(V)){C.each(V,function(W,X){z.set(X,U);o.remove(X)})}else{z.set(V,U);o.remove(V)}L().exit().call(h)},removeAll:function(){T.remove(o.keys())},reload:function(V){if(o.has(V)){var U=o.get(V);return C.ajax({type:"GET",url:U.uri,dataType:"json"}).done(function(W){T.set(W)})}},reloadStatus:function(U){if(o.has(U)){return C.ajax({type:"GET",url:"../nifi-api/flow/connections/"+encodeURIComponent(U)+"/status",dataType:"json"}).done(function(V){var W=o.get(U);W.status=V.connectionStatus;o.set(U,W);L().call(D)})}},getComponentConnections:function(V){var U=[];o.forEach(function(W,X){if(Q.getConnectionSourceComponentId(X)===V||Q.getConnectionDestinationComponentId(X)===V){U.push(X)}});return U},get:function(U){if(K.isUndefined(U)){return o.values()}else{return o.get(U)}},expireCaches:function(V){var U=function(W){W.forEach(function(Y,X){if(V>X){W.remove(Y)}})};U(w);U(z)}};return T}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Funnel=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Funnel=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Funnel=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(b,r,d,s,o){var i;var l;var e;var m;var c={width:48,height:48};var j;var q;var a;var p;var k=function(){return p.selectAll("g.funnel").data(j.values(),function(t){return t.id})};var g=function(v,u){if(v.empty()){return v}var t=v.append("g").attr({id:function(w){return"id-"+w.id},"class":"funnel component"}).classed("selected",u).call(o.position);t.append("rect").attr({rx:2,ry:2,"class":"border",width:function(w){return w.dimensions.width},height:function(w){return w.dimensions.height},fill:"transparent",stroke:"transparent"});t.append("rect").attr({rx:2,ry:2,"class":"body",width:function(w){return w.dimensions.width},height:function(w){return w.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});t.append("text").attr({"class":"funnel-icon",x:9,y:34}).text("\ue803");t.call(e.activate).call(m.activate)};var h=function(t){if(t.empty()){return}t.select("rect.border").classed("unauthorized",function(u){return u.permissions.canRead===false});t.select("rect.body").classed("unauthorized",function(u){return u.permissions.canRead===false});t.each(function(){var u=r.select(this);o.editable(u,i,l)})};var f=function(t){t.remove()};var n={init:function(v,w,t,u){i=v;l=w;e=t;m=u;j=r.map();q=r.map();a=r.map();p=r.select("#canvas").append("g").attr({"pointer-events":"all","class":"funnels"})},add:function(v,u){var x=false;if(d.isDefinedAndNotNull(u)){x=d.isDefinedAndNotNull(u.selectAll)?u.selectAll:x}var t=new Date().getTime();var y=function(z){a.set(z.id,t);j.set(z.id,b.extend({type:"Funnel",dimensions:c},z))};if(b.isArray(v)){b.each(v,function(A,z){y(z)})}else{if(d.isDefinedAndNotNull(v)){y(v)}}var w=k();w.enter().call(g,x);w.call(h)},set:function(u,t){var x=false;var y=false;var w=false;if(d.isDefinedAndNotNull(t)){x=d.isDefinedAndNotNull(t.selectAll)?t.selectAll:x;y=d.isDefinedAndNotNull(t.transition)?t.transition:y;w=d.isDefinedAndNotNull(t.overrideRevisionCheck)?t.overrideRevisionCheck:w}var z=function(B){var A=j.get(B.id);if((s.isNewerRevision(A,B)&&!q.has(B.id))||w===true){j.set(B.id,b.extend({type:"Funnel",dimensions:c},B))}};if(b.isArray(u)){b.each(j.keys(),function(B,D){var C=j.get(D);var A=b.grep(u,function(E){return E.id===C.id});if(A.length===0&&!a.has(D)){j.remove(D)}});b.each(u,function(B,A){z(A)})}else{if(d.isDefinedAndNotNull(u)){z(u)}}var v=k();v.enter().call(g,x);v.call(h).call(o.position,y);v.exit().call(f)},get:function(t){if(d.isUndefined(t)){return j.values()}else{return j.get(t)}},refresh:function(t){if(d.isDefinedAndNotNull(t)){r.select("#id-"+t).call(h)}else{r.selectAll("g.funnel").call(h)}},reload:function(u){if(j.has(u)){var t=j.get(u);return b.ajax({type:"GET",url:t.uri,dataType:"json"}).done(function(v){n.set(v)})}},position:function(t){r.select("#id-"+t).call(o.position)},remove:function(u){var t=new Date().getTime();if(b.isArray(u)){b.each(u,function(w,v){q.set(v,t);j.remove(v)})}else{q.set(u,t);j.remove(u)}k().exit().call(f)},removeAll:function(){n.remove(j.keys())},expireCaches:function(u){var t=function(v){v.forEach(function(x,w){if(u>w){v.remove(x)}})};t(a);t(q)}};return n}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Label=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Label=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Label=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(e,t,j,v,r){var l;var o;var k;var p;var i={width:150,height:150};var a=20;var h=64;var f;var s;var d;var b;var c;var n=function(){return b.selectAll("g.label").data(f.values(),function(w){return w.id})};var u=function(y,x){if(y.empty()){return}var w=y.append("g").attr({id:function(z){return"id-"+z.id},"class":"label component"}).classed("selected",x).call(r.position);w.append("rect").attr({"class":"border",fill:"transparent",stroke:"transparent"});w.append("rect").attr({"class":"body",filter:"url(#component-drop-shadow)","stroke-width":0});w.append("text").attr({"xml:space":"preserve","font-weight":"bold",fill:"black","class":"label-value"});w.call(k.activate).call(p.activate)};var g=function(w){if(w.empty()){return}w.select("rect.border").attr({width:function(x){return x.dimensions.width},height:function(x){return x.dimensions.height}}).classed("unauthorized",function(x){return x.permissions.canRead===false});w.select("rect.body").attr({width:function(x){return x.dimensions.width},height:function(x){return x.dimensions.height}}).style("fill",function(y){if(!y.permissions.canRead){return null}var x=m.defaultColor();if(j.isDefinedAndNotNull(y.component.style["background-color"])){x=y.component.style["background-color"]}return x}).classed("unauthorized",function(x){return x.permissions.canRead===false});w.each(function(E){var A=t.select(this);r.editable(A,l,o);var D=A.select("text.label-value");var C=A.selectAll("rect.labelpoint");if(E.permissions.canRead){D.attr("font-size",function(){var F="12px";if(j.isDefinedAndNotNull(E.component.style["font-size"])){F=E.component.style["font-size"]}return F});D.selectAll("tspan").remove();var y=[];if(j.isDefinedAndNotNull(E.component.label)){y=E.component.label.split("\n")}else{y.push("")}var z=m.defaultColor();if(j.isDefinedAndNotNull(E.component.style["background-color"])){z=E.component.style["background-color"]}e.each(y,function(G,F){D.append("tspan").attr("x","0.4em").attr("dy","1.2em").text(function(){return F}).style("fill",function(H){return j.determineContrastColor(j.substringAfterLast(z,"#"))})});if(E.permissions.canWrite){var x=[{x:E.dimensions.width,y:E.dimensions.height}];var B=C.data(x);B.enter().append("rect").attr({"class":"labelpoint",width:10,height:10}).call(c);B.attr("transform",function(F){return"translate("+(F.x-10)+", "+(F.y-10)+")"});B.exit().remove()}}else{D.selectAll("tspan").remove();C.remove()}})};var q=function(w){w.remove()};var m={config:{width:i.width,height:i.height},init:function(y,z,w,x){l=y;o=z;k=w;p=x;f=t.map();s=t.map();d=t.map();b=t.select("#canvas").append("g").attr({"pointer-events":"all","class":"labels"});c=t.behavior.drag().on("dragstart",function(){t.event.sourceEvent.stopPropagation()}).on("drag",function(){var A=t.select(this.parentNode);var B=A.datum();B.dimensions.width=Math.max(h,t.event.x);B.dimensions.height=Math.max(a,t.event.y);g(A)}).on("dragend",function(){var B=t.select(this.parentNode);var C=B.datum();var D=false;if(j.isDefinedAndNotNull(C.component.width)||C.dimensions.width!==C.component.width){D=true}if(!D&&j.isDefinedAndNotNull(C.component.height)||C.dimensions.height!==C.component.height){D=true}if(D){var A={revision:v.getRevision(C),component:{id:C.id,width:C.dimensions.width,height:C.dimensions.height}};e.ajax({type:"PUT",url:C.uri,data:JSON.stringify(A),dataType:"json",contentType:"application/json"}).done(function(E){m.set(E)}).fail(function(){var F=i.width;if(j.isDefinedAndNotNull(C.component.width)){F=C.component.width}var E=i.height;if(j.isDefinedAndNotNull(C.component.height)){E=C.component.height}C.dimensions={width:F,height:E};B.call(g)})}t.event.sourceEvent.stopPropagation()})},add:function(z,x){var A=false;if(j.isDefinedAndNotNull(x)){A=j.isDefinedAndNotNull(x.selectAll)?x.selectAll:A}var w=new Date().getTime();var B=function(C){d.set(C.id,w);f.set(C.id,e.extend({type:"Label"},C))};if(e.isArray(z)){e.each(z,function(D,C){B(C)})}else{if(j.isDefinedAndNotNull(z)){B(z)}}var y=n();y.enter().call(u,A);y.call(g)},set:function(y,w){var A=false;var B=false;var z=false;if(j.isDefinedAndNotNull(w)){A=j.isDefinedAndNotNull(w.selectAll)?w.selectAll:A;B=j.isDefinedAndNotNull(w.transition)?w.transition:B;z=j.isDefinedAndNotNull(w.overrideRevisionCheck)?w.overrideRevisionCheck:z}var C=function(D){var E=f.get(D.id);if((v.isNewerRevision(E,D)&&!s.has(D.id))||z===true){f.set(D.id,e.extend({type:"Label"},D))}};if(e.isArray(y)){e.each(f.keys(),function(E,G){var F=f.get(G);var D=e.grep(y,function(H){return H.id===F.id});if(D.length===0&&!d.has(G)){f.remove(G)}});e.each(y,function(E,D){C(D)})}else{if(j.isDefinedAndNotNull(y)){C(y)}}var x=n();x.enter().call(u,A);x.call(g).call(r.position,B);x.exit().call(q)},get:function(w){if(j.isUndefined(w)){return f.values()}else{return f.get(w)}},refresh:function(w){if(j.isDefinedAndNotNull(w)){t.select("#id-"+w).call(g)}else{t.selectAll("g.label").call(g)}},reload:function(x){if(f.has(x)){var w=f.get(x);return e.ajax({type:"GET",url:w.uri,dataType:"json"}).done(function(y){m.set(y)})}},position:function(w){t.select("#id-"+w).call(r.position)},remove:function(x){var w=new Date().getTime();if(e.isArray(x)){e.each(x,function(y,z){s.set(z,w);f.remove(z)})}else{s.set(x,w);f.remove(x)}n().exit().call(q)},removeAll:function(){m.remove(f.keys())},expireCaches:function(x){var w=function(y){y.forEach(function(A,z){if(x>z){y.remove(A)}})};w(d);w(s)},defaultColor:function(){return"#fff7d7"}};return m}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Port=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Port=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Port=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(d,w,h,x,t){var l;var q;var i;var r;var m=15;var j=25;var u={width:240,height:50};var n={width:240,height:75};var e;var v;var c;var g;var p=function(){return g.selectAll("g.input-port, g.output-port").data(e.values(),function(y){return y.id})};var k=function(A,z){if(A.empty()){return}var y=A.append("g").attr({id:function(C){return"id-"+C.id},"class":function(C){if(C.portType==="INPUT_PORT"){return"input-port component"}else{return"output-port component"}}}).classed("selected",z).call(t.position);y.append("rect").attr({"class":"border",width:function(C){return C.dimensions.width},height:function(C){return C.dimensions.height},fill:"transparent",stroke:"transparent"});y.append("rect").attr({"class":"body",width:function(C){return C.dimensions.width},height:function(C){return C.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});var B=0;if(t.getParentGroupId()===null){B=j;y.append("rect").attr({"class":"remote-banner",width:function(C){return C.dimensions.width},height:B,fill:"#e3e8eb"})}y.append("text").attr({"class":"port-icon",x:10,y:38+B}).text(function(C){if(C.portType==="INPUT_PORT"){return"\ue832"}else{return"\ue833"}});y.append("text").attr({x:70,y:25+B,width:95,height:30,"class":"port-name"});y.call(i.activate).call(r.activate);y.filter(function(C){return C.permissions.canWrite&&C.permissions.canRead}).call(q.activate).call(l.activate)};var o=function(y){if(y.empty()){return}y.select("rect.border").classed("unauthorized",function(z){return z.permissions.canRead===false});y.select("rect.body").classed("unauthorized",function(z){return z.permissions.canRead===false});y.each(function(A){var z=w.select(this);var B=z.select("g.port-details");t.editable(z,l,q);if(z.classed("visible")){if(B.empty()){B=z.append("g").attr("class","port-details");var C=0;if(t.getParentGroupId()===null){C=j;B.append("text").attr({"class":"port-transmission-icon",x:10,y:18});B.append("rect").attr({"class":"bulletin-background",x:function(D){return A.dimensions.width-C},width:C,height:C});B.append("text").attr({"class":"bulletin-icon",x:function(D){return A.dimensions.width-18},y:18}).text("\uf24a")}B.append("text").attr({"class":"run-status-icon",x:50,y:function(){return 25+C}});B.append("text").attr({"class":"active-thread-count-icon",y:43+C}).text("\ue83f");B.append("text").attr({"class":"active-thread-count",y:43+C})}if(A.permissions.canRead){z.select("text.port-name").each(function(G){var F=w.select(this);var D=G.component.name;var E=D.split(/\s+/);F.text(null).selectAll("tspan, title").remove();if(E.length===1){t.ellipsis(F,D)}else{t.multilineEllipsis(F,2,D)}}).append("title").text(function(D){return D.component.name})}else{z.select("text.port-name").text(null)}z.call(f)}else{if(A.permissions.canRead){z.select("text.port-name").text(function(E){var D=E.component.name;if(D.length>m){return D.substring(0,m)+String.fromCharCode(8230)}else{return D}})}else{z.select("text.port-name").text(null)}z.call(b);if(!B.empty()){B.remove()}}})};var f=function(y){if(y.empty()){return}y.select("text.run-status-icon").attr({fill:function(A){var z="#728e9b";if(A.status.aggregateSnapshot.runStatus==="Invalid"){z="#cf9f5d"}else{if(A.status.aggregateSnapshot.runStatus==="Running"){z="#7dc7a0"}else{if(A.status.aggregateSnapshot.runStatus==="Stopped"){z="#d18686"}}}return z},"font-family":function(A){var z="FontAwesome";if(A.status.aggregateSnapshot.runStatus==="Disabled"){z="flowfont"}return z}}).text(function(A){var z="";if(A.status.aggregateSnapshot.runStatus==="Disabled"){z="\ue802"}else{if(A.status.aggregateSnapshot.runStatus==="Invalid"){z="\uf071"}else{if(A.status.aggregateSnapshot.runStatus==="Running"){z="\uf04b"}else{if(A.status.aggregateSnapshot.runStatus==="Stopped"){z="\uf04d"}}}}return z}).each(function(A){var z=w.select("#run-status-tip-"+A.id);if(A.permissions.canRead&&!h.isEmpty(A.component.validationErrors)){if(z.empty()){z=w.select("#port-tooltips").append("div").attr("id",function(){return"run-status-tip-"+A.id}).attr("class","tooltip nifi-tooltip")}z.html(function(){var B=h.formatUnorderedList(A.component.validationErrors);if(B===null||B.length===0){return""}else{return d("<div></div>").append(B).html()}});t.canvasTooltip(z,w.select(this))}else{if(!z.empty()){z.remove()}}});y.select("text.port-transmission-icon").attr({"font-family":function(z){if(z.status.transmitting===true){return"FontAwesome"}else{return"flowfont"}}}).text(function(z){if(z.status.transmitting===true){return"\uf140"}else{return"\ue80a"}}).classed("transmitting",function(z){if(z.status.transmitting===true){return true}else{return false}}).classed("not-transmitting",function(z){if(z.status.transmitting!==true){return true}else{return false}});y.each(function(B){var z=w.select(this);var A=0;t.activeThreadCount(z,B,function(C){A=C});z.select("rect.bulletin-background").classed("has-bulletins",function(){return !h.isEmpty(B.status.aggregateSnapshot.bulletins)});t.bulletins(z,B,function(){return w.select("#port-tooltips")},A)})};var s=function(y){if(y.empty()){return}y.call(b).remove()};var b=function(y){y.each(function(z){d("#run-status-tip-"+z.id).remove();d("#bulletin-tip-"+z.id).remove()})};var a={init:function(A,B,y,z){l=A;q=B;i=y;r=z;e=w.map();v=w.map();c=w.map();g=w.select("#canvas").append("g").attr({"pointer-events":"all","class":"ports"})},add:function(C,z){var D=false;if(h.isDefinedAndNotNull(z)){D=h.isDefinedAndNotNull(z.selectAll)?z.selectAll:D}var B=u;if(t.getParentGroupId()===null){B=n}var y=new Date().getTime();var E=function(F){c.set(F.id,y);e.set(F.id,d.extend({type:"Port",dimensions:B,status:{activeThreadCount:0}},F))};if(d.isArray(C)){d.each(C,function(G,F){E(F)})}else{if(h.isDefinedAndNotNull(C)){E(C)}}var A=p();A.enter().call(k,D);A.call(o)},set:function(B,y){var D=false;var E=false;var C=false;if(h.isDefinedAndNotNull(y)){D=h.isDefinedAndNotNull(y.selectAll)?y.selectAll:D;E=h.isDefinedAndNotNull(y.transition)?y.transition:E;C=h.isDefinedAndNotNull(y.overrideRevisionCheck)?y.overrideRevisionCheck:C}var A=u;if(t.getParentGroupId()===null){A=n}var F=function(G){var H=e.get(G.id);if((x.isNewerRevision(H,G)&&!v.has(G.id))||C===true){e.set(G.id,d.extend({type:"Port",dimensions:A,status:{activeThreadCount:0}},G))}};if(d.isArray(B)){d.each(e.keys(),function(H,I){var J=e.get(I);var G=d.grep(B,function(K){return K.id===J.id});if(G.length===0&&!c.has(I)){e.remove(I)}});d.each(B,function(H,G){F(G)})}else{if(h.isDefinedAndNotNull(B)){F(B)}}var z=p();z.enter().call(k,D);z.call(o).call(t.position,E);z.exit().call(s)},get:function(y){if(h.isUndefined(y)){return e.values()}else{return e.get(y)}},refresh:function(y){if(h.isDefinedAndNotNull(y)){w.select("#id-"+y).call(o)}else{w.selectAll("g.input-port, g.output-port").call(o)}},pan:function(){w.selectAll("g.input-port.entering, g.output-port.entering, g.input-port.leaving, g.output-port.leaving").call(o)},reload:function(z){if(e.has(z)){var y=e.get(z);return d.ajax({type:"GET",url:y.uri,dataType:"json"}).done(function(A){a.set(A)})}},position:function(y){w.select("#id-"+y).call(t.position)},remove:function(z){var y=new Date().getTime();if(d.isArray(z)){d.each(z,function(A,B){v.set(B,y);e.remove(B)})}else{v.set(z,y);e.remove(z)}p().exit().call(s)},removeAll:function(){a.remove(e.keys())},expireCaches:function(z){var y=function(A){A.forEach(function(C,B){if(z>B){A.remove(C)}})};y(c);y(v)}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils","nf.Dialog"],function(g,e,i,h,c,d,f){return(nf.ProcessGroup=b(g,e,i,h,c,d,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Dialog")))}else{nf.ProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.Dialog)}}}(this,function(g,z,k,j,A,v,p){var m;var t;var l;var u;var n=30;var i={width:380,height:172};var d;var y;var e;var q;var o=function(B){if(j.isBlank(B.component.comments)){return"No comments specified"}else{return B.component.comments}};var s=function(){return q.selectAll("g.process-group").data(d.values(),function(B){return B.id})};var w=function(D,B){if(D.empty()){return}var C=D.append("g").attr({id:function(E){return"id-"+E.id},"class":"process-group component"}).classed("selected",B).call(v.position);C.append("rect").attr({"class":"border",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},fill:"transparent",stroke:"transparent"});C.append("rect").attr({"class":"body",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});C.append("rect").attr({width:function(E){return E.dimensions.width},height:32,fill:"#b8c6cd"});C.append("text").attr({x:10,y:20,width:316,height:16,"class":"process-group-name"});C.on("dblclick",function(E){h.enterGroup(E.id)}).call(l.activate).call(u.activate);C.filter(function(E){return E.permissions.canWrite&&E.permissions.canRead}).on("mouseover.drop",function(I){var G=z.select(this);if(!G.classed("drop")){var H=G.datum();var F=z.select("rect.drag-selection");if(!F.empty()){var E=v.getSelection().filter(function(J){return H.id===J.id});if(E.empty()){G.classed("drop",function(){return k.isDisconnected(v.getSelection())})}}}}).on("mouseout.drop",function(E){z.select(this).classed("drop",false)}).call(t.activate).call(m.activate)};var b=10;var a=5;var x=function(B){if(B.empty()){return}B.select("rect.border").classed("unauthorized",function(C){return C.permissions.canRead===false});B.select("rect.body").classed("unauthorized",function(C){return C.permissions.canRead===false});B.each(function(H){var S=z.select(this);var Q=S.select("g.process-group-details");v.editable(S,m,t);if(S.classed("visible")){if(Q.empty()){Q=S.append("g").attr("class","process-group-details");Q.append("rect").attr({x:0,y:32,width:function(){return H.dimensions.width},height:24,fill:"#e3e8eb"});Q.append("text").attr({x:10,y:49,"class":"process-group-transmitting process-group-contents-icon","font-family":"FontAwesome"}).text("\uf140");Q.append("text").attr({y:49,"class":"process-group-transmitting-count process-group-contents-count"});Q.append("text").attr({y:49,"class":"process-group-not-transmitting process-group-contents-icon","font-family":"flowfont"}).text("\ue80a");Q.append("text").attr({y:49,"class":"process-group-not-transmitting-count process-group-contents-count"});Q.append("text").attr({y:49,"class":"process-group-running process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04b");Q.append("text").attr({y:49,"class":"process-group-running-count process-group-contents-count"});Q.append("text").attr({y:49,"class":"process-group-stopped process-group-contents-icon","font-family":"FontAwesome"}).text("\uf04d");Q.append("text").attr({y:49,"class":"process-group-stopped-count process-group-contents-count"});Q.append("text").attr({y:49,"class":"process-group-invalid process-group-contents-icon","font-family":"FontAwesome"}).text("\uf071");Q.append("text").attr({y:49,"class":"process-group-invalid-count process-group-contents-count"});Q.append("text").attr({y:49,"class":"process-group-disabled process-group-contents-icon","font-family":"flowfont"}).text("\ue802");Q.append("text").attr({y:49,"class":"process-group-disabled-count process-group-contents-count"});Q.append("rect").attr({width:function(){return H.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});Q.append("rect").attr({width:function(){return H.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});Q.append("rect").attr({width:function(){return H.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});Q.append("rect").attr({width:function(){return H.dimensions.width},height:1,x:0,y:103,fill:"#c7d2d7"});Q.append("rect").attr({width:function(){return H.dimensions.width},height:19,x:0,y:104,fill:"#f4f6f7"});Q.append("rect").attr({width:function(){return H.dimensions.width},height:1,x:0,y:122,fill:"#c7d2d7"});Q.append("rect").attr({width:function(){return H.dimensions.width},height:19,x:0,y:123,fill:"#ffffff"});var P=Q.append("g").attr({transform:"translate(6, 75)"});P.append("text").attr({width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Queued");P.append("text").attr({width:73,height:10,x:4,y:24,"class":"stats-label"}).text("In");P.append("text").attr({width:73,height:10,x:4,y:42,"class":"stats-label"}).text("Read/Write");P.append("text").attr({width:73,height:10,x:4,y:60,"class":"stats-label"}).text("Out");var D=Q.append("g").attr({transform:"translate(95, 75)"});var N=D.append("text").attr({width:180,height:10,x:4,y:5,"class":"process-group-queued stats-value"});N.append("tspan").attr({"class":"count"});N.append("tspan").attr({"class":"size"});var K=D.append("text").attr({width:180,height:10,x:4,y:24,"class":"process-group-in stats-value"});K.append("tspan").attr({"class":"count"});K.append("tspan").attr({"class":"size"});K.append("tspan").attr({"class":"ports"});D.append("text").attr({width:180,height:10,x:4,y:42,"class":"process-group-read-write stats-value"});var M=D.append("text").attr({width:180,height:10,x:4,y:60,"class":"process-group-out stats-value"});M.append("tspan").attr({"class":"ports"});M.append("tspan").attr({"class":"count"});M.append("tspan").attr({"class":"size"});var J=Q.append("g").attr({transform:"translate(335, 75)"});J.append("text").attr({width:25,height:10,x:4,y:24,"class":"stats-info"}).text("5 min");J.append("text").attr({width:25,height:10,x:4,y:42,"class":"stats-info"}).text("5 min");J.append("text").attr({width:25,height:10,x:4,y:60,"class":"stats-info"}).text("5 min");Q.append("text").attr({x:10,y:160,width:342,height:22,"class":"process-group-comments"});Q.append("text").attr({"class":"active-thread-count-icon",y:20}).text("\ue83f");Q.append("text").attr({"class":"active-thread-count",y:20});Q.append("rect").attr({"class":"bulletin-background",x:function(){return H.dimensions.width-24},y:32,width:24,height:24});Q.append("text").attr({"class":"bulletin-icon",x:function(){return H.dimensions.width-17},y:49}).text("\uf24a")}var O=Q.select("text.process-group-transmitting").classed("transmitting",function(W){return W.permissions.canRead&&W.activeRemotePortCount>0}).classed("zero",function(W){return W.permissions.canRead&&W.activeRemotePortCount===0});var V=Q.select("text.process-group-transmitting-count").attr("x",function(){var W=parseInt(O.attr("x"),10);return W+Math.round(O.node().getComputedTextLength())+a}).text(function(W){return W.activeRemotePortCount});var C=Q.select("text.process-group-not-transmitting").classed("not-transmitting",function(W){return W.permissions.canRead&&W.inactiveRemotePortCount>0}).classed("zero",function(W){return W.permissions.canRead&&W.inactiveRemotePortCount===0}).attr("x",function(){var W=parseInt(V.attr("x"),10);return W+Math.round(V.node().getComputedTextLength())+b});var T=Q.select("text.process-group-not-transmitting-count").attr("x",function(){var W=parseInt(C.attr("x"),10);return W+Math.round(C.node().getComputedTextLength())+a}).text(function(W){return W.inactiveRemotePortCount});var E=Q.select("text.process-group-running").classed("running",function(W){return W.permissions.canRead&&W.component.runningCount>0}).classed("zero",function(W){return W.permissions.canRead&&W.component.runningCount===0}).attr("x",function(){var W=parseInt(T.attr("x"),10);return W+Math.round(T.node().getComputedTextLength())+b});var I=Q.select("text.process-group-running-count").attr("x",function(){var W=parseInt(E.attr("x"),10);return W+Math.round(E.node().getComputedTextLength())+a}).text(function(W){return W.runningCount});var F=Q.select("text.process-group-stopped").classed("stopped",function(W){return W.permissions.canRead&&W.component.stoppedCount>0}).classed("zero",function(W){return W.permissions.canRead&&W.component.stoppedCount===0}).attr("x",function(){var W=parseInt(I.attr("x"),10);return W+Math.round(I.node().getComputedTextLength())+b});var U=Q.select("text.process-group-stopped-count").attr("x",function(){var W=parseInt(F.attr("x"),10);return W+Math.round(F.node().getComputedTextLength())+a}).text(function(W){return W.stoppedCount});var R=Q.select("text.process-group-invalid").classed("invalid",function(W){return W.permissions.canRead&&W.component.invalidCount>0}).classed("zero",function(W){return W.permissions.canRead&&W.component.invalidCount===0}).attr("x",function(){var W=parseInt(U.attr("x"),10);return W+Math.round(U.node().getComputedTextLength())+b});var L=Q.select("text.process-group-invalid-count").attr("x",function(){var W=parseInt(R.attr("x"),10);return W+Math.round(R.node().getComputedTextLength())+a}).text(function(W){return W.invalidCount});var G=Q.select("text.process-group-disabled").classed("disabled",function(W){return W.permissions.canRead&&W.component.disabledCount>0}).classed("zero",function(W){return W.permissions.canRead&&W.component.disabledCount===0}).attr("x",function(){var W=parseInt(L.attr("x"),10);return W+Math.round(L.node().getComputedTextLength())+b});Q.select("text.process-group-disabled-count").attr("x",function(){var W=parseInt(G.attr("x"),10);return W+Math.round(G.node().getComputedTextLength())+a}).text(function(W){return W.disabledCount});if(H.permissions.canRead){Q.select("text.process-group-comments").each(function(X){var W=z.select(this);W.text(null).selectAll("tspan, title").remove();v.ellipsis(W,o(X))}).classed("unset",function(W){return j.isBlank(W.component.comments)}).append("title").text(function(W){return o(W)});S.select("text.process-group-name").each(function(X){var W=z.select(this);W.text(null).selectAll("title").remove();v.ellipsis(W,X.component.name)}).append("title").text(function(W){return W.component.name})}else{Q.select("text.process-group-comments").text(null);S.select("text.process-group-name").text(null)}S.call(f)}else{if(H.permissions.canRead){S.select("text.process-group-name").text(function(X){var W=X.component.name;if(W.length>n){return W.substring(0,n)+String.fromCharCode(8230)}else{return W}})}else{S.select("text.process-group-name").text(null)}S.call(c);if(!Q.empty()){Q.remove()}}})};var f=function(B){if(B.empty()){return}B.select("text.process-group-queued tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.queued," ")});B.select("text.process-group-queued tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.queued," ")});B.select("text.process-group-in tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.input," ")});B.select("text.process-group-in tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.input," ")});B.select("text.process-group-in tspan.ports").text(function(C){return" "+String.fromCharCode(8594)+" "+C.inputPortCount});B.select("text.process-group-read-write").text(function(C){return C.status.aggregateSnapshot.read+" / "+C.status.aggregateSnapshot.written});B.select("text.process-group-out tspan.ports").text(function(C){return C.outputPortCount+" "+String.fromCharCode(8594)+" "});B.select("text.process-group-out tspan.count").text(function(C){return j.substringBeforeFirst(C.status.aggregateSnapshot.output," ")});B.select("text.process-group-out tspan.size").text(function(C){return" "+j.substringAfterFirst(C.status.aggregateSnapshot.output," ")});B.each(function(E){var C=z.select(this);var D=0;v.activeThreadCount(C,E,function(F){D=F});C.select("rect.bulletin-background").classed("has-bulletins",function(){return !j.isEmpty(E.status.aggregateSnapshot.bulletins)});v.bulletins(C,E,function(){return z.select("#process-group-tooltips")},D)})};var r=function(B){if(B.empty()){return}B.call(c).remove()};var c=function(B){B.each(function(C){g("#bulletin-tip-"+C.id).remove()})};var h={init:function(D,E,B,C){m=D;t=E;l=B;u=C;d=z.map();y=z.map();e=z.map();q=z.select("#canvas").append("g").attr({"pointer-events":"all","class":"process-groups"})},add:function(G,C){var E=false;if(j.isDefinedAndNotNull(C)){E=j.isDefinedAndNotNull(C.selectAll)?C.selectAll:E}var B=new Date().getTime();var F=function(H){e.set(H.id,B);d.set(H.id,g.extend({type:"ProcessGroup",dimensions:i},H))};if(g.isArray(G)){g.each(G,function(H,I){F(I)})}else{if(j.isDefinedAndNotNull(G)){F(G)}}var D=s();D.enter().call(w,E);D.call(x)},set:function(H,B){var E=false;var F=false;var D=false;if(j.isDefinedAndNotNull(B)){E=j.isDefinedAndNotNull(B.selectAll)?B.selectAll:E;F=j.isDefinedAndNotNull(B.transition)?B.transition:F;D=j.isDefinedAndNotNull(B.overrideRevisionCheck)?B.overrideRevisionCheck:D}var G=function(I){var J=d.get(I.id);if((A.isNewerRevision(J,I)&&!y.has(I.id))||D===true){d.set(I.id,g.extend({type:"ProcessGroup",dimensions:i},I))}};if(g.isArray(H)){g.each(d.keys(),function(J,K){var L=d.get(K);var I=g.grep(H,function(M){return M.id===L.id});if(I.length===0&&!e.has(K)){d.remove(K)}});g.each(H,function(I,J){G(J)})}else{if(j.isDefinedAndNotNull(H)){G(H)}}var C=s();C.enter().call(w,E);C.call(x).call(v.position,F);C.exit().call(r)},get:function(B){if(j.isUndefined(B)){return d.values()}else{return d.get(B)}},refresh:function(B){if(j.isDefinedAndNotNull(B)){z.select("#id-"+B).call(x)}else{z.selectAll("g.process-group").call(x)}},pan:function(){z.selectAll("g.process-group.entering, g.process-group.leaving").call(x)},reload:function(C){if(d.has(C)){var B=d.get(C);return g.ajax({type:"GET",url:B.uri,dataType:"json"}).done(function(D){h.set(D)})}},position:function(B){z.select("#id-"+B).call(v.position)},remove:function(C){var B=new Date().getTime();if(g.isArray(C)){g.each(C,function(E,D){y.set(D,B);d.remove(D)})}else{y.set(C,B);d.remove(C)}s().exit().call(r)},removeAll:function(){h.remove(d.keys())},expireCaches:function(C){var B=function(D){D.forEach(function(F,E){if(C>E){D.remove(F)}})};B(e);B(y)},enterGroup:function(B){u.hide();v.setGroupId(B);return v.reload().done(function(){var C=v.restoreUserView();if(C===false){v.fitCanvasView();v.refreshCanvasView({transition:true})}v.setURLParameters(B,z.select())}).fail(function(){p.showOkDialog({headerText:"Process Group",dialogContent:"Unable to enter the selected group."})})}};return h}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,h,g,c,d){return(nf.RemoteProcessGroup=b(f,e,h,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroup=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.RemoteProcessGroup=b(a.$,a.d3,a.nf.Connection,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(h,z,l,k,A,w){var n;var u;var m;var v;var o=30;var i={width:380,height:158};var d;var x;var e;var y;var q=function(B){if(k.isBlank(B.component.comments)){return"No comments specified"}else{return B.component.comments}};var t=function(){return y.selectAll("g.remote-process-group").data(d.values(),function(B){return B.id})};var g=function(D,B){if(D.empty()){return}var C=D.append("g").attr({id:function(E){return"id-"+E.id},"class":"remote-process-group component"}).classed("selected",B).call(w.position);C.append("rect").attr({"class":"border",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},fill:"transparent",stroke:"transparent"});C.append("rect").attr({"class":"body",width:function(E){return E.dimensions.width},height:function(E){return E.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});C.append("rect").attr({width:function(E){return E.dimensions.width},height:32,fill:"#b8c6cd"});C.append("text").attr({x:30,y:20,width:305,height:16,"class":"remote-process-group-name"});C.call(m.activate).call(v.activate)};var a=5;var s=function(B){if(B.empty()){return}B.select("rect.border").classed("unauthorized",function(C){return C.permissions.canRead===false});B.select("rect.body").classed("unauthorized",function(C){return C.permissions.canRead===false});B.each(function(H){var I=z.select(this);var F=I.select("g.remote-process-group-details");w.editable(I,n,u);if(I.classed("visible")){if(F.empty()){F=I.append("g").attr("class","remote-process-group-details");F.append("text").attr({"class":"remote-process-group-transmission-status",x:10,y:20});F.append("rect").attr({x:0,y:32,width:function(){return H.dimensions.width},height:24,fill:"#e3e8eb"});F.append("text").attr({"class":"remote-process-group-transmission-secure",x:10,y:48});F.append("text").attr({x:30,y:48,width:305,height:12,"class":"remote-process-group-uri"});F.append("rect").attr({width:function(){return H.dimensions.width},height:19,x:0,y:66,fill:"#f4f6f7"});F.append("rect").attr({width:function(){return H.dimensions.width},height:1,x:0,y:84,fill:"#c7d2d7"});F.append("rect").attr({width:function(){return H.dimensions.width},height:19,x:0,y:85,fill:"#ffffff"});F.append("rect").attr({width:function(){return H.dimensions.width},height:1,x:0,y:103,fill:"#c7d2d7"});var G=F.append("g").attr({transform:"translate(6, 75)"});G.append("text").attr({width:73,height:10,x:4,y:5,"class":"stats-label"}).text("Sent");G.append("text").attr({width:73,height:10,x:4,y:23,"class":"stats-label"}).text("Received");var J=F.append("g").attr({transform:"translate(95, 75)"});var C=J.append("text").attr({width:180,height:10,x:4,y:5,"class":"remote-process-group-sent stats-value"});C.append("tspan").attr({"class":"count"});C.append("tspan").attr({"class":"size"});C.append("tspan").attr({"class":"ports"});var D=J.append("text").attr({width:180,height:10,x:4,y:23,"class":"remote-process-group-received stats-value"});D.append("tspan").attr({"class":"ports"});D.append("tspan").attr({"class":"count"});D.append("tspan").attr({"class":"size"});var E=F.append("g").attr({transform:"translate(335, 75)"});E.append("text").attr({width:25,height:10,x:4,y:5,"class":"stats-info"}).text("5 min");E.append("text").attr({width:25,height:10,x:4,y:23,"class":"stats-info"}).text("5 min");F.append("text").attr({x:10,y:121,width:342,height:22,"class":"remote-process-group-comments"});F.append("rect").attr({x:0,y:function(){return H.dimensions.height-24},width:function(){return H.dimensions.width},height:24,fill:"#e3e8eb"});F.append("text").attr({x:370,y:150,"class":"remote-process-group-last-refresh"});F.append("text").attr({"class":"active-thread-count-icon",y:20}).text("\ue83f");F.append("text").attr({"class":"active-thread-count",y:20});F.append("rect").attr({"class":"bulletin-background",x:function(){return H.dimensions.width-24},y:32,width:24,height:24});F.append("text").attr({"class":"bulletin-icon",x:function(){return H.dimensions.width-17},y:50}).text("\uf24a")}if(H.permissions.canRead){F.select("text.remote-process-group-uri").each(function(L){var K=z.select(this);K.text(null).selectAll("title").remove();w.ellipsis(K,L.component.targetUris)}).append("title").text(function(K){return K.component.name});F.select("text.remote-process-group-transmission-secure").text(function(L){var K="";if(L.component.targetSecure===true){K="\uf023"}else{K="\uf09c"}return K}).each(function(L){var K=z.select("#transmission-secure-"+L.id);if(K.empty()){K=z.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"transmission-secure-"+L.id}).attr("class","tooltip nifi-tooltip")}K.text(function(){if(L.component.targetSecure===true){return"Site-to-Site is secure."}else{return"Site-to-Site is NOT secure."}});w.canvasTooltip(K,z.select(this))});F.select("text.remote-process-group-comments").each(function(L){var K=z.select(this);K.text(null).selectAll("tspan, title").remove();w.ellipsis(K,q(L))}).classed("unset",function(K){return k.isBlank(K.component.comments)}).append("title").text(function(K){return q(K)});F.select("text.remote-process-group-last-refresh").text(function(K){if(k.isDefinedAndNotNull(K.component.flowRefreshed)){return K.component.flowRefreshed}else{return"Remote flow not current"}});I.select("text.remote-process-group-name").each(function(L){var K=z.select(this);K.text(null).selectAll("title").remove();w.ellipsis(K,L.component.name)}).append("title").text(function(K){return K.component.name})}else{F.select("text.remote-process-group-uri").text(null);F.select("text.remote-process-group-transmission-secure").text(null);F.select("text.remote-process-group-comments").text(null);F.select("text.remote-process-group-last-refresh").text(null);I.select("text.remote-process-group-name").text(null)}I.call(f)}else{if(H.permissions.canRead){I.select("text.remote-process-group-name").text(function(L){var K=L.component.name;if(K.length>o){return K.substring(0,o)+String.fromCharCode(8230)}else{return K}})}else{I.select("text.remote-process-group-name").text(null)}I.call(b);if(!F.empty()){F.remove()}}})};var c=function(B){return !k.isEmpty(B.component.authorizationIssues)||!k.isEmpty(B.component.validationErrors)};var p=function(C){var B=[];if(!k.isEmpty(C.component.authorizationIssues)){B=B.concat(C.component.authorizationIssues)}if(!k.isEmpty(C.component.validationErrors)){B=B.concat(C.component.validationErrors)}return B};var f=function(B){if(B.empty()){return}B.select("text.remote-process-group-sent tspan.count").text(function(C){return k.substringBeforeFirst(C.status.aggregateSnapshot.sent," ")});B.select("text.remote-process-group-sent tspan.size").text(function(C){return" "+k.substringAfterFirst(C.status.aggregateSnapshot.sent," ")});B.select("text.remote-process-group-sent tspan.ports").text(function(C){return" "+String.fromCharCode(8594)+" "+C.inputPortCount});B.select("text.remote-process-group-received tspan.ports").text(function(C){return C.outputPortCount+" "+String.fromCharCode(8594)+" "});B.select("text.remote-process-group-received tspan.count").text(function(C){return k.substringBeforeFirst(C.status.aggregateSnapshot.received," ")});B.select("text.remote-process-group-received tspan.size").text(function(C){return" "+k.substringAfterFirst(C.status.aggregateSnapshot.received," ")});B.select("text.remote-process-group-transmission-status").text(function(D){var C="";if(D.permissions.canRead){if(c(D)){C="\uf071"}else{if(D.component.transmitting===true){C="\uf140"}else{C="\ue80a"}}}return C}).attr("font-family",function(D){var C="";if(D.permissions.canRead){if(c(D)||D.component.transmitting){C="FontAwesome"}else{C="flowfont"}}return C}).classed("invalid",function(C){return C.permissions.canRead&&c(C)}).classed("transmitting",function(C){return C.permissions.canRead&&!c(C)&&C.component.transmitting===true}).classed("not-transmitting",function(C){return C.permissions.canRead&&!c(C)&&C.component.transmitting===false}).each(function(D){var C=z.select("#authorization-issues-"+D.id);if(D.permissions.canRead&&c(D)){if(C.empty()){C=z.select("#remote-process-group-tooltips").append("div").attr("id",function(){return"authorization-issues-"+D.id}).attr("class","tooltip nifi-tooltip")}C.html(function(){var E=k.formatUnorderedList(p(D));if(E===null||E.length===0){return""}else{return h("<div></div>").append(E).html()}});w.canvasTooltip(C,z.select(this))}else{if(!C.empty()){C.remove()}}});B.each(function(E){var C=z.select(this);var D=0;w.activeThreadCount(C,E,function(F){D=F});C.select("rect.bulletin-background").classed("has-bulletins",function(){return !k.isEmpty(E.status.aggregateSnapshot.bulletins)});w.bulletins(C,E,function(){return z.select("#remote-process-group-tooltips")},D)})};var j=function(B){if(B.empty()){return}B.call(b).remove()};var b=function(B){B.each(function(C){h("#bulletin-tip-"+C.id).remove();h("#authorization-issues-"+C.id).remove();h("#transmission-secure-"+C.id).remove()})};var r={init:function(D,E,B,C){n=D;u=E;m=B;v=C;d=z.map();x=z.map();e=z.map();y=z.select("#canvas").append("g").attr({"pointer-events":"all","class":"remote-process-groups"})},add:function(G,C){var E=false;if(k.isDefinedAndNotNull(C)){E=k.isDefinedAndNotNull(C.selectAll)?C.selectAll:E}var B=new Date().getTime();var F=function(H){e.set(H.id,B);d.set(H.id,h.extend({type:"RemoteProcessGroup",dimensions:i},H))};if(h.isArray(G)){h.each(G,function(H,I){F(I)})}else{if(k.isDefinedAndNotNull(G)){F(G)}}var D=t();D.enter().call(g,E);D.call(s)},set:function(H,B){var E=false;var F=false;var D=false;if(k.isDefinedAndNotNull(B)){E=k.isDefinedAndNotNull(B.selectAll)?B.selectAll:E;F=k.isDefinedAndNotNull(B.transition)?B.transition:F;D=k.isDefinedAndNotNull(B.overrideRevisionCheck)?B.overrideRevisionCheck:D}var G=function(I){var J=d.get(I.id);if((A.isNewerRevision(J,I)&&!x.has(I.id))||D===true){d.set(I.id,h.extend({type:"RemoteProcessGroup",dimensions:i},I))}};if(h.isArray(H)){h.each(d.keys(),function(J,K){var L=d.get(K);var I=h.grep(H,function(M){return M.id===L.id});if(I.length===0&&!e.has(K)){d.remove(K)}});h.each(H,function(I,J){G(J)})}else{if(k.isDefinedAndNotNull(H)){G(H)}}var C=t();C.enter().call(g,E);C.call(s).call(w.position,F);C.exit().call(j)},get:function(B){if(k.isUndefined(B)){return d.values()}else{return d.get(B)}},refresh:function(B){if(k.isDefinedAndNotNull(B)){z.select("#id-"+B).call(s)}else{z.selectAll("g.remote-process-group").call(s)}},pan:function(){z.selectAll("g.remote-process-group.entering, g.remote-process-group.leaving").call(s)},reload:function(C){if(d.has(C)){var B=d.get(C);return h.ajax({type:"GET",url:B.uri,dataType:"json"}).done(function(D){r.set(D);var E=l.getComponentConnections(C);h.each(E,function(G,F){if(F.permissions.canRead){l.reload(F.id)}})})}},position:function(B){z.select("#id-"+B).call(w.position)},remove:function(C){var B=new Date().getTime();if(h.isArray(C)){h.each(C,function(E,D){x.set(D,B);d.remove(D)})}else{x.set(C,B);d.remove(C)}t().exit().call(j)},removeAll:function(){r.remove(d.keys())},expireCaches:function(C){var B=function(D){D.forEach(function(F,E){if(C>E){D.remove(F)}})};B(e);B(x)}};return r}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Client","nf.CanvasUtils"],function(f,e,g,c,d){return(nf.Processor=b(f,e,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Processor=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils")))}else{nf.Processor=b(a.$,a.d3,a.nf.Common,a.nf.Client,a.nf.CanvasUtils)}}}(this,function(d,v,g,w,r){var j;var n;var h;var q;var k=25;var f={width:350,height:130};var t;var u;var b;var o;var m=function(){return o.selectAll("g.processor").data(t.values(),function(x){return x.id})};var c=function(z,y){if(z.empty()){return}var x=z.append("g").attr({id:function(A){return"id-"+A.id},"class":"processor component"}).classed("selected",y).call(r.position);x.append("rect").attr({"class":"border",width:function(A){return A.dimensions.width},height:function(A){return A.dimensions.height},fill:"transparent",stroke:"transparent"});x.append("rect").attr({"class":"body",width:function(A){return A.dimensions.width},height:function(A){return A.dimensions.height},filter:"url(#component-drop-shadow)","stroke-width":0});x.append("text").attr({x:75,y:18,width:210,height:14,"class":"processor-name"});x.append("rect").attr({x:0,y:0,width:50,height:50,"class":"processor-icon-container"});x.append("text").attr({x:9,y:35,"class":"processor-icon"}).text("\ue807");x.append("circle").attr({r:9,cx:12,cy:12,"class":"restricted-background"});x.append("text").attr({x:7.75,y:17,"class":"restricted"}).text("\uf132");x.call(h.activate).call(q.activate)};var s=function(x){if(x.empty()){return}x.select("rect.border").classed("unauthorized",function(y){return y.permissions.canRead===false}).classed("ghost",function(y){return y.permissions.canRead===true&&y.component.extensionMissing===true});x.select("rect.body").classed("unauthorized",function(y){return y.permissions.canRead===false});x.each(function(D){var A=v.select(this);var y=A.select("g.processor-canvas-details");r.editable(A,j,n);if(A.classed("visible")){if(y.empty()){y=A.append("g").attr("class","processor-canvas-details");y.append("text").attr({"class":"run-status-icon",x:55,y:23});y.append("text").attr({"class":"processor-type",x:75,y:32,width:230,height:12});y.append("text").attr({"class":"processor-bundle",x:75,y:45,width:230,height:12});y.append("rect").attr({width:function(){return D.dimensions.width},height:19,x:0,y:50,fill:"#f4f6f7"});y.append("rect").attr({width:function(){return D.dimensions.width},height:1,x:0,y:68,fill:"#c7d2d7"});y.append("rect").attr({width:function(){return D.dimensions.width},height:19,x:0,y:69,fill:"#ffffff"});y.append("rect").attr({width:function(){return D.dimensions.width},height:1,x:0,y:87,fill:"#c7d2d7"});y.append("rect").attr({width:function(){return D.dimensions.width},height:20,x:0,y:88,fill:"#f4f6f7"});y.append("rect").attr({width:function(){return D.dimensions.width},height:1,x:0,y:106,fill:"#c7d2d7"});y.append("rect").attr({width:function(){return D.dimensions.width},height:19,x:0,y:107,fill:"#ffffff"});var G=y.append("g").attr({transform:"translate(10, 55)"});G.append("text").attr({width:73,height:10,y:9,"class":"stats-label"}).text("In");G.append("text").attr({width:73,height:10,y:27,"class":"stats-label"}).text("Read/Write");G.append("text").attr({width:73,height:10,y:46,"class":"stats-label"}).text("Out");G.append("text").attr({width:73,height:10,y:65,"class":"stats-label"}).text("Tasks/Time");var z=y.append("g").attr({transform:"translate(85, 55)"});var F=z.append("text").attr({width:180,height:9,y:9,"class":"processor-in stats-value"});F.append("tspan").attr({"class":"count"});F.append("tspan").attr({"class":"size"});z.append("text").attr({width:180,height:10,y:27,"class":"processor-read-write stats-value"});var B=z.append("text").attr({width:180,height:10,y:46,"class":"processor-out stats-value"});B.append("tspan").attr({"class":"count"});B.append("tspan").attr({"class":"size"});z.append("text").attr({width:180,height:10,y:65,"class":"processor-tasks-time stats-value"});var E=y.append("g").attr("transform","translate(305, 55)");E.append("text").attr({width:25,height:10,y:9,"class":"stats-info"}).text("5 min");E.append("text").attr({width:25,height:10,y:27,"class":"stats-info"}).text("5 min");E.append("text").attr({width:25,height:10,y:46,"class":"stats-info"}).text("5 min");E.append("text").attr({width:25,height:10,y:65,"class":"stats-info"}).text("5 min");y.append("text").attr({"class":"active-thread-count-icon",y:45}).text("\ue83f");y.append("text").attr({"class":"active-thread-count",y:45});y.append("rect").attr({"class":"bulletin-background",x:function(H){return D.dimensions.width-24},width:24,height:24});y.append("text").attr({"class":"bulletin-icon",x:function(H){return D.dimensions.width-17},y:17}).text("\uf24a")}if(D.permissions.canRead){A.select("text.processor-name").each(function(I){var H=v.select(this);H.text(null).selectAll("title").remove();r.ellipsis(H,I.component.name)}).append("title").text(function(H){return H.component.name});A.select("text.processor-type").each(function(I){var H=v.select(this);H.text(null).selectAll("title").remove();r.ellipsis(H,g.formatType(I.component))}).append("title").text(function(H){return g.formatType(H.component)});A.select("text.processor-bundle").each(function(I){var H=v.select(this);H.text(null).selectAll("title").remove();r.ellipsis(H,g.formatBundle(I.component.bundle))}).append("title").text(function(H){return g.formatBundle(H.component.bundle)})}else{A.select("text.processor-name").text(null);A.select("text.processor-type").text(null);A.select("text.processor-bundle").text(null)}A.call(e)}else{if(D.permissions.canRead){A.select("text.processor-name").text(function(I){var H=I.component.name;if(H.length>k){return H.substring(0,k)+String.fromCharCode(8230)}else{return H}})}else{A.select("text.processor-name").text(null)}A.call(a);if(!y.empty()){y.remove()}}A.select("rect.processor-icon-container").classed("unauthorized",!D.permissions.canRead);A.select("text.processor-icon").classed("unauthorized",!D.permissions.canRead);A.select("rect.border").classed("unauthorized",!D.permissions.canRead);if(D.permissions.canRead){if(g.isDefinedAndNotNull(D.component.style["background-color"])){var C=D.component.style["background-color"];A.select("rect.processor-icon-container").style("fill",function(H){return C});A.select("rect.border").style("stroke",function(H){return C})}}A.select("text.processor-icon").style("fill",function(I){var H=l.defaultIconColor();if(!I.permissions.canRead){return H}if(g.isDefinedAndNotNull(I.component.style["background-color"])){H=I.component.style["background-color"];if(H.toLowerCase()==="#ffffff"){H=l.defaultIconColor()}else{H=g.determineContrastColor(g.substringAfterLast(H,"#"))}}return H});A.select("circle.restricted-background").style("visibility",i);A.select("text.restricted").style("visibility",i)})};var i=function(x){if(!x.permissions.canRead){return"hidden"}return x.component.restricted?"visible":"hidden"};var e=function(x){if(x.empty()){return}x.select("text.run-status-icon").attr({fill:function(z){var y="#728e9b";if(z.status.aggregateSnapshot.runStatus==="Invalid"){y="#cf9f5d"}else{if(z.status.aggregateSnapshot.runStatus==="Running"){y="#7dc7a0"}else{if(z.status.aggregateSnapshot.runStatus==="Stopped"){y="#d18686"}}}return y},"font-family":function(z){var y="FontAwesome";if(z.status.aggregateSnapshot.runStatus==="Disabled"){y="flowfont"}return y}}).text(function(z){var y="";if(z.status.aggregateSnapshot.runStatus==="Disabled"){y="\ue802"}else{if(z.status.aggregateSnapshot.runStatus==="Invalid"){y="\uf071"}else{if(z.status.aggregateSnapshot.runStatus==="Running"){y="\uf04b"}else{if(z.status.aggregateSnapshot.runStatus==="Stopped"){y="\uf04d"}}}}return y}).each(function(z){var y=v.select("#run-status-tip-"+z.id);if(z.permissions.canRead&&!g.isEmpty(z.component.validationErrors)){if(y.empty()){y=v.select("#processor-tooltips").append("div").attr("id",function(){return"run-status-tip-"+z.id}).attr("class","tooltip nifi-tooltip")}y.html(function(){var A=g.formatUnorderedList(z.component.validationErrors);if(A===null||A.length===0){return""}else{return d("<div></div>").append(A).html()}});r.canvasTooltip(y,v.select(this))}else{if(!y.empty()){y.remove()}}});x.select("text.processor-in tspan.count").text(function(y){return g.substringBeforeFirst(y.status.aggregateSnapshot.input," ")});x.select("text.processor-in tspan.size").text(function(y){return" "+g.substringAfterFirst(y.status.aggregateSnapshot.input," ")});x.select("text.processor-read-write").text(function(y){return y.status.aggregateSnapshot.read+" / "+y.status.aggregateSnapshot.written});x.select("text.processor-out tspan.count").text(function(y){return g.substringBeforeFirst(y.status.aggregateSnapshot.output," ")});x.select("text.processor-out tspan.size").text(function(y){return" "+g.substringAfterFirst(y.status.aggregateSnapshot.output," ")});x.select("text.processor-tasks-time").text(function(y){return y.status.aggregateSnapshot.tasks+" / "+y.status.aggregateSnapshot.tasksDuration});x.each(function(z){var y=v.select(this);r.activeThreadCount(y,z);y.select("rect.bulletin-background").classed("has-bulletins",function(){return !g.isEmpty(z.status.aggregateSnapshot.bulletins)});r.bulletins(y,z,function(){return v.select("#processor-tooltips")},286)})};var p=function(x){if(x.empty()){return}x.call(a).remove()};var a=function(x){x.each(function(y){d("#run-status-tip-"+y.id).remove();d("#bulletin-tip-"+y.id).remove()})};var l={init:function(z,A,x,y){j=z;n=A;h=x;q=y;t=v.map();u=v.map();b=v.map();o=v.select("#canvas").append("g").attr({"pointer-events":"all","class":"processors"})},add:function(x,z){var B=false;if(g.isDefinedAndNotNull(z)){B=g.isDefinedAndNotNull(z.selectAll)?z.selectAll:B}var y=new Date().getTime();var C=function(D){b.set(D.id,y);t.set(D.id,d.extend({type:"Processor",dimensions:f},D))};if(d.isArray(x)){d.each(x,function(D,E){C(E)})}else{if(g.isDefinedAndNotNull(x)){C(x)}}var A=m();A.enter().call(c,B);A.call(s)},set:function(x,y){var B=false;var C=false;var A=false;if(g.isDefinedAndNotNull(y)){B=g.isDefinedAndNotNull(y.selectAll)?y.selectAll:B;C=g.isDefinedAndNotNull(y.transition)?y.transition:C;A=g.isDefinedAndNotNull(y.overrideRevisionCheck)?y.overrideRevisionCheck:A}var D=function(F){var E=t.get(F.id);if((w.isNewerRevision(E,F)&&!u.has(F.id))||A===true){t.set(F.id,d.extend({type:"Processor",dimensions:f},F))}};if(d.isArray(x)){d.each(t.keys(),function(F,G){var H=t.get(G);var E=d.grep(x,function(I){return I.id===H.id});if(E.length===0&&!b.has(G)){t.remove(G)}});d.each(x,function(E,F){D(F)})}else{if(g.isDefinedAndNotNull(x)){D(x)}}var z=m();z.enter().call(c,B);z.call(s).call(r.position,C);z.exit().call(p)},get:function(x){if(g.isUndefined(x)){return t.values()}else{return t.get(x)}},refresh:function(x){if(g.isDefinedAndNotNull(x)){v.select("#id-"+x).call(s)}else{v.selectAll("g.processor").call(s)}},position:function(x){v.select("#id-"+x).call(r.position)},pan:function(){v.selectAll("g.processor.entering, g.processor.leaving").call(s)},reload:function(y){if(t.has(y)){var x=t.get(y);return d.ajax({type:"GET",url:x.uri,dataType:"json"}).done(function(z){l.set(z)})}},remove:function(y){var x=new Date().getTime();if(d.isArray(y)){d.each(y,function(z,A){u.set(A,x);t.remove(A)})}else{u.set(y,x);t.remove(y)}m().exit().call(p)},removeAll:function(){l.remove(t.keys())},expireCaches:function(y){var x=function(z){z.forEach(function(B,A){if(y>A){z.remove(B)}})};x(b);x(u)},defaultFillColor:function(){return"#FFFFFF"},defaultIconColor:function(){return"#ad9897"}};return l}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Processor","nf.ClusterSummary","nf.CustomUi","nf.UniversalCapture","nf.Connection"],function(f,l,c,e,n,d,g,m,k,j,h,i){return(nf.ProcessorConfiguration=b(f,l,c,e,n,d,g,m,k,j,h,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorConfiguration=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Processor"),require("nf.ClusterSummary"),require("nf.CustomUi"),require("nf.UniversalCapture"),require("nf.Connection")))}else{nf.ProcessorConfiguration=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Processor,a.nf.ClusterSummary,a.nf.CustomUi,a.nf.UniversalCapture,a.nf.Connection)}}}(this,function(d,f,h,m,w,t,x,l,g,b,s,i){var j=[0,25,50,100,250,500,1000,2000];var n=function(y){var z=[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Processor will be scheduled to run on an interval defined by the run schedule."}];if(y.supportsEventDriven===true){z.push({text:"Event driven",value:"EVENT_DRIVEN",description:"Processor will be scheduled to run when triggered by an event (e.g. a FlowFile enters an incoming queue). This scheduling strategy is experimental."})}else{if(y.config.schedulingStrategy==="EVENT_DRIVEN"){z.push({text:"Event driven",value:"EVENT_DRIVEN",description:"Processor will be scheduled to run when triggered by an event (e.g. a FlowFile enters an incoming queue). This scheduling strategy is experimental.",disabled:true})}}if(y.config.schedulingStrategy==="PRIMARY_NODE_ONLY"){z.push({text:"On primary node",value:"PRIMARY_NODE_ONLY",description:"Processor will be scheduled on the primary node on an interval defined by the run schedule. This option has been deprecated, please use the Execution setting below.",disabled:true})}z.push({text:"CRON driven",value:"CRON_DRIVEN",description:"Processor will be scheduled to run on at specific times based on the specified CRON string."});return z};var e=function(y){return[{text:"All nodes",value:"ALL",description:"Processor will be scheduled to run on all nodes"},{text:"Primary node",value:"PRIMARY",description:"Processor will be scheduled to run only on the primary node",disabled:!g.isClustered()&&y.config.executionNode==="PRIMARY"}]};var a=function(B,y,z){if(B.status===400){var C=B.responseText.split("\n");var A;if(C.length===1){A=d("<span></span>").text(C[0])}else{A=h.formatUnorderedList(C)}m.showOkDialog({dialogContent:A,headerText:"Processor Configuration"})}else{f.handleAjaxError(B,y,z)}};var o=function(D){var y=d('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text(D.name);var A=d('<span class="relationship-name-value hidden"></span>').text(D.name);var B=d('<div class="processor-relationship nf-checkbox"></div>');if(D.autoTerminate===true){B.addClass("checkbox-checked")}else{B.addClass("checkbox-unchecked")}var C=d('<div class="processor-relationship-container"></div>').append(B).append(y).append(A).appendTo("#auto-terminate-relationship-names");if(!h.isBlank(D.description)){var z=d('<div class="relationship-description"></div>').text(D.description);C.append(z)}return C};var v=function(){var A=d("#processor-configuration").data("processorDetails");var B=false;var C=q();d.each(A.relationships,function(E,F){if(F.autoTerminate===true){if(d.inArray(F.name,C)===-1){B=true;return false}}else{if(F.autoTerminate===false){if(d.inArray(F.name,C)>=0){B=true;return false}}}});if(B){return true}var D=d("#scheduling-strategy-combo").combo("getSelectedOption").value;if(D!==(A.config.schedulingStrategy+"")){return true}if(A.supportsParallelProcessing===true){var y;if(D==="EVENT_DRIVEN"){y=d("#event-driven-concurrently-schedulable-tasks")}else{if(D==="CRON_DRIVEN"){y=d("#cron-driven-concurrently-schedulable-tasks")}else{y=d("#timer-driven-concurrently-schedulable-tasks")}}if(y.val()!==(A.config.concurrentlySchedulableTaskCount+"")){return true}}var z;if(D==="CRON_DRIVEN"){z=d("#cron-driven-scheduling-period")}else{if(D!=="EVENT_DRIVEN"){z=d("#timer-driven-scheduling-period")}}if(h.isDefinedAndNotNull(z)&&z.val()!==(A.config.schedulingPeriod+"")){return true}if(d("#execution-node-combo").combo("getSelectedOption").value!==(A.config.executionNode+"")){return true}if(d("#processor-name").val()!==A.name){return true}if(d("#processor-enabled").hasClass("checkbox-checked")&&A.state==="DISABLED"){return true}else{if(d("#processor-enabled").hasClass("checkbox-unchecked")&&(A.state==="RUNNING"||A.state==="STOPPED")){return true}}if(d("#penalty-duration").val()!==(A.config.penaltyDuration+"")){return true}if(d("#yield-duration").val()!==(A.config.yieldDuration+"")){return true}if(d("#bulletin-level-combo").combo("getSelectedOption").value!==(A.config.bulletinLevel+"")){return true}if(d("#processor-comments").val()!==A.config.comments){return true}return d("#processor-properties").propertytable("isSaveRequired")};var k=function(A){var C={};var y=d("#scheduling-strategy-combo").combo("getSelectedOption").value;var F;if(y==="EVENT_DRIVEN"){F=d("#event-driven-concurrently-schedulable-tasks")}else{if(y==="CRON_DRIVEN"){F=d("#cron-driven-concurrently-schedulable-tasks")}else{F=d("#timer-driven-concurrently-schedulable-tasks")}}if(!F.is(":disabled")){C.concurrentlySchedulableTaskCount=F.val()}var D;if(y==="CRON_DRIVEN"){D=d("#cron-driven-scheduling-period")}else{if(y!=="EVENT_DRIVEN"){D=d("#timer-driven-scheduling-period")}}if(h.isDefinedAndNotNull(D)){C.schedulingPeriod=D.val()}C.executionNode=d("#execution-node-combo").combo("getSelectedOption").value;C.penaltyDuration=d("#penalty-duration").val();C.yieldDuration=d("#yield-duration").val();C.bulletinLevel=d("#bulletin-level-combo").combo("getSelectedOption").value;C.schedulingStrategy=y;C.comments=d("#processor-comments").val();if(A.supportsBatching===true){var z=d("#run-duration-slider").slider("value");C.runDurationMillis=j[z]}C.autoTerminatedRelationships=q();var E=d("#processor-properties").propertytable("marshalProperties");if(d.isEmptyObject(E)===false){C.properties=E}var B={};B.id=d("#processor-id").text();B.name=d("#processor-name").val();B.config=C;if(d("#processor-enabled").hasClass("checkbox-unchecked")){B.state="DISABLED"}else{if(d("#processor-enabled").hasClass("checkbox-checked")){B.state="STOPPED"}}var G={};G.component=B;return G};var q=function(){var z=d("#auto-terminate-relationship-names");var y=[];d.each(z.children(),function(A,D){var C=d(D);var B=C.children("div.processor-relationship");if(B.hasClass("checkbox-checked")){y.push(C.children("span.relationship-name-value").text())}});return y};var u=function(z){var B=[];var A=z.component;var y=A.config;if(h.isDefinedAndNotNull(y.concurrentlySchedulableTaskCount)&&!d.isNumeric(y.concurrentlySchedulableTaskCount)){B.push("Concurrent tasks must be an integer value")}if(h.isDefinedAndNotNull(y.schedulingPeriod)&&h.isBlank(y.schedulingPeriod)){B.push("Run schedule must be specified")}if(h.isBlank(y.penaltyDuration)){B.push("Penalty duration must be specified")}if(h.isBlank(y.yieldDuration)){B.push("Yield duration must be specified")}if(B.length>0){m.showOkDialog({dialogContent:h.formatUnorderedList(B),headerText:"Processor Configuration"});return false}else{return true}};var c=function(z){var y=i.getComponentConnections(z.id);d.each(y,function(B,A){if(A.permissions.canRead){if(A.sourceId===z.id){i.reload(A.id)}}})};var p=function(){return d.Deferred(function(y){d("#processor-properties").propertytable("saveRow");if(v()){m.showYesNoDialog({headerText:"Processor Configuration",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){y.resolve()},yesHandler:function(){var z=d("#processor-configuration").data("processorDetails");r(z).done(function(){y.resolve()}).fail(function(){y.reject()})}})}else{y.resolve()}}).promise()};var r=function(y){var z=k(y);if(u(z)){var A=l.get(y.id);z.revision=w.getRevision(A);return d.ajax({type:"PUT",data:JSON.stringify(z),url:A.uri,dataType:"json",contentType:"application/json"}).done(function(B){l.set(B)}).fail(a)}else{return d.Deferred(function(B){B.reject()}).promise()}};return{init:function(){d("#processor-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"processor-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"processor-scheduling-tab-content"},{name:"Properties",tabContentId:"processor-properties-tab-content"},{name:"Comments",tabContentId:"processor-comments-tab-content"}],select:function(){s.removeAllPropertyDetailDialogs();if(d(this).text()==="Properties"){d("#processor-properties").propertytable("resetTableSize")}d("#processor-properties").propertytable("saveRow");var y=d("#auto-terminate-relationship-names");if(y.is(":visible")&&y.get(0).scrollHeight>Math.round(y.innerHeight())){y.css("border-width","1px")}}});d("#processor-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Processor",handler:{close:function(){d("#auto-terminate-relationship-names").css("border-width","0").empty();d("#processor-properties").propertytable("cancelEdit").propertytable("clear");d("#processor-configuration").removeData("processorDetails")},open:function(){h.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});d("#bulletin-level-combo").combo({options:[{text:"DEBUG",value:"DEBUG"},{text:"INFO",value:"INFO"},{text:"WARN",value:"WARN"},{text:"ERROR",value:"ERROR"},{text:"NONE",value:"NONE"}]});d("#run-duration-slider").slider({min:0,max:j.length-1,change:function(z,A){var y=d("#processor-configuration").data("processorDetails");if(A.value>0&&(y.inputRequirement==="INPUT_FORBIDDEN"||y.inputRequirement==="INPUT_ALLOWED")){d("#run-duration-data-loss").show()}else{d("#run-duration-data-loss").hide()}}});d("#processor-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-processor-property-container",descriptorDeferred:function(y){var z=d("#processor-configuration").data("processorDetails");var A=l.get(z.id);return d.ajax({type:"GET",url:A.uri+"/descriptors",data:{propertyName:y},dataType:"json"}).fail(f.handleAjaxError)},goToServiceDeferred:p})},showConfiguration:function(z){if(t.isProcessor(z)){var A=z.datum();var y=A.component;var B=[];B.push(l.reload(y.id));B.push(d.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(y.id),dataType:"json"}));d.when.apply(window,B).done(function(K,N){var L=K[0];y=L.component;var H=N[0].componentHistory;d("#processor-configuration").data("processorDetails",y);var G="checkbox-checked";if(y.state==="DISABLED"){G="checkbox-unchecked"}d("#processor-id").text(y.id);d("#processor-type").text(h.formatType(y));d("#processor-bundle").text(h.formatBundle(y.bundle));d("#processor-name").val(y.name);d("#processor-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(G);d("#penalty-duration").val(y.config.penaltyDuration);d("#yield-duration").val(y.config.yieldDuration);d("#processor-comments").val(y.config.comments);if(y.supportsBatching===true){d("#run-duration-setting-container").show();var M=j.indexOf(y.config.runDurationMillis);d("#run-duration-slider").slider("value",M)}else{d("#run-duration-setting-container").hide()}d("#bulletin-level-combo").combo("setSelectedOption",{value:y.config.bulletinLevel});var E=y.config.schedulingStrategy;d("#scheduling-strategy-combo").combo({options:n(y),selectedOption:{value:E},select:function(P){if(P.value==="EVENT_DRIVEN"){d("#event-driven-warning").show();d("#timer-driven-options").hide();d("#event-driven-options").show();d("#cron-driven-options").hide()}else{d("#event-driven-warning").hide();if(P.value==="CRON_DRIVEN"){d("#timer-driven-options").hide();d("#event-driven-options").hide();d("#cron-driven-options").show()}else{d("#timer-driven-options").show();d("#event-driven-options").hide();d("#cron-driven-options").hide()}}}});var D=y.config.executionNode;d("#execution-node-combo").combo({options:e(y),selectedOption:{value:D}});if(g.isClustered()||D==="PRIMARY"){d("#execution-node-options").show()}else{d("#execution-node-options").hide()}var O=y.config.defaultConcurrentTasks;d("#timer-driven-concurrently-schedulable-tasks").val(O.TIMER_DRIVEN);d("#event-driven-concurrently-schedulable-tasks").val(O.EVENT_DRIVEN);d("#cron-driven-concurrently-schedulable-tasks").val(O.CRON_DRIVEN);var J;if(E==="EVENT_DRIVEN"){J=d("#event-driven-concurrently-schedulable-tasks").val(y.config.concurrentlySchedulableTaskCount)}else{if(E==="CRON_DRIVEN"){J=d("#cron-driven-concurrently-schedulable-tasks").val(y.config.concurrentlySchedulableTaskCount)}else{J=d("#timer-driven-concurrently-schedulable-tasks").val(y.config.concurrentlySchedulableTaskCount)}}if(h.isDefinedAndNotNull(J)){if(y.supportsParallelProcessing===true){J.prop("disabled",false)}else{J.prop("disabled",true)}}var F=y.config.defaultSchedulingPeriod;d("#cron-driven-scheduling-period").val(F.CRON_DRIVEN);d("#timer-driven-scheduling-period").val(F.TIMER_DRIVEN);if(y.config.schedulingStrategy==="CRON_DRIVEN"){d("#cron-driven-scheduling-period").val(y.config.schedulingPeriod)}else{if(y.config.schedulingStrategy!=="EVENT_DRIVEN"){d("#timer-driven-scheduling-period").val(y.config.schedulingPeriod)}}if(!h.isEmpty(y.relationships)){d.each(y.relationships,function(P,Q){o(Q)})}else{d("#auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}var I=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#processor-properties").propertytable("saveRow");r(y).done(function(P){c(y);d("#processor-configuration").modal("hide");x.digest()})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){d("#processor-configuration").modal("hide")}}}];if(h.isDefinedAndNotNull(y.config.customUiUrl)&&y.config.customUiUrl!==""){I.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var P=function(){d("#processor-configuration").modal("hide");b.showCustomUi(L,y.config.customUiUrl,true).done(function(){l.reload(y.id);c(y)})};d("#processor-properties").propertytable("saveRow");if(v()){m.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:P,yesHandler:function(){r(y).done(function(Q){P()})}})}else{P()}}}})}d("#processor-configuration").modal("setButtonModel",I);d("#processor-properties").propertytable("setGroupId",y.parentGroupId).propertytable("loadProperties",y.config.properties,y.config.descriptors,H.propertyHistory);d("#processor-configuration").modal("show");d("#processor-configuration div.relationship-name").ellipsis();var C=d("#auto-terminate-relationship-names");if(C.is(":visible")&&C.get(0).scrollHeight>Math.round(C.innerHeight())){C.css("border-width","1px")}}).fail(f.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.UniversalCapture","nf.Dialog","nf.ErrorHandler","nf.CustomUi","nf.ClusterSummary"],function(f,g,i,e,h,d,c){return(nf.ProcessorDetails=b(f,g,i,e,h,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessorDetails=b(require("jquery"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.ErrorHandler"),require("nf.CustomUi"),require("nf.ClusterSummary")))}else{nf.ProcessorDetails=b(a.$,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.ErrorHandler,a.nf.CustomUi,a.nf.ClusterSummary)}}}(this,function(e,f,h,d,g,c,a){var b=function(l){var i=e('<div class="relationship-name ellipsis"></div>').text(l.name);if(l.autoTerminate===true){i.css("font-weight","bold")}var k=e('<div class="processor-relationship-container"></div>').append(i).appendTo("#read-only-auto-terminate-relationship-names");if(!f.isBlank(l.description)){var j=e('<div class="relationship-description"></div>').text(l.description);k.append(j)}return k};return{init:function(i){e("#processor-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"details-standard-settings-tab-content"},{name:"Scheduling",tabContentId:"details-scheduling-tab-content"},{name:"Properties",tabContentId:"details-processor-properties-tab-content"},{name:"Comments",tabContentId:"details-processor-comments-tab-content"}],select:function(){h.removeAllPropertyDetailDialogs();if(e(this).text()==="Properties"){e("#read-only-processor-properties").propertytable("resetTableSize")}var j=e("#read-only-auto-terminate-relationship-names");if(j.is(":visible")&&j.get(0).scrollHeight>Math.round(j.innerHeight())){j.css("border-width","1px")}}});e("#processor-details").modal({headerText:"Processor Details",scrollableContentStyle:"scrollable",handler:{close:function(){e("#read-only-auto-terminate-relationship-names").css("border-width","0").empty();e("#read-only-processor-properties").propertytable("clear");f.clearField("read-only-processor-id");f.clearField("read-only-processor-type");f.clearField("read-only-processor-name");f.clearField("read-only-concurrently-schedulable-tasks");f.clearField("read-only-scheduling-period");f.clearField("read-only-penalty-duration");f.clearField("read-only-yield-duration");f.clearField("read-only-run-duration");f.clearField("read-only-bulletin-level");f.clearField("read-only-execution-node");f.clearField("read-only-execution-status");f.clearField("read-only-processor-comments");e("#processor-details").removeData("processorDetails");e("#processor-details").removeData("processorHistory")},open:function(){f.toggleScrollable(e("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});e("#read-only-processor-properties").propertytable({supportsGoTo:i,readOnly:true})},showDetails:function(k,l){var j=e.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(l),dataType:"json"}).done(function(n){if(f.isDefinedAndNotNull(n.component)){var o=n.component;e("#processor-details").data("processorDetails",o);f.populateField("read-only-processor-id",o.id);f.populateField("read-only-processor-type",f.formatType(o));f.populateField("read-only-processor-bundle",f.formatBundle(o.bundle));f.populateField("read-only-processor-name",o.name);f.populateField("read-only-concurrently-schedulable-tasks",o.config.concurrentlySchedulableTaskCount);f.populateField("read-only-scheduling-period",o.config.schedulingPeriod);f.populateField("read-only-penalty-duration",o.config.penaltyDuration);f.populateField("read-only-yield-duration",o.config.yieldDuration);f.populateField("read-only-run-duration",f.formatDuration(o.config.runDurationMillis));f.populateField("read-only-bulletin-level",o.config.bulletinLevel);f.populateField("read-only-processor-comments",o.config.comments);var m=true;var q=o.config.schedulingStrategy;if(q==="EVENT_DRIVEN"){m=false;q="Event driven"}else{if(q==="CRON_DRIVEN"){q="CRON driven"}else{if(q==="TIMER_DRIVEN"){q="Timer driven"}else{q="On primary node"}}}f.populateField("read-only-scheduling-strategy",q);if(m===true){e("#read-only-run-schedule").show()}else{e("#read-only-run-schedule").hide()}var p=o.config.executionNode;if(a.isClustered()||p==="PRIMARY"){if(p==="ALL"){p="All nodes"}else{if(p==="PRIMARY"){p="Primary node only"}}f.populateField("read-only-execution-node",p);e("#read-only-execution-node-options").show()}else{e("#read-only-execution-node-options").hide()}if(!f.isEmpty(o.relationships)){e.each(o.relationships,function(r,s){b(s)})}else{e("#read-only-auto-terminate-relationship-names").append('<div class="unset">This processor has no relationships.</div>')}}});var i=e.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(l),dataType:"json"}).done(function(m){var n=m.componentHistory;e("#processor-details").data("processorHistory",n)});e.when(j,i).done(function(t,o){var q=t[0];var n=q.component;var m=o[0];var s=m.componentHistory;e("#read-only-processor-properties").propertytable("loadProperties",n.config.properties,n.config.descriptors,s.propertyHistory);var p=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){e("#processor-details").modal("hide")}}}];if(top===window&&f.isDefinedAndNotNull(c)&&f.isDefinedAndNotNull(n.config.customUiUrl)&&n.config.customUiUrl!==""){p.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#processor-details").modal("hide");c.showCustomUi(q,n.config.customUiUrl,false)}}})}e("#processor-details").modal("setButtonModel",p).modal("show");e("#processor-details div.relationship-name").ellipsis();var r=e("#read-only-auto-terminate-relationship-names");if(r.is(":visible")&&r.get(0).scrollHeight>Math.round(r.innerHeight())){r.css("border-width","1px")}}).fail(function(o,m,n){if(o.status===400||o.status===404||o.status===409){d.showOkDialog({headerText:"Error",dialogContent:f.escapeHtml(o.responseText)})}else{g.handleAjaxError(o,m,n)}})}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Label"],function(g,f,i,h,d,e,c,j){return(nf.LabelConfiguration=b(g,f,i,h,d,e,c,j))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.LabelConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Label")))}else{nf.LabelConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Label)}}}(this,function(e,h,g,b,i,c,f,d){var a="";return{init:function(){e("#label-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Label",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var n=h.select("#id-"+a).datum();var m=e("#label-value").val();var o=e("#label-font-size").combo("getSelectedOption");var l={revision:i.getRevision(n),component:{id:a,label:m,style:{"font-size":o.value}}};e.ajax({type:"PUT",url:n.uri,data:JSON.stringify(l),dataType:"json",contentType:"application/json"}).done(function(p){d.set(p);f.digest()}).fail(g.handleAjaxError);this.modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){a=""}}});var k=[];for(var j=12;j<=24;j+=2){k.push({text:j+"px",value:j+"px"})}e("#label-font-size").combo({options:k,selectedOption:{value:"12px"},select:function(m){var l=e("#label-value");l.css({"font-size":m.value,"line-height":m.value}).val(l.val())}})},showConfiguration:function(k){if(c.isLabel(k)){var m=k.datum();var j="";if(b.isDefinedAndNotNull(m.component.label)){j=m.component.label}var l="12px";if(b.isDefinedAndNotNull(m.component.style["font-size"])){l=m.component.style["font-size"]}a=m.id;e("#label-value").val(j);e("#label-font-size").combo("setSelectedOption",{value:l});e("#label-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Port"],function(g,j,i,c,e,k,d,h,f){return(nf.PortConfiguration=b(g,j,i,c,e,k,d,h,f))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Port")))}else{nf.PortConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Port)}}}(this,function(f,i,h,b,d,j,c,g,e){var a=function(){f("#port-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Port",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var n=f("#port-id").text();var l=i.select("#id-"+n).datum();var k={id:n,name:f("#port-name").val(),comments:f("#port-comments").val()};if(f("#port-concurrent-task-container").is(":visible")){k.concurrentlySchedulableTaskCount=f("#port-concurrent-tasks").val()}if(f("#port-enabled").hasClass("checkbox-unchecked")){k.state="DISABLED"}else{if(f("#port-enabled").hasClass("checkbox-checked")){k.state="STOPPED"}}var m={revision:j.getRevision(l),component:k};f.ajax({type:"PUT",data:JSON.stringify(m),url:l.uri,dataType:"json",contentType:"application/json"}).done(function(o){e.set(o);g.digest();f("#port-configuration").modal("hide")}).fail(function(r,o,p){if(r.status===400){var s=r.responseText.split("\n");var q;if(s.length===1){q=f("<span></span>").text(s[0])}else{q=b.formatUnorderedList(s)}d.showOkDialog({dialogContent:q,headerText:"Port Configuration"})}else{f("#port-configuration").modal("hide");h.handleAjaxError(r,o,p)}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#port-configuration").modal("hide")}}}],handler:{close:function(){f("#port-id").text("");f("#port-name").val("");f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked");f("#port-concurrent-tasks").val("");f("#port-comments").val("")}}})};return{init:function(){a()},showConfiguration:function(l){if(c.isInputPort(l)||c.isOutputPort(l)){var m=l.datum();var k="checkbox-checked";if(m.component.state==="DISABLED"){k="checkbox-unchecked"}if(c.getParentGroupId()===null){f("#port-concurrent-task-container").show()}else{f("#port-concurrent-task-container").hide()}f("#port-id").text(m.id);f("#port-name").val(m.component.name);f("#port-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(k);f("#port-concurrent-tasks").val(m.component.concurrentlySchedulableTaskCount);f("#port-comments").val(m.component.comments);f("#port-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.PortDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PortDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.PortDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#port-details").modal({scrollableContentStyle:"scrollable",headerText:"Port Details",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#port-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-port-name");c.clearField("read-only-port-id");c.clearField("read-only-port-comments")}}})},showDetails:function(d){if(a.isInputPort(d)||a.isOutputPort(d)){var e=d.datum();c.populateField("read-only-port-name",e.component.name);c.populateField("read-only-port-id",e.id);c.populateField("read-only-port-comments",e.component.comments);b("#port-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.ProcessGroup","nf.Shell","nf.CanvasUtils"],function(h,j,i,f,g,k,c,d,e){return(nf.ProcessGroupConfiguration=b(h,j,i,f,g,k,c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ProcessGroup"),require("nf.Shell"),require("nf.CanvasUtils")))}else{nf.ProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ProcessGroup,a.nf.Shell,a.nf.CanvasUtils)}}}(this,function(d,q,e,g,i,r,f,o,l){var c;var p={urls:{api:"../nifi-api"}};var j=function(){};var b=function(){return d("#process-group-controller-services-table")};var a=function(s,u){var t={revision:r.getRevision({revision:{version:s}}),component:{id:u,name:d("#process-group-name").val(),comments:d("#process-group-comments").val()}};d.ajax({type:"PUT",data:JSON.stringify(t),url:p.urls.api+"/process-groups/"+encodeURIComponent(u),dataType:"json",contentType:"application/json"}).done(function(v){if(v.permissions.canRead&&v.component.parentGroupId===l.getGroupId()){f.set(v)}i.showOkDialog({headerText:"Process Group Configuration",dialogContent:"Process group configuration successfully saved."});d("#process-group-configuration-save").off("click").on("click",function(){a(v.revision.version,u)});l.reload()}).fail(e.handleAjaxError)};var k=function(u){var x=function(){d("#read-only-process-group-name").addClass("unset").text("Unauthorized");d("#read-only-process-group-comments").addClass("unset").text("Unauthorized")};var w=function(y){if(y){d("#process-group-configuration div.editable").show();d("#process-group-configuration div.read-only").hide();d("#process-group-configuration-save").show()}else{d("#process-group-configuration div.editable").hide();d("#process-group-configuration div.read-only").show();d("#process-group-configuration-save").hide()}};d("#process-group-id").text(u);d("#process-group-configuration-refresh-button").off("click").on("click",function(){k(u)});d("#add-process-group-configuration-controller-service").off("click").on("click",function(){var z=d("#process-group-configuration-tabs li.selected-tab").text();if(z==="Controller Services"){var y=p.urls.api+"/process-groups/"+encodeURIComponent(u)+"/controller-services";c.promptNewControllerService(y,b())}});var v=d.Deferred(function(y){d.ajax({type:"GET",url:p.urls.api+"/process-groups/"+encodeURIComponent(u),dataType:"json"}).done(function(z){d("#process-group-configuration").data("process-group",z);var A=z.component;if(z.permissions.canWrite){d("#process-group-name").removeClass("unset").val(A.name);d("#process-group-comments").removeClass("unset").val(A.comments);d("#process-group-configuration-header-text").text(A.name+" Configuration");w(true);d("#process-group-configuration-save").off("click").on("click",function(){a(z.revision.version,z.id)})}else{if(z.permissions.canRead){d("#read-only-process-group-name").removeClass("unset").text(A.name);d("#read-only-process-group-comments").removeClass("unset").text(A.comments);d("#process-group-configuration-header-text").text(A.name+" Configuration")}else{x()}w(false)}y.resolve()}).fail(function(B,z,A){if(B.status===403){if(u===l.getGroupId()){d("#process-group-configuration").data("process-group",{permissions:{canRead:false,canWrite:l.canWrite()}})}else{d("#process-group-configuration").data("process-group",f.get(u))}x();w(false);y.resolve()}else{y.reject(B,z,A)}})}).promise();var s=p.urls.api+"/flow/process-groups/"+encodeURIComponent(u)+"/controller-services";var t=c.loadControllerServices(s,b());return d.when(v,t).done(function(A,z){var y=z[0];d("#process-group-configuration-last-refreshed").text(y.currentTime)}).fail(e.handleAjaxError)};var m=function(){o.showContent("#process-group-configuration").done(function(){n()});d("#process-group-configuration-tabs").find(".selected-tab").click();h.resetTableSize()};var n=function(){d("#process-group-configuration").removeData("process-group");d("#process-group-configuration-save").mouseout();d("#process-group-id").text("");d("#process-group-name").val("");d("#process-group-comments").val("");d("#process-group-configuration-header-text").text("Process Group Configuration")};var h={init:function(s){c=s;d("#process-group-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-process-group-configuration-tab-content"},{name:"Controller Services",tabContentId:"process-group-controller-services-tab-content"}],select:function(){var u=d("#process-group-configuration").data("process-group");var v=g.isDefinedAndNotNull(u)?u.permissions.canWrite:false;var t=d(this).text();if(t==="General"){d("#flow-cs-availability").hide();d("#add-process-group-configuration-controller-service").hide();if(v){d("#process-group-configuration-save").show()}else{d("#process-group-configuration-save").hide()}}else{d("#flow-cs-availability").show();d("#process-group-configuration-save").hide();if(v){d("#add-process-group-configuration-controller-service").show();d("#process-group-controller-services-tab-content").css("top","32px")}else{d("#add-process-group-configuration-controller-service").hide();d("#process-group-controller-services-tab-content").css("top","0")}h.resetTableSize()}}});j();c.init(b())},resetTableSize:function(){c.resetTableSize(b())},showConfiguration:function(s){return k(s).done(m)},loadConfiguration:function(s){return k(s)},selectControllerService:function(s){var t=b().data("gridInstance");var u=t.getData();var v=u.getRowById(s);t.setSelectedRows([v]);t.scrollRowIntoView(v);d("#process-group-configuration-tabs").find("li:eq(1)").click()}};return h}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ProcessGroupConfiguration","nf.ng.Bridge"],function(g,j,i,h,e,f,d,c){return(nf.ComponentState=b(g,i,h,e,f,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ComponentState=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common",require("nf.Client"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration"),require("nf.ng.Bridge"))))}else{nf.ComponentVersion=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration,a.nf.ng.Bridge)}}}(this,function(h,j,e,m,f,c,i){var a;var d;var b=function(n){if(n.type==="ReportingTask"){return"../nifi-api/flow/reporting-task-types"}else{if(n.type==="ControllerService"){return"../nifi-api/flow/controller-service-types"}else{return"../nifi-api/flow/processor-types"}}};var g=function(n){if(n.type==="ReportingTask"){return"reportingTaskTypes"}else{if(n.type==="ControllerService"){return"controllerServiceTypes"}else{return"processorTypes"}}};var l=function(){var n=a.keys();h.each(n,function(p,o){a.remove(o)});h("#component-version-controller-service-apis").empty();h("#component-version-controller-service-apis-container").hide();h("#component-version-name").text("");h("#component-version-bundle").text("");h("#component-version-tags").text("");h("#component-version-restriction").removeClass("unset").text("");h("#component-version-description").text("");h("#component-version-selector").combo("destroy");h("#component-version-dialog").removeData("component")};var k=function(p){var q=a.get(p.value);if(e.isDefinedAndNotNull(q.usageRestriction)){h("#component-version-restriction").text(q.usageRestriction)}else{h("#component-version-restriction").addClass("unset").text("No restriction")}if(!e.isEmpty(q.controllerServiceApis)){var n=e.getFormattedServiceApis(q.controllerServiceApis);var o=e.formatUnorderedList(n);h("#component-version-controller-service-apis").empty().append(o);h("#component-version-controller-service-apis-container").show()}h("#component-version-tags").text(q.tags.join(", "));h("#component-version-description").text(q.description)};return{init:function(n){a=d3.map();d=n;h("#component-version-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Component Version",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var q=h("#component-version-selector").combo("getSelectedOption");var r=a.get(q.value);var p=h("#component-version-dialog").data("component");var o={revision:m.getRevision(p),component:{id:p.id,bundle:{group:r.bundle.group,artifact:r.bundle.artifact,version:r.bundle.version}}};h.ajax({type:"PUT",url:p.uri,data:JSON.stringify(o),dataType:"json",contentType:"application/json"}).done(function(t){if(p.type==="Processor"){f.getComponentByType(p.type).set(t);i.digest()}else{if(p.type==="ControllerService"){var s=p.component.parentGroupId;h.Deferred(function(u){if(e.isDefinedAndNotNull(s)){if(h("#process-group-configuration").is(":visible")){c.loadConfiguration(s).done(function(){u.resolve()})}else{c.showConfiguration(s).done(function(){u.resolve()})}}else{if(h("#settings").is(":visible")){d.loadSettings().done(function(){u.resolve()})}else{d.showSettings().done(function(){u.resolve()})}}}).done(function(){if(e.isDefinedAndNotNull(s)){c.selectControllerService(p.id)}else{d.selectControllerService(p.id)}})}else{if(p.type==="ReportingTask"){h.Deferred(function(u){if(h("#settings").is(":visible")){d.loadSettings().done(function(){u.resolve()})}else{d.showSettings().done(function(){u.resolve()})}}).done(function(){d.selectReportingTask(p.id)})}}}}).fail(j.handleAjaxError);this.modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){l()}}})},promptForVersionChange:function(n){var o={bundleGroupFilter:n.component.bundle.group,bundleArtifactFilter:n.component.bundle.artifact};if(g(n)==="controllerServiceTypes"){o.typeFilter=n.component.type}else{o.type=n.component.type}return h.ajax({type:"GET",url:b(n)+"?"+h.param(o),dataType:"json"}).done(function(p){var q=[];var r;h.each(p[g(n)],function(s,v){var u=v.type;a.set(v.bundle.version,v);var t={text:v.bundle.version,value:v.bundle.version,description:e.escapeHtml(v.description)};if(v.bundle.version===n.component.bundle.version){r=t}q.push(t)});q.sort(function(t,s){return -e.sortVersion(t.text,s.text)});h("#component-version-name").text(n.component.name);h("#component-version-bundle").text(e.formatBundle(n.component.bundle));h("#component-version-selector").combo({options:q,selectedOption:r,select:k});h("#component-version-dialog").data("component",n).modal("show")}).fail(j.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,j,i,d,f,k,e,h,c){return(nf.RemoteProcessGroupConfiguration=b(g,j,i,d,f,k,e,h,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(e,h,g,b,d,i,c,f,a){return{init:function(){e("#remote-process-group-configuration").modal({headerText:"Configure Remote Process Group",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var j=e("#remote-process-group-id").text();var k=h.select("#id-"+j).datum();var l={revision:i.getRevision(k),component:{id:j,communicationsTimeout:e("#remote-process-group-timeout").val(),yieldDuration:e("#remote-process-group-yield-duration").val(),transportProtocol:e("#remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,proxyHost:e("#remote-process-group-proxy-host").val(),proxyPort:e("#remote-process-group-proxy-port").val(),proxyUser:e("#remote-process-group-proxy-user").val(),proxyPassword:e("#remote-process-group-proxy-password").val(),localNetworkInterface:e("#remote-process-group-local-network-interface").val()}};e.ajax({type:"PUT",data:JSON.stringify(l),url:k.uri,dataType:"json",contentType:"application/json"}).done(function(m){a.set(m);f.digest();e("#remote-process-group-configuration").modal("hide")}).fail(function(p,m,n){if(p.status===400){var q=p.responseText.split("\n");var o;if(q.length===1){o=e("<span></span>").text(q[0])}else{o=b.formatUnorderedList(q)}d.showOkDialog({dialogContent:o,headerText:"Remote Process Group Configuration"})}else{g.handleAjaxError(p,m,n)}})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){e("#remote-process-group-configuration").modal("hide")}}}],handler:{close:function(){e("#remote-process-group-id").text("");e("#remote-process-group-name").text("");e("#remote-process-group-urls").text("");e("#remote-process-group-timeout").val("");e("#remote-process-group-yield-duration").val("");e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});e("#remote-process-group-local-network-interface").val("");e("#remote-process-group-proxy-host").val("");e("#remote-process-group-proxy-port").val("");e("#remote-process-group-proxy-user").val("");e("#remote-process-group-proxy-password").val("")}}});e("#remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},showConfiguration:function(j){if(c.isRemoteProcessGroup(j)){var k=j.datum();e("#remote-process-group-id").text(k.id);e("#remote-process-group-name").text(k.component.name);e("#remote-process-group-urls").text(k.component.targetUris);e("#remote-process-group-timeout").val(k.component.communicationsTimeout);e("#remote-process-group-yield-duration").val(k.component.yieldDuration);e("#remote-process-group-proxy-host").val(k.component.proxyHost);e("#remote-process-group-proxy-port").val(k.component.proxyPort);e("#remote-process-group-proxy-user").val(k.component.proxyUser);e("#remote-process-group-proxy-password").val(k.component.proxyPassword);e("#remote-process-group-local-network-interface").val(k.component.localNetworkInterface);e("#remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:k.component.transportProtocol});e("#remote-process-group-configuration").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.CanvasUtils"],function(d,e,c){return(nf.RemoteProcessGroupDetails=b(d,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupDetails=b(require("jquery"),require("nf.Common"),require("nf.CanvasUtils")))}else{nf.RemoteProcessGroupDetails=b(a.$,a.nf.Common,a.nf.CanvasUtils)}}}(this,function(b,c,a){return{init:function(){b("#remote-process-group-details").modal({headerText:"Remote Process Group Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){b("#remote-process-group-details").modal("hide")}}}],handler:{close:function(){c.clearField("read-only-remote-process-group-id");c.clearField("read-only-remote-process-group-name");c.clearField("read-only-remote-process-group-urls");c.clearField("read-only-remote-process-group-timeout");c.clearField("read-only-remote-process-group-yield-duration");c.clearField("read-only-remote-process-group-transport-protocol");c.clearField("read-only-remote-process-group-local-network-interface");c.clearField("read-only-remote-process-group-proxy-host");c.clearField("read-only-remote-process-group-proxy-port");c.clearField("read-only-remote-process-group-proxy-user");c.clearField("read-only-remote-process-group-proxy-password")}}})},showDetails:function(d){if(a.isRemoteProcessGroup(d)){var e=d.datum();c.populateField("read-only-remote-process-group-id",e.id);c.populateField("read-only-remote-process-group-name",e.component.name);c.populateField("read-only-remote-process-group-urls",e.component.targetUris);c.populateField("read-only-remote-process-group-timeout",e.component.communicationsTimeout);c.populateField("read-only-remote-process-group-yield-duration",e.component.yieldDuration);c.populateField("read-only-remote-process-group-transport-protocol",e.component.transportProtocol);c.populateField("read-only-remote-process-group-local-network-interface",e.component.localNetworkInterface);c.populateField("read-only-remote-process-group-proxy-host",e.component.proxyHost);c.populateField("read-only-remote-process-group-proxy-port",e.component.proxyPort);c.populateField("read-only-remote-process-group-proxy-user",e.component.proxyUser);c.populateField("read-only-remote-process-group-proxy-password",e.component.proxyPassword);b("#remote-process-group-details").modal("show")}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.RemoteProcessGroup"],function(g,j,i,d,f,k,e,h,c){return(nf.RemoteProcessGroupPorts=b(g,j,i,d,f,k,e,h,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.RemoteProcessGroupPorts=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.RemoteProcessGroup")))}else{nf.RemoteProcessGroupPorts=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.RemoteProcessGroup)}}}(this,function(g,m,k,c,e,n,d,i,b){var h=function(){g("#remote-port-configuration").modal({headerText:"Configure Remote Port",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var q=g("#remote-port-concurrent-tasks").val();var p=g("#remote-port-batch-count").val();var v=new Array();if(!g.isNumeric(q)){v.push("Concurrent tasks must be an integer value.")}if(p&&!g.isNumeric(p)){v.push("Batch Settings: count must be an integer value.")}if(v.length==0){var o=g("#remote-process-group-ports-id").text();var u=m.select("#id-"+o).datum();var t=g("#remote-port-id").text();var s={revision:n.getRevision(u),remoteProcessGroupPort:{id:t,groupId:o,useCompression:g("#remote-port-use-compression").hasClass("checkbox-checked"),concurrentlySchedulableTaskCount:q,batchSettings:{count:p,size:g("#remote-port-batch-size").val(),duration:g("#remote-port-batch-duration").val()}}};var r="/output-ports/";if(g("#remote-port-type").text()==="input"){r="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(s),url:u.uri+r+encodeURIComponent(t),dataType:"json",contentType:"application/json"}).done(function(w){u.revision=w.revision;var x=w.remoteProcessGroupPort;var z="No";if(x.useCompression===true){z="Yes"}g("#"+t+"-concurrent-tasks").text(x.concurrentlySchedulableTaskCount);g("#"+t+"-compression").text(z);var y=a(x);g("#"+t+"-batch-count").text(y.count);g("#"+t+"-batch-size").text(y.size);g("#"+t+"-batch-duration").text(y.duration)}).fail(function(z,w,x){if(z.status===400){var A=z.responseText.split("\n");var y;if(A.length===1){y=g("<span></span>").text(A[0])}else{y=c.formatUnorderedList(A)}e.showOkDialog({dialogContent:y,headerText:"Remote Process Group Ports"})}else{k.handleAjaxError(z,w,x)}}).always(function(){g("#remote-port-configuration").modal("hide")})}else{e.showOkDialog({headerText:"Remote Process Group Ports",dialogContent:v.reduce(function(w,x){return typeof(w)==="string"?w+" "+x:x})});g("#remote-port-configuration").modal("hide")}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#remote-port-configuration").modal("hide")}}}],handler:{close:function(){g("#remote-port-id").text("");g("#remote-port-name").text("");g("#remote-port-concurrent-tasks").val("");g("#remote-port-use-compression").removeClass("checkbox-checked checkbox-unchecked");g("#remote-port-batch-count").val("");g("#remote-port-batch-size").val("");g("#remote-port-batch-duration").val("")}}})};var j=function(){g("#remote-process-group-ports").modal({scrollableContentStyle:"scrollable",headerText:"Remote Process Group Ports",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var o=g("#remote-process-group-ports-id").text();var q=m.select("#id-"+o);var p=q.datum();if(d.canModify(q)){b.reload(p.id)}g("#remote-process-group-ports").modal("hide")}}}],handler:{close:function(){g("#remote-process-group-ports-id").text("");g("#remote-process-group-ports-name").text("");g("#remote-process-group-ports-urls").text("");var o=g("#remote-process-group-ports");c.cleanUpTooltips(o,"div.remote-port-removed");c.cleanUpTooltips(o,"div.concurrent-tasks-info");g("#remote-process-group-input-ports-container").empty();g("#remote-process-group-output-ports-container").empty()}}})};var a=function(p){var o={};var q=p.batchSettings;if(q){o.count=typeof(q.count)==="number"?q.count:"No value set";o.size=q.size?q.size:"No value set";o.duration=q.duration?q.duration:"No value set"}else{o.count="No value set";o.size="No value set";o.duration="No value set"}return o};var f=function(C,A,v){var s=c.escapeHtml(A.id);var w=g('<div class="remote-port-container"></div>').appendTo(C);var H=g('<div class="remote-port-edit-container"></div>').appendTo(w);var t=g('<div class="remote-port-details-container"></div>').appendTo(w);var y=g("#remote-process-group-ports-id").text();var u=m.select("#id-"+y);if(d.canModify(u)){var I=function(K){var L;if(K.connected===true){if(K.transmitting===true){L=(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope));L.click()}else{if(K.exists===true){L=(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary enabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}else{L=(i.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}}}else{if(K.transmitting===true){L=(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary disabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}else{L=(i.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope))}}return L};var B=I(A);B.appendTo(H);if(A.exists===true&&A.connected===true){var G=g('<button class="button edit-remote-port fa fa-pencil"></button>').click(function(){var O=g("#"+s+"-name").text();var N=g("#"+s+"-concurrent-tasks").text();var K=g("#"+s+"-compression").text()==="Yes";var M=g("#"+s+"-batch-count").text();var L=g("#"+s+"-batch-size").text();var P=g("#"+s+"-batch-duration").text();l(A.id,O,N,K,M,L,P,v)}).appendTo(H);if(A.transmitting===true){G.hide()}else{G.show()}}else{if(A.exists===false){g('<div class="remote-port-removed"/>').appendTo(H).qtip(g.extend({},c.config.tooltipConfig,{content:"This port has been removed."}))}}if(c.isDefinedAndNotNull(B)){var J=function(){var K=g("#remote-process-group-ports-id").text();var N=m.select("#id-"+K).datum();var O=false;if(B.hasClass("enabled-inactive-transmission")){O=true}var M={revision:n.getRevision(N),remoteProcessGroupPort:{id:A.id,groupId:K,transmitting:O}};var L="/output-ports/";if(v==="input"){L="/input-ports/"}g.ajax({type:"PUT",data:JSON.stringify(M),url:N.uri+L+encodeURIComponent(A.id),dataType:"json",contentType:"application/json"}).done(function(P){N.revision=P.revision;var Q=P.remoteProcessGroupPort;if(Q.exists===false){B.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("disabled-inactive-transmission").off("click");if(c.isDefinedAndNotNull(G)){G.hide()}}else{if(Q.transmitting===true){B.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-active-transmission");if(c.isDefinedAndNotNull(G)){G.hide()}}else{B.removeClass("enabled-active-transmission enabled-inactive-transmission").addClass("enabled-inactive-transmission");if(c.isDefinedAndNotNull(G)){G.show()}}}}).fail(function(T,P,Q){var S=I(A);S.click(J);B.replaceWith(S);B=S;if(T.status===400){var U=T.responseText.split("\n");var R;if(U.length===1){R=g("<span></span>").text(U[0])}else{R=c.formatUnorderedList(U)}e.showOkDialog({headerText:"Remote Process Group Ports",dialogContent:R})}else{k.handleAjaxError(T,P,Q)}})};B.click(J)}}else{if(A.transmitting===true){(i.injector.get("$compile")(g('<md-switch style="margin:0px" class="md-primary disabled-active-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope)).appendTo(H)}else{(i.injector.get("$compile")(g('<md-switch ng-disabled="true" style="margin:0px" class="md-primary disabled-inactive-transmission" aria-label="Toggle port transmission"></md-switch>'))(i.rootScope)).appendTo(H)}}g('<div id="'+s+'-id" class="remote-port-id hidden"></div>').text(A.id).appendTo(t);g('<div id="'+s+'-name" class="remote-port-name ellipsis"></div>').text(A.name).appendTo(t);g('<div class="clear"></div>').appendTo(t);if(c.isBlank(A.comments)){g('<div class="remote-port-description unset">No description specified.</div>').appendTo(t)}else{g('<div class="remote-port-description"></div>').text(A.comments).appendTo(t)}g('<div class="clear"></div>').appendTo(t);var D=g('<div class="concurrent-task-container"></div>').appendTo(t);var x=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-concurrent-tasks"></div>').text(A.concurrentlySchedulableTaskCount));g('<div><div class="setting-name">Concurrent tasks<div class="processor-setting concurrent-tasks-info fa fa-question-circle"></div></div></div>').append(x).appendTo(D).find("div.concurrent-tasks-info").qtip(g.extend({},c.config.tooltipConfig,{content:"The number of tasks that should be concurrently scheduled for this port."}));var p=g('<div class="compression-container"></div>').appendTo(t);var o="No";if(A.useCompression===true){o="Yes"}g('<div><div class="setting-name">Compressed</div><div class="setting-field"><div id="'+s+'-compression">'+o+"</div></div></div>").appendTo(p);g('<div class="clear"></div>').appendTo(t);var r=g('<div class="batch-settings-container"></div>').append(g('<div class="setting-name">Batch Settings<div class="processor-setting batch-settings-info fa fa-question-circle"></div></div>')).appendTo(t);r.find("div.batch-settings-info").qtip(g.extend({},nf.Common.config.tooltipConfig,{content:(v==="input"?"The batch settings to control how this NiFi sends data to the remote input port in a transaction. This NiFi will transfer as much flow files as they are queued in incoming relationships, until any of these limits is met. If none of these setting is specified, this NiFi uses 500 milliseconds batch duration by default.":"The batch settings to tell the remote NiFi how this NiFi prefers to receive data from the remote output port in a transaction. The remote NiFi will use these settings as a hint to control batch data transferring. However, actual behavior depends on the version of remote NiFi instance. Recent version of NiFi uses 5 seconds for batch duration if none of these setting is specified.")}));var F=a(A);var q=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-batch-count"></div>').text(F.count));var E=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-batch-size"></div>').text(F.size));var z=g('<div class="setting-field"></div>').append(g('<div id="'+s+'-batch-duration"></div>').text(F.duration));g('<div class="batch-setting"><div class="setting-name">Count<div class="processor-setting"></div></div></div>').append(q).appendTo(r);g('<div class="batch-setting"><div class="setting-name">Size<div class="processor-setting"></div></div></div>').append(E).appendTo(r);g('<div class="batch-setting"><div class="setting-name">Duration<div class="processor-setting"></div></div></div>').append(z).appendTo(r);g('<div class="clear"></div>').appendTo(w);w.find(".ellipsis").ellipsis();i.digest()};var l=function(r,s,u,v,p,t,q,o){g("#remote-port-id").text(r);g("#remote-port-type").text(o);var w="checkbox-unchecked";if(v===true){w="checkbox-checked"}g("#remote-port-use-compression").addClass(w);g("#remote-port-concurrent-tasks").val(u);g("#remote-port-batch-count").val(p==="No value set"?null:p);g("#remote-port-batch-size").val(t==="No value set"?null:t);g("#remote-port-batch-duration").val(q==="No value set"?null:q);g("#remote-port-name").text(s).ellipsis();g("#remote-port-configuration").modal("show")};return{init:function(){h();j()},showPorts:function(o){if(d.isRemoteProcessGroup(o)){var p=o.datum();g.ajax({type:"GET",url:p.uri,dataType:"json"}).done(function(s){var v=s.component;b.set(s);g("#remote-process-group-ports-id").text(v.id);g("#remote-process-group-ports-name").text(v.name);g("#remote-process-group-ports-urls").text(v.targetUris);var q=v.contents;if(c.isDefinedAndNotNull(q)){var z=[];var t=[];var r=function(B,A){var D=B.name.toUpperCase();var C=A.name.toUpperCase();return D<C?-1:(D>C?1:0)};var x=g("#remote-process-group-input-ports-container");g.each(q.inputPorts,function(B,A){if(A.connected===true){z.push(A)}else{t.push(A)}});z.sort(r);t.sort(r);g.each(z,function(B,A){f(x,A,"input")});g.each(t,function(B,A){f(x,A,"input")});if(c.isEmpty(z)&&c.isEmpty(t)){g('<div class="unset"></div>').text("No ports to display").appendTo(x)}var u=[];var y=[];var w=g("#remote-process-group-output-ports-container");g.each(q.outputPorts,function(A,B){if(B.connected===true){u.push(B)}else{y.push(B)}});u.sort(r);y.sort(r);g.each(u,function(A,B){f(w,B,"output")});g.each(y,function(A,B){f(w,B,"output")});if(c.isEmpty(u)&&c.isEmpty(y)){g('<div class="unset"></div>').text("No ports to display").appendTo(w)}}g("#remote-process-group-ports").modal("show")}).fail(k.handleAjaxError)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.CanvasUtils","nf.Connection"],function(g,e,j,h,f,c,d,i){return(nf.ConnectionConfiguration=b(g,e,j,h,f,c,d,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionConfiguration=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.Connection")))}else{nf.ConnectionConfiguration=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.CanvasUtils,a.nf.Connection)}}}(this,function(r,B,c,A,h,f,F,J){var d;var o;var l=75;var E=200;var w={urls:{api:"../nifi-api",prioritizers:"../nifi-api/flow/prioritizers"}};var g=function(){B.select("path.connector").remove()};var b=function(K){if(F.isProcessor(K)){return r.Deferred(function(L){z(K).done(function(N){if(!A.isEmpty(N.relationships)){r.each(N.relationships,function(O,P){s(P.name)});var M=r("#relationship-names").children("div");if(M.length===1){M.children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}r("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var O=q();if(O.length>0){x(O)}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"The connection must have at least one relationship selected."})}r("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){r("#connection-configuration").modal("hide")}}}]);L.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+A.escapeHtml(N.name)+"' does not support any relationships."});k();L.reject()}}).fail(function(){L.reject()})}).promise()}else{return r.Deferred(function(M){var L;if(F.isInputPort(K)){L=y(K)}else{if(F.isRemoteProcessGroup(K)){L=e(K)}else{if(F.isProcessGroup(K)){L=C(K)}else{L=j(K)}}}L.done(function(){r("#connection-configuration").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){x();r("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){r("#connection-configuration").modal("hide")}}}]);M.resolve()}).fail(function(){M.reject()})}).promise()}};var y=function(K){return r.Deferred(function(M){var L=K.datum();var N=L.permissions.canRead?L.component.name:L.id;r("#input-port-source").show();r("#input-port-source-name").text(N).attr("title",N);r("#connection-source-id").val(L.id);r("#connection-source-component-id").val(L.id);r("#connection-source-group-id").val(F.getGroupId());r("#connection-source-group-name").text(F.getGroupName());M.resolve()}).promise()};var j=function(K){return r.Deferred(function(M){var L=K.datum();r("#funnel-source").show();r("#connection-source-id").val(L.id);r("#connection-source-component-id").val(L.id);r("#connection-source-group-id").val(F.getGroupId());r("#connection-source-group-name").text(F.getGroupName());M.resolve()}).promise()};var z=function(K){return r.Deferred(function(M){var L=K.datum();var N=L.permissions.canRead?L.component.name:L.id;var O=L.permissions.canRead?A.substringAfterLast(L.component.type,"."):"Processor";r("#processor-source").show();r("#processor-source-name").text(N).attr("title",N);r("#processor-source-type").text(O).attr("title",O);r("#connection-source-id").val(L.id);r("#connection-source-component-id").val(L.id);r("#connection-source-group-id").val(F.getGroupId());r("#connection-source-group-name").text(F.getGroupName());r("#relationship-names-container").show();M.resolve(L.component)})};var C=function(K){return r.Deferred(function(L){var M=K.datum();r.ajax({type:"GET",url:w.urls.api+"/flow/process-groups/"+encodeURIComponent(M.id),dataType:"json"}).done(function(N){var R=N.processGroupFlow;var Q=N.permissions.canRead?R.breadcrumb.breadcrumb.name:R.id;var S=R.flow;var O=[];r.each(S.outputPorts,function(U,V){if(V.permissions.canRead&&V.permissions.canWrite){var T=V.component;O.push({text:T.name,value:T.id,description:A.escapeHtml(T.comments)})}});if(!A.isEmpty(O)){r("#output-port-source").show();O.sort(function(U,T){return U.text.localeCompare(T.text)});r("#output-port-options").combo({options:O,maxHeight:300,select:function(T){r("#connection-source-id").val(T.value)}});r("#connection-source-component-id").val(R.id);r("#connection-source-group-id").val(R.id);r("#connection-source-group-name").text(Q);L.resolve()}else{var P="'"+A.escapeHtml(Q)+"' does not have any output ports.";if(A.isEmpty(S.outputPorts)===false){P="Not authorized for any output ports in '"+A.escapeHtml(Q)+"'."}h.showOkDialog({headerText:"Connection Configuration",dialogContent:P});k();L.reject()}}).fail(function(P,N,O){c.handleAjaxError(P,N,O);L.reject()})}).promise()};var e=function(K){return r.Deferred(function(L){var M=K.datum();r.ajax({type:"GET",url:M.uri,dataType:"json"}).done(function(N){var P=N.component;var Q=P.contents;if(!A.isEmpty(Q.outputPorts)){r("#output-port-source").show();var O=[];r.each(Q.outputPorts,function(R,S){O.push({text:S.name,value:S.id,disabled:S.exists===false,description:A.escapeHtml(S.comments)})});O.sort(function(S,R){return S.text.localeCompare(R.text)});r("#output-port-options").combo({options:O,maxHeight:300,select:function(R){r("#connection-source-id").val(R.value)}});r("#connection-source-component-id").val(P.id);r("#connection-source-group-id").val(P.id);r("#connection-source-group-name").text(P.name);L.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+A.escapeHtml(P.name)+"' does not have any output ports."});k();L.reject()}}).fail(function(P,N,O){c.handleAjaxError(P,N,O);L.reject()})}).promise()};var a=function(K){if(F.isOutputPort(K)){return m(K)}else{if(F.isProcessor(K)){return v(K)}else{if(F.isRemoteProcessGroup(K)){return G(K)}else{if(F.isFunnel(K)){return p(K)}else{return I(K)}}}}};var m=function(K){return r.Deferred(function(L){var N=K.datum();var M=N.permissions.canRead?N.component.name:N.id;r("#output-port-destination").show();r("#output-port-destination-name").text(M).attr("title",M);r("#connection-destination-id").val(N.id);r("#connection-destination-component-id").val(N.id);r("#connection-destination-group-id").val(F.getGroupId());r("#connection-destination-group-name").text(F.getGroupName());L.resolve()}).promise()};var p=function(K){return r.Deferred(function(M){var L=K.datum();r("#funnel-destination").show();r("#connection-destination-id").val(L.id);r("#connection-destination-component-id").val(L.id);r("#connection-destination-group-id").val(F.getGroupId());r("#connection-destination-group-name").text(F.getGroupName());M.resolve()}).promise()};var v=function(K){return r.Deferred(function(M){var L=K.datum();var N=L.permissions.canRead?L.component.name:L.id;var O=L.permissions.canRead?A.substringAfterLast(L.component.type,"."):"Processor";r("#processor-destination").show();r("#processor-destination-name").text(N).attr("title",N);r("#processor-destination-type").text(O).attr("title",O);r("#connection-destination-id").val(L.id);r("#connection-destination-component-id").val(L.id);r("#connection-destination-group-id").val(F.getGroupId());r("#connection-destination-group-name").text(F.getGroupName());M.resolve()}).promise()};var I=function(K){return r.Deferred(function(L){var M=K.datum();r.ajax({type:"GET",url:w.urls.api+"/flow/process-groups/"+encodeURIComponent(M.id),dataType:"json"}).done(function(N){var Q=N.processGroupFlow;var P=N.permissions.canRead?Q.breadcrumb.breadcrumb.name:Q.id;var R=Q.flow;var O=[];r.each(R.inputPorts,function(T,S){O.push({text:S.permissions.canRead?S.component.name:S.id,value:S.id,description:S.permissions.canRead?A.escapeHtml(S.component.comments):null})});if(!A.isEmpty(O)){r("#input-port-destination").show();O.sort(function(T,S){return T.text.localeCompare(S.text)});r("#input-port-options").combo({options:O,maxHeight:300,select:function(S){r("#connection-destination-id").val(S.value)}});r("#connection-destination-component-id").val(Q.id);r("#connection-destination-group-id").val(Q.id);r("#connection-destination-group-name").text(P);L.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+A.escapeHtml(P)+"' does not have any input ports."});k();L.reject()}}).fail(function(P,N,O){c.handleAjaxError(P,N,O);L.reject()})}).promise()};var G=function(K,L){return r.Deferred(function(M){var N=K.datum();r.ajax({type:"GET",url:N.uri,dataType:"json"}).done(function(O){var Q=O.component;var R=Q.contents;if(!A.isEmpty(R.inputPorts)){r("#input-port-destination").show();var P=[];r.each(R.inputPorts,function(T,S){P.push({text:S.name,value:S.id,disabled:S.exists===false,description:A.escapeHtml(S.comments)})});P.sort(function(T,S){return T.text.localeCompare(S.text)});r("#input-port-options").combo({options:P,maxHeight:300,select:function(S){r("#connection-destination-id").val(S.value)}});r("#connection-destination-component-id").val(Q.id);r("#connection-destination-group-id").val(Q.id);r("#connection-destination-group-name").text(Q.name);M.resolve()}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"'"+A.escapeHtml(Q.name)+"' does not have any input ports."});k();M.reject()}}).fail(function(Q,O,P){c.handleAjaxError(Q,O,P);M.reject()})}).promise()};var H=function(K){return r.Deferred(function(M){var N=K.datum();var L=N.permissions.canRead?N.component.name:N.id;r("#read-only-output-port-source").show();r("#connection-source-component-id").val(N.id);r("#connection-source-group-id").val(N.id);r("#connection-source-group-name").text(L);M.resolve()}).promise()};var i=function(K){if(F.isProcessor(K)){return z(K)}else{if(F.isInputPort(K)){return y(K)}else{if(F.isFunnel(K)){return j(K)}else{return H(K)}}}};var t=function(K,L){if(F.isProcessor(K)){return v(K)}else{if(F.isOutputPort(K)){return m(K)}else{if(F.isRemoteProcessGroup(K)){return G(K,L)}else{if(F.isFunnel(K)){return p(K)}else{return I(K)}}}}};var s=function(L){var K=r('<div class="relationship-name nf-checkbox-label ellipsis"></div>').text(L);var M=r('<span class="relationship-name-value hidden"></span>').text(L);return r('<div class="available-relationship-container"><div class="available-relationship nf-checkbox checkbox-unchecked"></div></div>').append(K).append(M).appendTo("#relationship-names")};var x=function(M){var ag=r("#connection-source-id").val();var ad=r("#connection-destination-id").val();var ak=r("#connection-source-component-id").val();var aa=B.select("#id-"+ak);var ae=r("#connection-destination-component-id").val();var T=B.select("#id-"+ae);var ar=aa.datum();var U=T.datum();var N=[];if(ak===ae){var Z={x:ar.position.x+(ar.dimensions.width),y:ar.position.y+(ar.dimensions.height/2)};var af=J.config.selfLoopXOffset;var ah=J.config.selfLoopYOffset;N.push({x:(Z.x+af),y:(Z.y-ah)});N.push({x:(Z.x+af),y:(Z.y+ah)})}else{var ap=[];var aj=J.getComponentConnections(ak);r.each(aj,function(av,ay){var aw=F.getConnectionSourceComponentId(ay);var ax=F.getConnectionDestinationComponentId(ay);if((aw===ak&&ax===ae)||(ax===ak&&aw===ae)){ap.push(ay)}});if(ap.length>0){var O=false;r.each(ap,function(av,aw){if(A.isEmpty(aw.bends)){O=true;return false}});if(O===true){var ab=[ar.position.x+(ar.dimensions.width/2),ar.position.y+(ar.dimensions.height/2)];var L=[U.position.x+(U.dimensions.width/2),U.position.y+(U.dimensions.height/2)];var Y=((ab[1]-L[1])/(ab[0]-L[0]));var an=Y<=1&&Y>=-1;var ai=function(av,ax){var aw=false;r.each(ap,function(ay,az){if(!A.isEmpty(az.bends)){if(an){if(az.bends[0].y===ax){aw=true;return false}}else{if(az.bends[0].x===av){aw=true;return false}}}});return aw};var R=(ab[0]+L[0])/2;var V=(ab[1]+L[1])/2;var am=an?0:E;var X=an?l:0;var ao=false;while(ao===false){if(ai(R-am,V-X)===false){N.push({x:(R-am),y:(V-X)});ao=true}else{if(ai(R+am,V+X)===false){N.push({x:(R+am),y:(V+X)});ao=true}}if(an){X+=l}else{am+=E}}}}}var Q=r("#connection-source-group-id").val();var K=r("#connection-destination-group-id").val();var at=F.getConnectableTypeForSource(aa);var W=F.getConnectableTypeForDestination(T);var S=r("#connection-name").val();var P=r("#flow-file-expiration").val();var aq=r("#back-pressure-object-threshold").val();var au=r("#back-pressure-data-size-threshold").val();var ac=r("#prioritizer-selected").sortable("toArray");if(D()){var al={revision:f.getRevision({revision:{version:0}}),component:{name:S,source:{id:ag,groupId:Q,type:at},destination:{id:ad,groupId:K,type:W},selectedRelationships:M,flowFileExpiration:P,backPressureDataSizeThreshold:au,backPressureObjectThreshold:aq,bends:N,prioritizers:ac}};r.ajax({type:"POST",url:w.urls.api+"/process-groups/"+encodeURIComponent(F.getGroupId())+"/connections",data:JSON.stringify(al),dataType:"json",contentType:"application/json"}).done(function(av){o.add({connections:[av]},{selectAll:true});F.reloadConnectionSourceAndDestination(ak,ae);o.updateVisibility();d.refresh()}).fail(function(ax,av,aw){c.handleAjaxError(ax,av,aw)})}};var u=function(Q){var R=r("#connection-id").text();var M=r("#connection-uri").val();var Z=r("#connection-source-component-id").val();var U=r("#connection-destination-component-id").val();var W=B.select("#id-"+U);var S=F.getConnectableTypeForDestination(W);var K=r("#connection-destination-id").val();var T=r("#connection-destination-group-id").val();var P=r("#connection-name").val();var N=r("#flow-file-expiration").val();var Y=r("#back-pressure-object-threshold").val();var O=r("#back-pressure-data-size-threshold").val();var X=r("#prioritizer-selected").sortable("toArray");if(D()){var V=J.get(R);var L={revision:f.getRevision(V),component:{id:R,name:P,destination:{id:K,groupId:T,type:S},selectedRelationships:Q,flowFileExpiration:N,backPressureDataSizeThreshold:O,backPressureObjectThreshold:Y,prioritizers:X}};return r.ajax({type:"PUT",url:M,data:JSON.stringify(L),dataType:"json",contentType:"application/json"}).done(function(aa){J.set(aa);F.reloadConnectionSourceAndDestination(Z,U)}).fail(function(ac,aa,ab){if(ac.status===400||ac.status===404||ac.status===409){h.showOkDialog({headerText:"Connection Configuration",dialogContent:A.escapeHtml(ac.responseText),})}else{c.handleAjaxError(ac,aa,ab)}})}else{return r.Deferred(function(aa){aa.reject()}).promise()}};var q=function(){var L=r("#relationship-names");var K=[];r.each(L.children(),function(M,P){var O=r(P);var N=O.children("div.available-relationship");if(N.hasClass("checkbox-checked")){K.push(O.children("span.relationship-name-value").text())}});return K};var D=function(){var K=[];if(A.isBlank(r("#flow-file-expiration").val())){K.push("File expiration must be specified")}if(!r.isNumeric(r("#back-pressure-object-threshold").val())){K.push("Back pressure object threshold must be an integer value")}if(A.isBlank(r("#back-pressure-data-size-threshold").val())){K.push("Back pressure data size threshold must be specified")}if(K.length>0){h.showOkDialog({headerText:"Connection Configuration",dialogContent:A.formatUnorderedList(K)});return false}else{return true}};var k=function(){var M=r("#prioritizer-selected");var K=r("#prioritizer-available");M.children().detach().appendTo(K);var L=K.children("li").get();L.sort(function(O,N){var Q=r(O).text().toUpperCase();var P=r(N).text().toUpperCase();return(Q<P)?-1:(Q>P)?1:0});r.each(L,function(){r(this).detach()});r.each(L,function(){r(this).appendTo(K)});r("#connection-name").val("");r("#relationship-names").css("border-width","0").empty();r("#relationship-names-container").hide();A.clearField("connection-id");r("#processor-source").hide();r("#input-port-source").hide();r("#output-port-source").hide();r("#read-only-output-port-source").hide();r("#funnel-source").hide();r("#processor-destination").hide();r("#input-port-destination").hide();r("#output-port-destination").hide();r("#funnel-destination").hide();r("#connection-source-id").val("");r("#connection-source-component-id").val("");r("#connection-source-group-id").val("");r("#connection-destination-id").val("");r("#connection-destination-component-id").val("");r("#connection-destination-group-id").val("");r("#output-port-options").empty();r("#input-port-options").empty();g()};var n={init:function(L,K){d=L;o=K;r("#relationship-names-container").hide();r("#connection-configuration").modal({scrollableContentStyle:"scrollable",headerText:"Configure Connection",handler:{close:function(){k()},open:function(){A.toggleScrollable(r("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});r("#connection-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"connection-details-tab-content"},{name:"Settings",tabContentId:"connection-settings-tab-content"}]});r.ajax({type:"GET",url:w.urls.prioritizers,dataType:"json"}).done(function(M){r.each(M.prioritizerTypes,function(N,O){n.addAvailablePrioritizer("#prioritizer-available",O)});r("#prioritizer-available, #prioritizer-selected").sortable({connectWith:"ul",placeholder:"ui-state-highlight",scroll:true,opacity:0.6});r("#prioritizer-available, #prioritizer-selected").disableSelection()}).fail(c.handleAjaxError)},addAvailablePrioritizer:function(P,N){var M=N.type;var L=A.substringAfterLast(M,".");var O=r(P);var K=r("<li></li>").append(r('<span style="float: left;"></span>').text(L)).attr("id",M).addClass("ui-state-default").appendTo(O);if(A.isDefinedAndNotNull(N.description)){r('<div class="fa fa-question-circle" style="float: right; margin-right: 5px;""></div>').appendTo(K).qtip(r.extend({content:A.escapeHtml(N.description)},A.config.tooltipConfig))}},createConnection:function(M,N){var L=B.select("#id-"+M);var K=B.select("#id-"+N);if(L.empty()||K.empty()){return}r.when(b(L),a(K)).done(function(){r("#flow-file-expiration").val("0 sec");r("#back-pressure-object-threshold").val("10000");r("#back-pressure-data-size-threshold").val("1 GB");r("#connection-configuration-tabs").find("li:first").click();r("#connection-configuration").modal("setHeaderText","Create Connection").modal("show");r("#connection-configuration div.relationship-name").ellipsis();A.populateField("connection-id",null);var O=r("#relationship-names");if(O.is(":visible")&&O.get(0).scrollHeight>Math.round(O.innerHeight())){O.css("border-width","1px")}}).fail(function(){g()})},showConfiguration:function(L,K){return r.Deferred(function(N){var O=L.datum();var M=O.component;var R=F.getConnectionSourceComponentId(O);var P=B.select("#id-"+R);if(A.isUndefinedOrNull(K)){var Q=F.getConnectionDestinationComponentId(O);K=B.select("#id-"+Q)}r.when(i(P),t(K,M.destination)).done(function(){var U=M.availableRelationships;var T=M.selectedRelationships;if(A.isDefinedAndNotNull(U)||A.isDefinedAndNotNull(T)){r.each(U,function(X,W){s(W)});r.each(T,function(Y,W){if(r.inArray(W,U)===-1){var Z=s(W);r(Z).children("div.relationship-name").addClass("undefined")}var X=r("#relationship-names").children("div");r.each(X,function(aa,ac){var ab=r(ac).children("span.relationship-name-value");if(ab.text()===W){r(ac).children("div.available-relationship").removeClass("checkbox-unchecked").addClass("checkbox-checked")}})})}if(F.isProcessGroup(P)||F.isRemoteProcessGroup(P)){r("#connection-source-id").val(M.source.id);r("#read-only-output-port-name").text(M.source.name).attr("title",M.source.name)}if(F.isProcessGroup(K)||F.isRemoteProcessGroup(K)){var S=K.datum();if(M.destination.groupId===S.id){r("#input-port-options").combo("setSelectedOption",{value:M.destination.id})}}r("#connection-name").val(M.name);r("#flow-file-expiration").val(M.flowFileExpiration);r("#back-pressure-object-threshold").val(M.backPressureObjectThreshold);r("#back-pressure-data-size-threshold").val(M.backPressureDataSizeThreshold);A.populateField("connection-id",M.id);r.each(M.prioritizers,function(W,X){r("#prioritizer-available").children('li[id="'+X+'"]').detach().appendTo("#prioritizer-selected")});r("#connection-uri").val(O.uri);r("#connection-configuration").modal("setButtonModel",[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var W=q();if(F.isProcessor(P)){if(W.length>0){u(W).done(function(){N.resolve()}).fail(function(){N.reject()})}else{h.showOkDialog({headerText:"Connection Configuration",dialogContent:"The connection must have at least one relationship selected."});N.reject()}}else{u(undefined).done(function(){N.resolve()}).fail(function(){N.reject()})}r("#connection-configuration").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){r("#connection-configuration").modal("hide");N.reject()}}}]);r("#connection-configuration").modal("setHeaderText","Configure Connection").modal("show");r("#connection-configuration div.relationship-name").ellipsis();var V=r("#relationship-names");if(V.is(":visible")&&V.get(0).scrollHeight>Math.round(V.innerHeight())){V.css("border-width","1px")}}).fail(function(){N.reject()})}).promise()}};return n}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.ErrorHandler"],function(c,d,e){return(nf.ConnectionDetails=b(c,d,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ConnectionDetails=b(require("jquery"),require("nf.Common"),require("nf.ErrorHandler")))}else{nf.ConnectionDetails=b(a.$,a.nf.Common,a.nf.ErrorHandler)}}}(this,function(d,b,g){var j=function(o,q,p){if(p.type==="PROCESSOR"){return k(o,q,p)}else{if(p.type==="FUNNEL"){return l(o,q,p)}else{if(p.type==="REMOTE_OUTPUT_PORT"){return f(o,q,p)}else{return n(o,q,p)}}}};var k=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(p.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(p.name).addClass("ellipsis").attr("title",p.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-source-label").text("From processor");d("#read-only-connection-source").append(u).append(v);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var l=function(o,q,p){return d.Deferred(function(r){d("#read-only-connection-source-label").text("From funnel");d("#read-only-connection-source").text("funnel").attr("title","funnel");d("#read-only-connection-source-group-name").text(q);r.resolve()}).promise()};var f=function(o,q,p){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}).promise()};var n=function(o,q,p){return d.Deferred(function(r){if(o===p.groupId){d("#read-only-connection-source-label").text("From input");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(p.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-source-label").text("From output");d("#read-only-connection-source").text(p.name).attr("title",p.name);d("#read-only-connection-source-group-name").text(p.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var e=function(p,q,o){if(o.type==="PROCESSOR"){return a(p,q,o)}else{if(o.type==="FUNNEL"){return m(p,q,o)}else{if(o.type==="REMOTE_INPUT_PORT"){return i(p,q,o)}else{return c(p,q,o)}}}};var a=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/processors/"+encodeURIComponent(o.id),dataType:"json"}).done(function(s){var t=s.component;var u=d('<div class="label"></div>').text(t.name).addClass("ellipsis").attr("title",t.name);var v=d("<div></div>").text(b.substringAfterLast(t.type,".")).addClass("ellipsis").attr("title",b.substringAfterLast(t.type,"."));d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}).fail(function(w,s,t){if(w.status===403){var u=d('<div class="label"></div>').text(o.name).addClass("ellipsis").attr("title",o.name);var v=d("<div></div>").text("Processor").addClass("ellipsis").attr("title","Processor");d("#read-only-connection-target-label").text("To processor");d("#read-only-connection-target").append(u).append(v);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{r.reject(w,s,t)}})}).promise()};var m=function(p,q,o){return d.Deferred(function(r){d("#read-only-connection-target-label").text("To funnel");d("#read-only-connection-target").text("funnel").attr("title","funnel");d("#read-only-connection-target-group-name").text(q);r.resolve()}).promise()};var i=function(p,q,o){return d.Deferred(function(r){d.ajax({type:"GET",url:"../nifi-api/remote-process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}).promise()};var c=function(p,q,o){return d.Deferred(function(r){if(p===o.groupId){d("#read-only-connection-target-label").text("To output");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(q);r.resolve()}else{d.ajax({type:"GET",url:"../nifi-api/process-groups/"+encodeURIComponent(o.groupId),dataType:"json"}).done(function(s){var t=s.component;d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(t.name);r.resolve()}).fail(function(u,s,t){if(u.status===403){d("#read-only-connection-target-label").text("To input");d("#read-only-connection-target").text(o.name).attr("title",o.name);d("#read-only-connection-target-group-name").text(o.groupId);r.resolve()}else{r.reject(u,s,t)}})}}).promise()};var h=function(o){d('<div class="available-relationship-container"></div>').append(d('<div class="relationship-name"></div>').text(o)).appendTo("#read-only-relationship-names")};return{init:function(){d("#connection-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"read-only-connection-details-tab-content"},{name:"Settings",tabContentId:"read-only-connection-settings-tab-content"}]});d("#connection-details").modal({headerText:"Connection Details",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){d("#connection-details").modal("hide")}}}],handler:{close:function(){d("#read-only-relationship-names").empty();b.clearField("read-only-connection-name");b.clearField("read-only-connection-id");d("#read-only-connection-source-label").text("");d("#read-only-connection-source").empty();d("#read-only-connection-source-group-name").text("");d("#read-only-connection-target-label").text("");d("#read-only-connection-target").empty();d("#read-only-connection-target-group-name").text("");d("#read-only-relationship-names").css("border-width","0").empty();d("#read-only-flow-file-expiration").text("");d("#read-only-back-pressure-object-threshold").text("");d("#read-only-back-pressure-data-size-threshold").text("");d("#read-only-prioritizers").empty()},open:function(){b.toggleScrollable(d("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},showDetails:function(p,r){var q=d.ajax({type:"GET",url:"../nifi-api/flow/process-groups/"+encodeURIComponent(p),dataType:"json"});var o=d.ajax({type:"GET",url:"../nifi-api/connections/"+encodeURIComponent(r),dataType:"json"});d.when(q,o).done(function(w,u){var v=w[0];var x=u[0];if(x.permissions.canRead){var t=x.component;var z=v.permissions.canRead?v.processGroupFlow.breadcrumb.breadcrumb.name:v.processGroupFlow.id;var y=j(v.id,z,t.source);var s=e(v.id,z,t.destination);d.when(y,s).done(function(){var B=t.availableRelationships;var A=t.selectedRelationships;if(b.isDefinedAndNotNull(B)||b.isDefinedAndNotNull(A)){d.each(B,function(G,F){h(F)});d.each(A,function(H,F){if(d.inArray(F,B)===-1){var I=h(F);d(I).children("div.relationship-name").addClass("undefined")}var G=d("#read-only-relationship-names").children("div");d.each(G.children("div.relationship-name"),function(K,J){var L=d(J);if(L.text()===F){L.css("font-weight","bold")}})});d("#selected-relationship-text").show();d("#read-only-relationship-names-container").show()}else{d("#selected-relationship-text").hide();d("#read-only-relationship-names-container").hide()}b.populateField("read-only-connection-name",t.name);b.populateField("read-only-connection-id",t.id);b.populateField("read-only-flow-file-expiration",t.flowFileExpiration);b.populateField("read-only-back-pressure-object-threshold",t.backPressureObjectThreshold);b.populateField("read-only-back-pressure-data-size-threshold",t.backPressureDataSizeThreshold);if(b.isDefinedAndNotNull(t.prioritizers)&&t.prioritizers.length>0){var E=d("<ol></ol>").css("list-style","decimal inside none");d.each(t.prioritizers,function(F,G){E.append(d("<li></li>").text(b.substringAfterLast(G,".")))});d("#read-only-prioritizers").append(E)}else{var C=d('<span class="unset">No value set</span>');d("#read-only-prioritizers").append(C)}d("#connection-details-tabs").find("li:first").click();d("#connection-details").modal("show");var D=d("#read-only-relationship-names");if(D.is(":visible")&&D.get(0).scrollHeight>Math.round(D.innerHeight())){D.css("border-width","1px")}}).fail(g.handleAjaxError)}}).fail(g.handleAjaxError)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ng.Bridge"],function(f,e,g,d,c){return(nf.ContextMenu=b(f,e,g,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ContextMenu=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ng.Bridge")))}else{nf.ContextMenu=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ng.Bridge)}}}(this,function(B,M,J,R,m){var w;var E=function(T){return R.getParentGroupId()!==null&&T.empty()};var P=function(T){return R.isConfigurable(T)};var C=function(T){return R.hasDetails(T)};var r=function(T){return R.areDeletable(T)};var K=function(T){return R.canWrite()&&(T.empty()&&R.canRead(T))};var c=function(T){return R.canWrite()&&T.empty()};var Q=function(T){return R.getComponentByType("Connection").isDisconnected(T)&&R.canModify(T)};var D=function(T){return R.canEnable(T)};var z=function(T){return R.canDisable(T)};var A=function(T){return R.isConfigurableAuthorizer()&&R.canManagePolicies(T)};var n=function(T){return R.areRunnable(T)};var H=function(T){return R.areStoppable(T)};var j=function(T){if(T.size()!==1){return false}return R.isProcessor(T)||R.isProcessGroup(T)||R.isRemoteProcessGroup(T)||R.isConnection(T)};var I=function(T){if(T.size()!==1){return false}if(R.canRead(T)===false){return false}return R.isProcessor(T)};var s=function(T){return T.size()===1&&!R.isConnection(T)};var f=function(T){return R.isCopyable(T)};var d=function(T){return R.isPastable()};var N=function(T){return T.empty()};var v=function(T){if(T.size()!==1){return false}if(R.canModify(T)===false){return false}return R.isConnection(T)};var o=function(T){return R.canAlign(T)};var u=function(T){return R.isColorable(T)};var S=function(T){if(T.size()!==1){return false}return R.isConnection(T)};var l=function(T){if(T.size()!==1){return false}return R.isFunnel(T)||R.isProcessor(T)||R.isProcessGroup(T)||R.isRemoteProcessGroup(T)||R.isInputPort(T)||(R.isOutputPort(T)&&R.getParentGroupId()!==null)};var p=function(T){if(T.size()!==1){return false}return R.isFunnel(T)||R.isProcessor(T)||R.isProcessGroup(T)||R.isRemoteProcessGroup(T)||R.isOutputPort(T)||(R.isInputPort(T)&&R.getParentGroupId()!==null)};var k=function(U){if(U.size()!==1){return false}if(R.canRead(U)===false||R.canModify(U)===false){return false}if(R.isProcessor(U)){var T=U.datum();return T.component.persistsState===true}else{return false}};var G=function(U){if(U.size()!==1){return false}if(R.canRead(U)===false||R.canModify(U)===false){return false}if(R.isProcessor(U)){var T=U.datum();return T.component.multipleVersionsAvailable===true}else{return false}};var a=function(T){if(T.size()!==1){return false}return R.isProcessGroup(T)};var q=function(T){if(T.size()!==1){return false}return !R.isLabel(T)&&!R.isConnection(T)&&!R.isProcessGroup(T)&&!R.isRemoteProcessGroup(T)&&J.canAccessProvenance()};var b=function(T){if(T.size()!==1){return false}if(R.canRead(T)===false){return false}return R.isRemoteProcessGroup(T)};var y=function(T){if(R.canModify(T)===false){return false}return R.canAllStartTransmitting(T)};var h=function(T){if(R.canModify(T)===false){return false}return R.canAllStopTransmitting(T)};var O=function(T){return S(T)};var i=function(T){return S(T)};var t=function(T){if(R.canModify(T)===false){return false}return !T.empty()&&R.getComponentByType("Connection").isDisconnected(T)&&R.getParentGroupId()!==null};var g=function(U,W){if(typeof W.click==="function"){var V=B('<div class="context-menu-item"></div>').on("click",W.click).on("contextmenu",function(X){W.click(X);X.preventDefault();X.stopPropagation()}).on("mouseenter",function(){B(this).addClass("hover")}).on("mouseleave",function(){B(this).removeClass("hover")}).appendTo(U);var T=B('<div class="context-menu-item-img"></div>').addClass(W.clazz).appendTo(V);if(J.isDefinedAndNotNull(W.imgStyle)){T.addClass(W.imgStyle)}B('<div class="context-menu-item-text"></div>').text(W.text).appendTo(V);B('<div class="clear"></div>').appendTo(V)}};var e=function(U,T){U.css({left:T.x+"px",top:T.y+"px"}).show()};var L=function(V,U,T){w[V](U,T);x.hide()};var F=[{condition:N,menuItem:{clazz:"fa fa-refresh",text:"Refresh",action:"reload"}},{condition:E,menuItem:{clazz:"fa fa-level-up",text:"Leave group",action:"leaveGroup"}},{condition:P,menuItem:{clazz:"fa fa-gear",text:"Configure",action:"showConfiguration"}},{condition:C,menuItem:{clazz:"fa fa-gear",text:"View configuration",action:"showDetails"}},{condition:a,menuItem:{clazz:"fa fa-sign-in",text:"Enter group",action:"enterGroup"}},{condition:n,menuItem:{clazz:"fa fa-play",text:"Start",action:"start"}},{condition:H,menuItem:{clazz:"fa fa-stop",text:"Stop",action:"stop"}},{condition:D,menuItem:{clazz:"fa fa-flash",text:"Enable",action:"enable"}},{condition:z,menuItem:{clazz:"icon icon-enable-false",text:"Disable",action:"disable"}},{condition:Q,menuItem:{clazz:"icon icon-group",text:"Group",action:"group"}},{condition:b,menuItem:{clazz:"fa fa-cloud",text:"Remote ports",action:"remotePorts"}},{condition:y,menuItem:{clazz:"fa fa-bullseye",text:"Enable transmission",action:"enableTransmission"}},{condition:h,menuItem:{clazz:"icon icon-transmit-false",text:"Disable transmission",action:"disableTransmission"}},{condition:j,menuItem:{clazz:"fa fa-area-chart",text:"Status History",action:"showStats"}},{condition:q,menuItem:{clazz:"icon icon-provenance",imgStyle:"context-menu-provenance",text:"Data provenance",action:"openProvenance"}},{condition:k,menuItem:{clazz:"fa fa-tasks",text:"View state",action:"viewState"}},{condition:G,menuItem:{clazz:"fa fa-exchange",text:"Change version",action:"changeVersion"}},{condition:v,menuItem:{clazz:"fa fa-clone",text:"Bring to front",action:"toFront"}},{condition:S,menuItem:{clazz:"fa fa-long-arrow-left",text:"Go to source",action:"showSource"}},{condition:S,menuItem:{clazz:"fa fa-long-arrow-right",text:"Go to destination",action:"showDestination"}},{condition:p,menuItem:{clazz:"icon icon-connect",text:"Upstream connections",action:"showUpstream"}},{condition:l,menuItem:{clazz:"icon icon-connect",text:"Downstream connections",action:"showDownstream"}},{condition:I,menuItem:{clazz:"fa fa-book",text:"Usage",action:"showUsage"}},{condition:b,menuItem:{clazz:"fa fa-refresh",text:"Refresh",action:"refreshRemoteFlow"}},{condition:b,menuItem:{clazz:"fa fa-external-link",text:"Go to",action:"openUri"}},{condition:u,menuItem:{clazz:"fa fa-paint-brush",text:"Change color",action:"fillColor"}},{condition:s,menuItem:{clazz:"fa fa-crosshairs",text:"Center in view",action:"center"}},{condition:f,menuItem:{clazz:"fa fa-copy",text:"Copy",action:"copy"}},{condition:d,menuItem:{clazz:"fa fa-paste",text:"Paste",action:"paste"}},{condition:t,menuItem:{clazz:"fa fa-arrows",text:"Move to parent group",action:"moveIntoParent"}},{condition:i,menuItem:{clazz:"fa fa-list",text:"List queue",action:"listQueue"}},{condition:O,menuItem:{clazz:"fa fa-minus-circle",text:"Empty queue",action:"emptyQueue"}},{condition:r,menuItem:{clazz:"fa fa-trash",text:"Delete",action:"delete"}},{condition:A,menuItem:{clazz:"fa fa-key",text:"Access policies",action:"managePolicies"}},{condition:o,menuItem:{clazz:"fa fa-align-center",text:"Align vertically",action:"alignVertical"}},{condition:o,menuItem:{clazz:"fa fa-align-center fa-rotate-90",text:"Align horizontally",action:"alignHorizontal"}},{condition:c,menuItem:{clazz:"icon icon-template-import",text:"Upload template",action:"uploadTemplate"}},{condition:K,menuItem:{clazz:"icon icon-template-save",text:"Create template",action:"template"}}];var x={init:function(T){w=T;B("#context-menu").on("contextmenu",function(U){U.preventDefault();U.stopPropagation()})},show:function(){var V=B("#context-menu").empty();var Y=B("#canvas-body").get(0);var U=B("#banner-footer").get(0);var X=B("#breadcrumbs").get(0);var W=R.getSelection();B.each(F,function(Z,ab){if(ab.condition(W,R.getComponentByType("Connection"))){var aa=ab.menuItem;g(V,{clazz:aa.clazz,imgStyle:aa.imgStyle,text:aa.text,click:function(ac){L(aa.action,W,ac)}})}});var T=M.mouse(Y);if(T[0]+V.width()>Y.clientWidth){T[0]=Y.clientWidth-V.width()-2}if(T[1]+V.height()>(Y.clientHeight-X.clientHeight-U.clientHeight)){T[1]=Y.clientHeight-X.clientHeight-U.clientHeight-V.height()-3}e(V,{x:T[0],y:T[1]});m.digest()},hide:function(){B("#context-menu").hide()},activate:function(T){T.on("contextmenu.selection",function(){x.show();M.event.preventDefault();M.event.stopPropagation()})}};return x}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.ng.Bridge","nf.ContextMenu","nf.CanvasUtils"],function(f,d,c,e){return(nf.Selectable=b(f,d,c,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Selectable=b(require("d3"),require("nf.ng.Bridge"),require("nf.ContextMenu"),require("nf.CanvasUtils")))}else{nf.Selectable=b(a.d3,a.nf.ng.Bridge,a.nf.ContextMenu,a.nf.CanvasUtils)}}}(this,function(d,b,a,c){var e={select:function(f){a.hide();if(!f.classed("selected")){if(!d.event.shiftKey){d.selectAll("g.selected").classed("selected",false)}f.classed("selected",true)}else{if(d.event.shiftKey){f.classed("selected",false)}}b.digest();d.event.stopPropagation()},activate:function(f){f.on("mousedown.selection",function(){e.select(d.select(this));c.setURLParameters()})}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.CanvasUtils","nf.ContextMenu","nf.Label"],function(f,e,g,d,c,h){return(nf.Birdseye=b(f,e,g,d,c,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Birdseye=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.Label")))}else{nf.Birdseye=b(a.$,a.d3,a.nf.Common,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.Label)}}}(this,function(g,l,d,e,k,f){var h;var c;var j;var i=function(F){var D=e.translateCanvasView();var U=e.scaleCanvasView();D=[D[0]/U,D[1]/U];var x=l.select("#canvas").node().getBoundingClientRect();var m=(x.left/U)-D[0];var z=((x.top-e.getCanvasOffset())/U)-D[1];var E=(x.right/U)-D[0];var s=(x.bottom/U)-D[1];var H=g("#canvas-container");var I=H.width()/U;var S=H.height()/U;var y=-D[0];var M=-D[1];var T=y+I;var v=M+S;var K=Math.min(m,y);var N=Math.min(z,M);var p=Math.max(E,T);var Q=Math.max(s,v);var R=p-K;var n=Q-N;var C=g("#birdseye");var B=C.width();var u=C.height();var L=B/R;var t=u/n;var J=Math.min(L,t);var r=[0,0];var o=[0,0];if(D[0]<0&&D[1]<0){r=[0,0];o=[-D[0],-D[1]]}else{if(D[0]>=0&&D[1]<0){r=[D[0],0];o=[0,-D[1]]}else{if(D[0]<0&&D[1]>=0){r=[0,D[1]];o=[-D[0],0]}else{r=[D[0],D[1]];o=[0,0]}}}var P=0;var w=-m;if(D[0]<0){if(D[0]<w){P=w}else{P=w-(w-D[0])}}else{if(D[0]<w){P=w-D[0]}}var O=0;var G=-z;if(D[1]<0){if(D[1]<G){O=G}else{O=G-(G-D[1])}}else{if(D[1]<G){O=G-D[1]}}r=[r[0]+P,r[1]+O];o=[o[0]+P,o[1]+O];c.attr("transform","scale("+J+")");j.attr("transform","translate("+r+")");l.select("rect.birdseye-brush").attr({width:I,height:S,"stroke-width":(2/J),transform:function(V){V.x=o[0];V.y=o[1];return"translate("+o+")"}});var A=l.select("#birdseye-canvas").node();var q=A.getContext("2d");q.save();q.setTransform(1,0,0,1,0,0);q.clearRect(0,0,A.width,A.height);q.restore();q.save();q.translate(r[0]*J,r[1]*J);q.scale(J,J);g.each(F.labels,function(W,X){var V=f.defaultColor();if(X.permissions.canRead){if(d.isDefinedAndNotNull(X.component.style["background-color"])){V=X.component.style["background-color"]}}q.fillStyle=V;q.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});q.fillStyle="#ad9897";g.each(F.funnels,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});q.fillStyle="#bbdcde";g.each(F.ports,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});q.fillStyle="#728e9b";g.each(F.remoteProcessGroups,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});g.each(F.processGroups,function(V,W){q.fillRect(W.position.x,W.position.y,W.dimensions.width,W.dimensions.height)});g.each(F.processors,function(W,X){var V="#dde4eb";if(X.permissions.canRead){if(d.isDefinedAndNotNull(X.component.style["background-color"])){V=X.component.style["background-color"];if(V==="#ffffff"){V="#dde4eb"}}}q.fillStyle=V;q.fillRect(X.position.x,X.position.y,X.dimensions.width,X.dimensions.height)});q.restore()};var b=true;var a={init:function(m){h=m;var p=g("#birdseye");l.select("#birdseye").append("canvas").attr("id","birdseye-canvas").attr("width",p.width()).attr("height",p.height());var o=l.select("#birdseye").append("svg").attr("width",p.width()).attr("height",p.height());c=o.append("g").attr("class","birdseye");j=c.append("g").attr("pointer-events","none");var n=l.behavior.drag().origin(function(q){return{x:q.x,y:q.y}}).on("dragstart",function(){k.hide()}).on("drag",function(s){s.x+=l.event.dx;s.y+=l.event.dy;l.select(this).attr("transform",function(){return"translate("+s.x+", "+s.y+")"});var r=e.scaleCanvasView();var q=e.translateCanvasView();q=[(-l.event.dx*r)+q[0],(-l.event.dy*r)+q[1]];e.translateCanvasView(q);e.refreshCanvasView({persist:false,transition:false,refreshComponents:false,refreshBirdseye:false})}).on("dragend",function(){h.updateVisibility();e.persistUserView();a.refresh()});c.append("g").attr({"pointer-events":"all","class":"birdseye-brush-container"}).append("rect").attr("class","birdseye-brush moveable").datum({x:0,y:0}).call(n)},refresh:function(){if(b){i(h.get())}},updateBirdseyeVisibility:function(m){var n=g("#birdseye");if(m){n.show();b=true;i(h.get())}else{n.hide();b=false}}};return a}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Connection","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Client","nf.ErrorHandler"],function(g,j,i,c,e,d,f,k,h){return(nf.Draggable=b(g,j,i,c,e,d,f,k,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Draggable=b(require("jquery"),require("d3"),require("nf.Connection"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ErrorHandler")))}else{nf.Draggable=b(a.$,a.d3,a.nf.Connection,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ErrorHandler)}}}(this,function(g,m,k,a,d,c,f,n,j){var l;var h;var i=function(p){var s=m.map();var r=p.datum();var t={x:r.x-r.original.x,y:r.y-r.original.y};if(t.x===0&&t.y===0){return}var o=m.selectAll("g.connection.selected");var q=m.selectAll("g.component.selected");if(d.canModify(o)===false||d.canModify(q)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}o.each(function(v){var u=e.updateConnectionPosition(v,t);if(u!==null){s.set(v.id,u)}});q.each(function(v){var u=k.getComponentConnections(v.id);g.each(u,function(y,x){if(!s.has(x.id)&&d.getConnectionSourceComponentId(x)===d.getConnectionDestinationComponentId(x)){var w=e.updateConnectionPosition(k.get(x.id),t);if(w!==null){s.set(x.id,w)}}});s.set(v.id,e.updateComponentPosition(v,t))});e.refreshConnections(s)};var b=function(p){var o=m.selectAll("g.component.selected, g.connection.selected").classed("selected",false);if(d.canModify(o)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}if(d.canModify(p)===false){f.showOkDialog({headerText:"Component Position",dialogContent:"Not authorized to modify the destination group."});return}d.moveComponents(o,p)};var e={init:function(o){l=o;h=m.behavior.drag().on("dragstart",function(){m.event.sourceEvent.stopPropagation()}).on("drag",function(){var q=m.select("rect.drag-selection");if(q.empty()){var r=m.selectAll("g.component.selected");var p=null,t=null,u=null,s=null;r.each(function(x){if(p===null||x.position.x<p){p=x.position.x}if(u===null||x.position.y<u){u=x.position.y}var w=x.position.x+x.dimensions.width;var v=x.position.y+x.dimensions.height;if(t===null||w>t){t=w}if(s===null||v>s){s=v}});m.select("#canvas").append("rect").attr("rx",6).attr("ry",6).attr("x",p).attr("y",u).attr("class","drag-selection").attr("pointer-events","none").attr("width",t-p).attr("height",s-u).attr("stroke-width",function(){return 1/d.scaleCanvasView()}).attr("stroke-dasharray",function(){return 4/d.scaleCanvasView()}).datum({original:{x:p,y:u},x:p,y:u})}else{q.attr("x",function(v){v.x+=m.event.dx;return v.x}).attr("y",function(v){v.y+=m.event.dy;return v.y})}}).on("dragend",function(){m.event.sourceEvent.stopPropagation();var p=m.select("rect.drag-selection");if(p.empty()){return}var q=m.select("g.drop").classed("drop",false);if(q.empty()){i(p)}else{b(q)}p.remove()})},updateComponentPosition:function(q,r){var p={x:q.position.x+r.x,y:q.position.y+r.y};var o={revision:n.getRevision(q),component:{id:q.id,position:p}};return g.Deferred(function(s){g.ajax({type:"PUT",url:q.uri,data:JSON.stringify(o),dataType:"json",contentType:"application/json"}).done(function(t){d.getComponentByType(q.type).set(t);s.resolve({type:q.type,id:q.id})}).fail(function(v,t,u){if(v.status===400||v.status===404||v.status===409){f.showOkDialog({headerText:"Component Position",dialogContent:c.escapeHtml(v.responseText)})}else{j.handleAjaxError(v,t,u)}s.reject()})}).promise()},updateConnectionPosition:function(q,r){if(q.bends.length===0){return null}var p=g.map(q.bends,function(s){return{x:s.x+r.x,y:s.y+r.y}});var o={revision:n.getRevision(q),component:{id:q.id,bends:p}};return g.Deferred(function(s){g.ajax({type:"PUT",url:q.uri,data:JSON.stringify(o),dataType:"json",contentType:"application/json"}).done(function(t){k.set(t);s.resolve({type:q.type,id:q.id})}).fail(function(v,t,u){if(v.status===400||v.status===404||v.status===409){f.showOkDialog({headerText:"Component Position",dialogContent:c.escapeHtml(v.responseText)})}else{j.handleAjaxError(v,t,u)}s.reject()})}).promise()},refreshConnections:function(o){if(o.size()>0){g.when.apply(window,o.values()).done(function(){var p=g.makeArray(arguments);var q=m.set();g.each(p,function(t,s){if(s.type==="Connection"){q.add(s.id)}else{var r=k.getComponentConnections(s.id);g.each(r,function(v,u){q.add(u.id)})}});q.forEach(function(r){k.refresh(r)})}).always(function(){a.refresh()})}},activate:function(o){o.classed("moveable",true).call(h)},deactivate:function(o){o.classed("moveable",false).on(".drag",null)}};return e}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["d3","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils"],function(d,f,e,c){return(nf.Connectable=b(d,f,e,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Connectable=b(require("d3"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils")))}else{nf.Connectable=b(a.d3,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils)}}}(this,function(f,h,g,e){var c;var d;var b;var a=function(){return !f.event.shiftKey&&f.select("rect.drag-selection").empty()&&f.select("rect.selection").empty()};return{init:function(){d=f.select("#canvas");c=f.behavior.drag().origin(function(i){b=f.mouse(d.node());return{x:b[0],y:b[1]}}).on("dragstart",function(l){f.event.sourceEvent.stopPropagation();e.getSelection().classed("selected",false);var k=f.select(this.parentNode).classed("selected",true);f.select(this).classed("dragging",true);var j=k.datum();var i=f.mouse(d.node());d.insert("path",":first-child").datum({sourceId:j.id,sourceWidth:j.dimensions.width,x:i[0],y:i[1]}).attr({"class":"connector",d:function(m){return"M"+m.x+" "+m.y+"L"+m.x+" "+m.y}});f.select(this).attr("transform",function(){return"translate("+i[0]+", "+(i[1]+20)+")"});d.node().appendChild(this)}).on("drag",function(j){f.select(this).attr("transform",function(){return"translate("+f.event.x+", "+(f.event.y+50)+")"});var i=f.select("g.hover").classed("connectable-destination",function(){return(Math.abs(b[0]-f.event.x)>10||Math.abs(b[1]-f.event.y)>10)&&e.isValidConnectionDestination(f.select(this))});f.select("path.connector").classed("connectable",function(){if(i.empty()){return false}return i.classed("connectable-destination")}).attr("d",function(r){if(!i.empty()&&i.classed("connectable-destination")){var m=i.datum();if(r.sourceId===m.id){var k=r.x;var q=r.y;var o=r.sourceWidth/2;var n=h.config.selfLoopXOffset;var p=h.config.selfLoopYOffset;return"M"+k+" "+q+"L"+(k+o+n)+" "+(q-p)+"L"+(k+o+n)+" "+(q+p)+"Z"}else{var l=e.getPerimeterPoint(r,{x:m.position.x,y:m.position.y,width:m.dimensions.width,height:m.dimensions.height});return"M"+r.x+" "+r.y+"L"+l.x+" "+l.y}}else{return"M"+r.x+" "+r.y+"L"+f.event.x+" "+f.event.y}})}).on("dragend",function(o){f.event.sourceEvent.stopPropagation();var q=f.select(this);var l=f.select("path.connector");var j=l.datum();var p=f.select("g.connectable-destination");if(p.empty()){var i=f.select("#id-"+j.sourceId);var m=i.datum();var n=f.mouse(i.node());if(n[0]<0||n[0]>m.dimensions.width||n[1]<0||n[1]>m.dimensions.height){q.remove()}else{q.classed("dragging",false).attr("transform",function(){return"translate("+o.origX+", "+o.origY+")"});i.node().appendChild(this)}l.remove()}else{q.remove();var k=p.datum();g.createConnection(j.sourceId,k.id)}})},activate:function(i){i.classed("connectable",true).on("mouseenter.connectable",function(m){if(a()){var k=f.select(this);if(e.isValidConnectionSource(k)){var l=f.select("text.add-connect");if(l.empty()){var j=(m.dimensions.width/2)-14;var n=(m.dimensions.height/2)+14;k.append("text").datum({origX:j,origY:n}).call(c).attr({"class":"add-connect",transform:"translate("+j+", "+n+")"}).text("\ue834")}}}}).on("mouseleave.connectable",function(){var j=f.select(this).select("text.add-connect");if(!j.empty()&&!j.classed("dragging")){j.remove()}}).on("mouseover.connectable",function(){f.select(this).classed("hover",function(){return a()})}).on("mouseout.connection",function(){f.select(this).classed("hover connectable-destination",false)})},deactivate:function(i){i.classed("connectable",false).on("mouseenter.connectable",null).on("mouseleave.connectable",null).on("mouseover.connectable",null).on("mouseout.connectable",null)}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.ng.Bridge","nf.Label","nf.Funnel","nf.Port","nf.RemoteProcessGroup","nf.ProcessGroup","nf.Processor","nf.Connection","nf.ConnectionConfiguration","nf.CanvasUtils","nf.Connectable","nf.Draggable","nf.Selectable","nf.ContextMenu"],function(m,s,h,n,k,f,l,e,c,p,o,j,g,r,i,d,q){return(nf.Graph=b(m,s,h,n,k,f,l,e,c,p,o,j,g,r,i,d,q))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Graph=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.ng.Bridge"),require("nf.Label"),require("nf.Funnel"),require("nf.Port"),require("nf.RemoteProcessGroup"),require("nf.ProcessGroup"),require("nf.Processor"),require("nf.Connection"),require("nf.ConnectionConfiguration"),require("nf.CanvasUtils"),require("nf.Connectable"),require("nf.Draggable"),require("nf.Selectable"),require("nf.ContextMenu")))}else{nf.Graph=b(a.$,a.d3,a.nf.Common,a.nf.ng.Bridge,a.nf.Label,a.nf.Funnel,a.nf.Port,a.nf.RemoteProcessGroup,a.nf.ProcessGroup,a.nf.Processor,a.nf.Connection,a.nf.ConnectionConfiguration,a.nf.CanvasUtils,a.nf.Connectable,a.nf.Draggable,a.nf.Selectable,a.nf.ContextMenu)}}}(this,function(b,t,e,u,i,p,a,k,d,j,f,q,r,h,m,g,n){var o=function(v){if(e.isDefinedAndNotNull(v.inputPorts)&&e.isDefinedAndNotNull(v.outputPorts)){return v.inputPorts.concat(v.outputPorts)}else{if(e.isDefinedAndNotNull(v.inputPorts)){return v.inputPorts}else{if(e.isDefinedAndNotNull(v.outputPorts)){return v.outputPorts}else{return[]}}}};var l=function(v){if(e.isDefinedAndNotNull(v.inputPortStatusSnapshots)&&e.isDefinedAndNotNull(v.outputPortStatusSnapshots)){return v.inputPortStatusSnapshots.concat(v.outputPortStatusSnapshots)}else{if(e.isDefinedAndNotNull(v.inputPortStatusSnapshots)){return v.inputPortStatusSnapshots}else{if(e.isDefinedAndNotNull(v.outputPortStatusSnapshots)){return v.outputPortStatusSnapshots}else{return[]}}}};var s=function(){var D=b("#canvas-container");var y=r.translateCanvasView();var z=r.scaleCanvasView();y=[y[0]/z,y[1]/z];var v=D.width()/z;var w=D.height()/z;var A=-y[0]-v;var x=-y[1]-w;var F=A+(v*3);var H=x+(w*3);var C=function(M){if(!r.shouldRenderPerScale()){return false}var L=M.position.x;var K=M.position.y;var J=L+M.dimensions.width;var I=K+M.dimensions.height;return A<J&&F>L&&x<I&&H>K};var E=function(K){if(!r.shouldRenderPerScale()){return false}var I,L;if(K.bends.length>0){var J=Math.min(Math.max(0,K.labelIndex),K.bends.length-1);I=K.bends[J].x;L=K.bends[J].y}else{I=(K.start.x+K.end.x)/2;L=(K.start.y+K.end.y)/2}return A<I&&F>I&&x<L&&H>L};var B=function(M,I){var K=t.select("#id-"+M.id);var L=I(M);var J=K.classed("visible");K.classed("visible",L).classed("entering",function(){return L&&!J}).classed("leaving",function(){return !L&&J})};var G=c.get();b.each(G.processors,function(I,J){B(J,C)});b.each(G.ports,function(I,J){B(J,C)});b.each(G.processGroups,function(I,J){B(J,C)});b.each(G.remoteProcessGroups,function(I,J){B(J,C)});b.each(G.connections,function(I,J){B(J,E)})};var c={init:function(){i.init(h,m,g,n);p.init(h,m,g,n);a.init(h,m,g,n);k.init(h,m,g,n);d.init(h,m,g,n);j.init(h,m,g,n);f.init(g,n,q);return r.showDeepLink(true)},add:function(x,v){var w=false;if(e.isDefinedAndNotNull(v)){w=e.isDefinedAndNotNull(v.selectAll)?v.selectAll:w}if(w){r.getSelection().classed("selected",false)}var y=o(x);i.add(x.labels,v);p.add(x.funnels,v);k.add(x.remoteProcessGroups,v);a.add(y,v);d.add(x.processGroups,v);j.add(x.processors,v);f.add(x.connections,v);if(w){u.digest()}},set:function(x,v){var w=false;if(e.isDefinedAndNotNull(v)){w=e.isDefinedAndNotNull(v.selectAll)?v.selectAll:w}if(w){r.getSelection().classed("selected",false)}var y=o(x);i.set(x.labels,v);p.set(x.funnels,v);k.set(x.remoteProcessGroups,v);a.set(y,v);d.set(x.processGroups,v);j.set(x.processors,v);f.set(x.connections,v);if(w){u.digest()}},expireCaches:function(v){i.expireCaches(v);p.expireCaches(v);k.expireCaches(v);a.expireCaches(v);d.expireCaches(v);j.expireCaches(v);f.expireCaches(v)},get:function(){return{labels:i.get(),funnels:p.get(),ports:a.get(),remoteProcessGroups:k.get(),processGroups:d.get(),processors:j.get(),connections:f.get()}},getComponentByType:function(v){switch(v){case"Label":return i;break;case"Funnel":return p;break;case"Port":return a;break;case"RemoteProcessGroup":return k;break;case"ProcessGroup":return d;break;case"Processor":return j;break;case"Connection":return f;break;default:throw new Error("Unknown component type.");break}},removeAll:function(){i.removeAll();p.removeAll();a.removeAll();k.removeAll();d.removeAll();j.removeAll();f.removeAll()},pan:function(){a.pan();k.pan();d.pan();j.pan();f.pan()},updateVisibility:function(){s();c.pan();r.setURLParameters()},getSelection:function(){return t.selectAll("g.component.selected, g.connection.selected")},reload:function(v){var w=v.datum();if(w.permissions.canRead){if(r.isProcessor(v)){j.reload(w.id)}else{if(r.isInputPort(v)){a.reload(w.id)}else{if(r.isRemoteProcessGroup(v)){k.reload(w.id)}}}}}};return c}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Dialog","nf.ErrorHandler"],function(e,c,f,d,g){return(nf.StatusHistory=b(e,c,f,d,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.StatusHistory=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Dialog"),require("nf.ErrorHandler")))}else{nf.StatusHistory=b(a.$,a.d3,a.nf.Common,a.nf.Dialog,a.nf.ErrorHandler)}}}(this,function(d,x,g,s,f){var w={nifiInstanceId:"nifi-instance-id",nifiInstanceLabel:"NiFi",type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label"},urls:{api:"../nifi-api"}};var v={DURATION:function(z){return g.formatDuration(z)},COUNT:function(z){if(z%1===0){return g.formatInteger(z)}else{return g.formatFloat(z)}},DATA_SIZE:function(z){return g.formatDataSize(z)}};var m=null;var n=null;var q=null;var c=null;var j=function(B,F,D,A,E){d("#status-history-last-refreshed").text(D.generated);var z={groupId:B,id:F,type:A,instances:[]};var C=D.fieldDescriptors;z.details=D.componentDetails;z.selectedDescriptor=g.isUndefined(E)?C[0]:E;if(g.isDefinedAndNotNull(D.aggregateSnapshots)&&D.aggregateSnapshots.length>1){z.instances.push({id:w.nifiInstanceId,label:w.nifiInstanceLabel,snapshots:D.aggregateSnapshots})}else{i();return}d.each(D.nodeSnapshots,function(H,G){if(g.isDefinedAndNotNull(G.statusSnapshots)&&G.statusSnapshots.length>1){z.instances.push({id:G.nodeId,label:G.address+":"+G.apiPort,snapshots:G.statusSnapshots})}});if(z.instances.length>0){d("#status-history-dialog").data("status-history",z);r(z,C)}else{i()}};var i=function(){s.showOkDialog({headerText:"Status History",dialogContent:"Insufficient history, please try again later."})};var r=function(z,A){if(c===null){c={}}d.each(z.instances,function(C,B){B.snapshots.forEach(function(F){var E=new Date();var D=E.getTimezoneOffset()*60*1000;F.timestamp=new Date(F.timestamp+D+m)})});l(A,z.selectedDescriptor)};var l=function(B,A){var z=[];d.each(B,function(C,D){z.push({text:D.label,value:D.field,description:g.escapeHtml(D.description)})});d("#status-history-metric-combo").combo({selectedOption:{value:A.field},options:z,select:function(D){var E=null;d.each(B,function(F,G){if(D.value===G.field){E=G;return false}});if(E!==null){if(q===null||q.field!==E.field){n=null}q=E;var C=d("#status-history-dialog").data("status-history");C.selectedDescriptor=E;d("#status-history-dialog").data("status-history",C);k()}}});d("#status-history-dialog").modal("show")};var a=function(){return d("#status-history-chart-container").parent().outerHeight()-d("#status-history-chart-control-container").outerHeight()-parseInt(d("#status-history-chart-control-container").css("margin-top"),10)};var y=function(){return d("body").height()-d("#status-history-chart-control-container").outerHeight()-d("#status-history-refresh-container").outerHeight()-parseInt(d("#status-history-chart-control-container").css("margin-top"),10)-parseInt(d(".dialog-content").css("top"))-parseInt(d(".dialog-content").css("bottom"))};var u=function(){return d("body").width()-d("#status-history-details").innerWidth()-parseInt(d("#status-history-dialog").css("left"),10)-parseInt(d(".dialog-content").css("left"))-parseInt(d(".dialog-content").css("right"))};var k=function(){var ai=d("#status-history-dialog");if(ai.is(":visible")){var ab=ai.data("status-history");var ah=ab.selectedDescriptor;d("#status-history-details").empty();var C=o("Status History");x.map(ab.details).forEach(function(aw,ax){h(C,aw,ax)});var E={top:15,right:20,bottom:25,left:75};var Y=x.scale.category10();var B=[];d.each(ab.instances,function(ax,aw){B.push(aw.label)});Y.domain(B);var at=[];d.each(ab.instances,function(ax,aw){if(g.isUndefinedOrNull(c[aw.id])){c[aw.id]=true}at.push({id:aw.id,label:aw.label,values:d.map(aw.snapshots,function(ay){return{timestamp:ay.timestamp,value:ay.statusMetrics[ah.field]}}),visible:c[aw.id]===true})});var O=x.time.format.multi([[":%S.%L",function(aw){return aw.getMilliseconds()}],[":%S",function(aw){return aw.getSeconds()}],["%H:%M",function(aw){return aw.getMinutes()}],["%H:%M",function(aw){return aw.getHours()}],["%a %d",function(aw){return aw.getDay()&&aw.getDate()!==1}],["%b %d",function(aw){return aw.getDate()!==1}],["%B",function(aw){return aw.getMonth()}],["%Y",function(){return true}]]);var N=d("#status-history-chart-container").empty();if(N.hasClass("ui-resizable")){N.resizable("destroy");N.removeAttr("style")}N.height(a());var z=N.outerWidth()-E.left-E.right;var A=N.outerHeight()-E.top-E.bottom;U=d("#status-history-container").width();if(z>U){z=U}an=y();if(A>an){A=an}var af=x.time.scale().range([0,z]);var T=x.svg.axis().scale(af).ticks(5).tickFormat(O).orient("bottom");var ae=x.scale.linear().range([A,0]);var F=x.svg.axis().scale(ae).tickFormat(v[ah.formatter]).orient("left");var G=x.svg.line().interpolate("monotone").x(function(aw){return af(aw.timestamp)}).y(function(aw){return ae(aw.value)});var M=x.select("#status-history-chart-container").append("svg").attr("style","pointer-events: none;").attr("width",N.parent().width()).attr("height",N.innerHeight());var H=M.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",z).attr("height",A);var av=M.append("g").attr("transform","translate("+E.left+", "+E.top+")");var D=x.min(at,function(aw){return x.min(aw.values,function(ax){return ax.timestamp})});var K=x.max(at,function(aw){return x.max(aw.values,function(ax){return ax.timestamp})});h(C,"Start",g.formatDateTime(D));h(C,"End",g.formatDateTime(K));af.domain([D,K]);ae.domain([p(at),t(at)]);av.append("g").attr("class","x axis").attr("transform","translate(0, "+A+")").call(T);av.append("g").attr("class","y axis").call(F).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").attr("text-anchor","end").text(ah.label);var ac=av.selectAll(".status").data(at).enter().append("g").attr("clip-path","url(#clip)").attr("class","status");ac.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return G(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return aw.visible===false}).append("title").text(function(aw){return aw.label});ac.each(function(aw){var ax=x.select(this).append("g").attr("class",function(){return"mark-group mark-group-"+aw.id}).classed("hidden",function(ay){return ay.visible===false});ax.selectAll("circle.mark").data(aw.values).enter().append("circle").attr("style","pointer-events: all;").attr("class","mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("fill",function(){return Y(aw.label)}).attr("r",1.5).append("title").text(function(ay){return aw.label+" -- "+v[ah.formatter](ay.value)})});M.attr("width",N.parent().width()).attr("height",N.innerHeight());H.attr("width",z).attr("height",A);av.select(".x.axis").attr("transform","translate(0, "+A+")");var S=d("#status-history-chart-control-container").empty();var Q=S.innerHeight()-E.top-E.bottom;var al=x.time.scale().range([0,z]);var J=x.svg.axis().scale(al).ticks(5).tickFormat(O).orient("bottom");var ap=x.scale.linear().range([Q,0]);var aj=x.svg.axis().scale(ap).tickValues(ae.domain()).tickFormat(v[ah.formatter]).orient("left");var P=x.svg.line().interpolate("monotone").x(function(aw){return al(aw.timestamp)}).y(function(aw){return ap(aw.value)});var ag=x.select("#status-history-chart-control-container").append("svg").attr("width",N.parent().width()).attr("height",Q+E.top+E.bottom);var W=ag.append("g").attr("transform","translate("+E.left+", "+E.top+")");var V=ae.domain();V[1]*=1.04;al.domain(af.domain());ap.domain(V);W.append("g").attr("class","x axis").attr("transform","translate(0, "+Q+")").call(J);W.append("g").attr("class","y axis").call(aj);var au=W.selectAll(".status").data(at).enter().append("g").attr("class","status");au.append("path").attr("class",function(aw){return"chart-line chart-line-"+aw.id}).attr("d",function(aw){return P(aw.values)}).attr("stroke",function(aw){return Y(aw.label)}).classed("hidden",function(aw){return c[aw.id]===false}).append("title").text(function(aw){return aw.label});var ar=function(aw,ax){af.domain(aw);ae.domain(ax);ac.selectAll(".chart-line").attr("d",function(ay){return G(ay.values)});ac.selectAll("circle.mark").attr("cx",function(ay){return af(ay.timestamp)}).attr("cy",function(ay){return ae(ay.value)}).attr("r",function(){return am.empty()?1.5:4});av.select(".x.axis").call(T);av.select(".y.axis").call(F)};var I=function(){var ax,aw;if(am.empty()){var az=d.grep(at,function(aA){return aA.visible});if(az.length===0){aw=ap.domain()}else{aw=[x.min(az,function(aA){return x.min(aA.values,function(aB){return aB.value})}),x.max(az,function(aA){return x.max(aA.values,function(aB){return aB.value})})]}ax=al.domain();n=null}else{var ay=am.extent();ax=[ay[0][0],ay[1][0]];aw=[ay[0][1],ay[1][1]];n=ay}ar(ax,aw);L()};var am=x.svg.brush().x(al).y(ap).on("brush",I);if(g.isDefinedAndNotNull(n)){am=am.extent(n)}W.append("g").attr("class","brush").call(am);W.select("rect.extent").attr("style","pointer-events: all;").on("dblclick",function(){if(!am.empty()){var aw=am.extent();var ax=ap.domain();am.extent([[aw[0][0],ax[0]],[aw[1][0],ax[1]]]);W.select(".brush").call(am);I()}});var L=function(){var aB=d.map(at,function(aH){var aF=af.domain();var aG=ae.domain();var aI=d.extend({},aH);return d.extend(aI,{values:d.grep(aH.values,function(aJ){return aJ.timestamp.getTime()>=aF[0].getTime()&&aJ.timestamp.getTime()<=aF[1].getTime()&&aJ.value>=aG[0]&&aJ.value<=aG[1]})})});var aw=d.grep(aB,function(aF){return aF.id!==w.nifiInstanceId&&aF.visible&&aF.values.length>0});var aA=aw.length===0?"NA":v[ah.formatter](p(aw));var az=aw.length===0?"NA":v[ah.formatter](e(aw));var ax=aw.length===0?"NA":v[ah.formatter](t(aw));d("#node-aggregate-statistics").text(aA+" / "+ax+" / "+az);var aD=d.grep(aB,function(aF){return aF.id===w.nifiInstanceId&&aF.visible&&aF.values.length>0});var aE=aD.length===0?"NA":v[ah.formatter](p(aD));var aC=aD.length===0?"NA":v[ah.formatter](e(aD));var ay=aD.length===0?"NA":v[ah.formatter](t(aD));d("#cluster-aggregate-statistics").text(aE+" / "+ay+" / "+aC)};var ad=d.grep(at,function(aw){return aw.id!==w.nifiInstanceId}).sort(function(ax,aw){return ax.label<aw.label?-1:ax.label>aw.label?1:0});var aq=function(ax,aw){var az=d("<div></div>").addClass("legend-label nf-checkbox-label").css("color",Y(aw.label)).text(aw.label).ellipsis();var ay=d('<div class="nf-checkbox"></div>').on("click",function(){var aA=x.selectAll("path.chart-line-"+aw.id);var aC=x.select("g.mark-group-"+aw.id);var aB=aC.classed("hidden");aA.classed("hidden",function(){return !aB});aC.classed("hidden",function(){return !aB});aw.visible=aB;c[aw.id]=aw.visible;I()}).addClass(aw.visible?"checkbox-checked":"checkbox-unchecked");d('<div class="legend-entry"></div>').append(ay).append(az).on("mouseenter",function(){x.selectAll("path.chart-line-"+aw.id).classed("over",true)}).on("mouseleave",function(){x.selectAll("path.chart-line-"+aw.id).classed("over",false)}).appendTo(ax)};var aa=d.grep(at,function(aw){return aw.id===w.nifiInstanceId});var ak=o("NiFi");h(ak,"Min / Max / Mean","","cluster-aggregate-statistics");aq(ak,aa[0]);if(ad.length>0){var Z=o("Nodes");h(Z,"Min / Max / Mean","","node-aggregate-statistics");d.each(ad,function(ax,aw){aq(Z,aw)})}I();var U,an,R,X,ao;N.append('<div class="ui-resizable-handle ui-resizable-se"></div>').resizable({minWidth:425,minHeight:150,handles:{se:".ui-resizable-se"},start:function(ax,aw){if(!am.empty()){X=am.extent()}},resize:function(ay,ax){ao=d("#status-history-dialog");var aw={};if(g.isDefinedAndNotNull(ao.data("nf-dialog"))){aw=ao.data("nf-dialog")}aw["min-width"]=(ao.width()/d(window).width())*100+"%";aw["min-height"]=(ao.height()/d(window).height())*100+"%";aw.responsive["fullscreen-width"]=ao.outerWidth()+"px";aw.responsive["fullscreen-height"]=ao.outerHeight()+"px";U=u();if(ax.helper.width()>U){ax.helper.width(U);aw.responsive["fullscreen-width"]=d(window).width()+"px";aw["min-width"]="100%"}an=y();if(ax.helper.height()>an){ax.helper.height(an);aw.responsive["fullscreen-height"]=d(window).height()+"px";aw["min-height"]="100%"}R=a();if(ax.helper.height()<R){ax.helper.height(R)}aw["min-width"]=(parseInt(aw["min-width"],10)>=100)?"100%":aw["min-width"];aw["min-height"]=(parseInt(aw["min-height"],10)>=100)?"100%":aw["min-height"];ao.data("nfDialog",aw);ao.css("min-width",(N.outerWidth()+d("#status-history-details").outerWidth()+40));ao.css("min-height",(N.outerHeight()+d("#status-history-refresh-container").outerHeight()+d("#status-history-chart-control-container").outerHeight()+d(".dialog-buttons").outerHeight()+d(".dialog-header").outerHeight()+40+5));ao.center()},stop:k})}};var p=function(z){return x.min(z,function(A){return x.min(A.values,function(B){return B.value})})};var t=function(z){return x.max(z,function(A){return x.max(A.values,function(B){return B.value})})};var e=function(A){var B=0;var z=x.sum(A,function(C){B+=C.values.length;return x.sum(C.values,function(D){return D.value})});return z/B};var o=function(A){var z=d('<div class="status-history-detail"></div>').appendTo("#status-history-details");d('<div class="detail-container-label"></div>').text(A).appendTo(z);return d("<div></div>").appendTo(z)};var h=function(A,C,D,E){var B=d('<div class="detail-item"></div>').appendTo(A);d('<div class="setting-name"></div>').text(C).appendTo(B);var z=d('<div class="setting-field"></div>').text(D).appendTo(B);if(g.isDefinedAndNotNull(E)){z.attr("id",E)}};var b={init:function(z){m=z;d("#status-history-refresh-button").click(function(){var A=d("#status-history-dialog").data("status-history");if(A!==null){if(A.type===w.type.processor){b.showProcessorChart(A.groupId,A.id,A.selectedDescriptor)}else{if(A.type===w.type.processGroup){b.showProcessGroupChart(A.groupId,A.id,A.selectedDescriptor)}else{if(A.type===w.type.remoteProcessGroup){b.showRemoteProcessGroupChart(A.groupId,A.id,A.selectedDescriptor)}else{b.showConnectionChart(A.groupId,A.id,A.selectedDescriptor)}}}}});d("#status-history-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Status History",buttons:[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){this.modal("hide")}}}],handler:{close:function(){d("#status-history-dialog").removeData("status-history");d("#status-history-chart-container").empty();d("#status-history-chart-control-container").empty();d("#status-history-details").empty();n=null;q=null;c=null},open:k}});d(window).on("resize",function(A){if(A.target===window){k()}g.toggleScrollable(d("#status-history-details").get(0))})},showConnectionChart:function(z,A,B){d.ajax({type:"GET",url:w.urls.api+"/flow/connections/"+encodeURIComponent(A)+"/status/history",dataType:"json"}).done(function(C){j(z,A,C.statusHistory,w.type.connection,B)}).fail(f.handleAjaxError)},showProcessorChart:function(z,B,A){d.ajax({type:"GET",url:w.urls.api+"/flow/processors/"+encodeURIComponent(B)+"/status/history",dataType:"json"}).done(function(C){j(z,B,C.statusHistory,w.type.processor,A)}).fail(f.handleAjaxError)},showProcessGroupChart:function(A,z,B){d.ajax({type:"GET",url:w.urls.api+"/flow/process-groups/"+encodeURIComponent(z)+"/status/history",dataType:"json"}).done(function(C){j(A,z,C.statusHistory,w.type.processGroup,B)}).fail(f.handleAjaxError)},showRemoteProcessGroupChart:function(A,z,B){d.ajax({type:"GET",url:w.urls.api+"/flow/remote-process-groups/"+encodeURIComponent(z)+"/status/history",dataType:"json"}).done(function(C){j(A,z,C.statusHistory,w.type.remoteProcessGroup,B)}).fail(f.handleAjaxError)}};return b}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.Dialog","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.Storage","nf.CanvasUtils"],function(h,e,f,g,c,j,l,k,i,d){return(nf.QueueListing=b(h,e,f,g,c,j,l,k,i,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.QueueListing=b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.Dialog"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.CanvasUtils")))}else{nf.QueueListing=b(a.$,a.Slick,a.nf.Common,a.nf.Dialog,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Storage,a.nf.CanvasUtils)}}}(this,function(j,g,h,i,c,l,o,n,k,f){var b={urls:{uiExtensionToken:"../nifi-api/access/ui-extension-token",downloadToken:"../nifi-api/access/download-token"}};var m=function(){j("#listing-request-status-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Queue Listing",handler:{close:function(){j("#listing-request-status-dialog").modal("setButtonModel",[])}}})};var e=function(){var r=j("#flowfile-uri").text()+"/content";h.getAccessToken(b.urls.downloadToken).done(function(t){var u={};if(!h.isBlank(t)){u.access_token=t}var s=j("#flowfile-cluster-node-id").text();if(!h.isBlank(s)){u.clusterNodeId=s}if(j.isEmptyObject(u)){window.open(r)}else{window.open(r+"?"+j.param(u))}}).fail(function(){i.showOkDialog({headerText:"Queue Listing",dialogContent:"Unable to generate access token for downloading content."})})};var p=function(){var r=j("#flowfile-uri").text()+"/content";var s=j.Deferred(function(t){if(k.hasItem("jwt")){var v=j.ajax({type:"POST",url:b.urls.uiExtensionToken});var u=j.ajax({type:"POST",url:b.urls.downloadToken});j.when(v,u).done(function(z,y){var x=z[0];var w=y[0];t.resolve(x,w)}).fail(function(){i.showOkDialog({headerText:"Queue Listing",dialogContent:"Unable to generate access token for viewing content."});t.reject()})}else{t.resolve("","")}}).promise();s.done(function(v,u){var x={};var t=j("#flowfile-cluster-node-id").text();if(!h.isBlank(t)){x.clusterNodeId=t}if(!h.isBlank(u)){x.access_token=u}if(j.isEmptyObject(x)===false){r=r+"?"+j.param(x)}var w=j("#nifi-content-viewer-url").text();if(w.indexOf("?")===-1){w+="?"}else{w+="&"}var y={ref:r};if(!h.isBlank(v)){y.access_token=v}window.open(w+j.param(y))})};var d=function(s){var t=4;var v=false;var u=null;var r=null;return j.Deferred(function(x){var A=function(C){var D=j("#listing-request-percent-complete");D.find("div.progress-label").remove();D.find("md-progress-linear").remove();var B=j('<div class="progress-label"></div>').text(C+"%");(l.injector.get("$compile")(j('<md-progress-linear ng-cloak ng-value="'+C+'" class="md-hue-2" md-mode="determinate" aria-label="Searching Queue"></md-progress-linear>'))(l.rootScope)).appendTo(D);D.append(B)};j("#listing-request-status-dialog").modal("setButtonModel",[{headerText:"Queue Listing",buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){v=true;if(r!==null){clearTimeout(r);w()}}}}]);var w=function(){j("#listing-request-status-dialog").modal("hide");var D=v;if(h.isDefinedAndNotNull(u)){j.ajax({type:"DELETE",url:u.uri,dataType:"json"});if(h.isEmpty(u.flowFileSummaries)){if(v===false){D=true;i.showOkDialog({headerText:"Queue Listing",dialogContent:"The queue has no FlowFiles."})}}else{j("#total-flowfiles-count").text(h.formatInteger(u.queueSize.objectCount));j("#total-flowfiles-size").text(h.formatDataSize(u.queueSize.byteCount));j("#queue-listing-last-refreshed").text(u.lastUpdated);var C=j("#queue-listing-table");var F=j("#queue-listing-message");if(u.sourceRunning===true||u.destinationRunning===true){if(u.souceRunning===true&&u.destinationRunning===true){F.text("The source and destination of this queue are currently running. This listing may no longer be accurate.").show()}else{if(u.sourceRunning===true){F.text("The source of this queue is currently running. This listing may no longer be accurate.").show()}else{if(u.destinationRunning===true){F.text("The destination of this queue is currently running. This listing may no longer be accurate.").show()}}}}else{F.text("").hide()}var E=j("#queue-listing-table").data("gridInstance");var B=E.getData();B.beginUpdate();B.setItems(u.flowFileSummaries,"uuid");B.endUpdate()}}else{D=true}if(D){x.reject()}else{x.resolve()}};var z=function(B){A(u.percentCompleted);j("#listing-request-status-message").text(u.state);if(u.finished===true||v===true){w()}else{r=setTimeout(function(){r=null;y(Math.min(t,B*2))},B*1000)}};var y=function(B){j.ajax({type:"GET",url:u.uri,dataType:"json"}).done(function(C){u=C.listingRequest;z(B)}).fail(w).fail(n.handleAjaxError)};j.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+s.id+"/listing-requests",dataType:"json",contentType:"application/json"}).done(function(B){A(0);j("#listing-request-status-dialog").modal("show");u=B.listingRequest;z(1)}).fail(w).fail(n.handleAjaxError)}).promise()};var a=function(r){var s=function(v,w){j('<div class="flowfile-detail"></div>').append(j('<div class="detail-name"></div>').text(v)).append(j('<div class="detail-value">'+h.formatValue(w)+"</div>").ellipsis()).append(j('<div class="clear"></div>')).appendTo("#additional-flowfile-details")};var t=function(v,w){if(h.isDefinedAndNotNull(w)){v.removeClass("unset").text(w)}else{v.addClass("unset").text("No value set")}};var u={};if(h.isDefinedAndNotNull(r.clusterNodeId)){u.clusterNodeId=r.clusterNodeId}j.ajax({type:"GET",url:r.uri,data:u,dataType:"json"}).done(function(v){var x=v.flowFile;j("#flowfile-uri").text(x.uri);j("#flowfile-uuid").html(h.formatValue(x.uuid));j("#flowfile-filename").html(h.formatValue(x.filename));j("#flowfile-queue-position").html(h.formatValue(x.position));j("#flowfile-file-size").html(h.formatValue(x.contentClaimFileSize));j("#flowfile-queued-duration").text(h.formatDuration(x.queuedDuration));j("#flowfile-lineage-duration").text(h.formatDuration(x.lineageDuration));j("#flowfile-penalized").text(x.penalized===true?"Yes":"No");if(h.isDefinedAndNotNull(r.clusterNodeId)){j("#flowfile-cluster-node-id").text(r.clusterNodeId);s("Node Address",r.clusterNodeAddress)}if(h.isDefinedAndNotNull(x.contentClaimContainer)){t(j("#content-container"),x.contentClaimContainer);t(j("#content-section"),x.contentClaimSection);t(j("#content-identifier"),x.contentClaimIdentifier);t(j("#content-offset"),x.contentClaimOffset);t(j("#content-bytes"),x.contentClaimFileSizeBytes);var z=j("#content-size");t(z,x.contentClaimFileSize);if(h.isDefinedAndNotNull(x.contentClaimFileSize)){z.attr("title",h.formatInteger(x.contentClaimFileSizeBytes)+" bytes")}j("#flowfile-content-details").show()}else{j("#flowfile-content-details").hide()}var w=j("#flowfile-attributes-container");var y=Object.keys(x.attributes).sort();y.forEach(function(A){var B=x.attributes[A];var C=j('<div class="attribute-detail"></div>').append(j('<div class="attribute-name">'+h.formatValue(A)+"</div>").ellipsis()).appendTo(w);C.append(j('<div class="attribute-value">'+h.formatValue(B)+"</div>").ellipsis()).append('<div class="clear"></div>')});j("#flowfile-details-dialog").modal("show")}).fail(n.handleAjaxError)};var q={init:function(){m();j("#queue-listing-refresh-button").click(function(){var A=j("#queue-listing-table").data("connection");d(A)});var z=function(E,B,D,C,A){return'<div class="pointer show-flowfile-details fa fa-info-circle" title="View Details" style="margin-top: 5px; float: left;"></div>'};var t=function(E,B,D,C,A){return h.formatDataSize(D)};var r=function(E,B,D,C,A){return h.formatDuration(D)};var v=function(F,B,E,D,A){var C="";if(E===true){C+="Yes"}return C};var w=[{id:"moreDetails",field:"moreDetails",name:"&nbsp;",sortable:false,resizable:false,formatter:z,width:50,maxWidth:50},{id:"position",name:"Position",field:"position",sortable:false,resizable:false,width:75,maxWidth:75,formatter:h.genericValueFormatter},{id:"uuid",name:"UUID",field:"uuid",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"filename",name:"Filename",field:"filename",sortable:false,resizable:true,formatter:h.genericValueFormatter},{id:"size",name:"File Size",field:"size",sortable:false,resizable:true,defaultSortAsc:false,formatter:t},{id:"queuedDuration",name:"Queued Duration",field:"queuedDuration",sortable:false,resizable:true,formatter:r},{id:"lineageDuration",name:"Lineage Duration",field:"lineageDuration",sortable:false,resizable:true,formatter:r},{id:"penalized",name:"Penalized",field:"penalized",sortable:false,resizable:false,width:100,maxWidth:100,formatter:v}];if(o.isClustered()){w.push({id:"clusterNodeAddress",name:"Node",field:"clusterNodeAddress",sortable:false,resizable:true,formatter:h.genericValueFormatter})}if(h.canAccessProvenance()){var y=function(){return'<div title="Provenance" class="pointer icon icon-provenance view-provenance"></div>'};w.push({id:"actions",name:"&nbsp;",resizable:false,formatter:y,sortable:false,width:50,maxWidth:50})}var u={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:false,enableColumnReorder:false,autoEdit:false,rowHeight:24};var s=new g.Data.DataView({inlineFilters:false});s.setItems([]);var x=new g.Grid("#queue-listing-table",s,w,u);x.setSelectionModel(new g.RowSelectionModel());x.registerPlugin(new g.AutoTooltips());x.onClick.subscribe(function(D,A){var C=j(D.target);var B=s.getItem(A.row);if(x.getColumns()[A.cell].id==="moreDetails"){if(C.hasClass("show-flowfile-details")){a(B)}}else{if(x.getColumns()[A.cell].id==="actions"){if(C.hasClass("view-provenance")){j("#shell-close-button").click();c.showPage("provenance?"+j.param({flowFileUuid:B.uuid}))}}}});s.onRowCountChanged.subscribe(function(B,A){x.updateRowCount();x.render();j("#displayed-flowfiles").text(A.current)});s.onRowsChanged.subscribe(function(B,A){x.invalidateRows(A.rows);x.render()});j("#queue-listing-table").data("gridInstance",x);j("#displayed-flowfiles").text("0")},initFlowFileDetailsDialog:function(){j("#content-download").on("click",e);if(h.isContentViewConfigured()){j("#content-view").show();j("#content-view").on("click",p)}j("#flowfile-details-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Details",tabContentId:"flowfile-details-tab-content"},{name:"Attributes",tabContentId:"flowfile-attributes-tab-content"}]});j("#flowfile-details-dialog").modal({scrollableContentStyle:"scrollable",headerText:"FlowFile",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){j("#flowfile-details-dialog").modal("hide")}}}],handler:{close:function(){j("#flowfile-attributes-container").empty();j("#flowfile-cluster-node-id").text("");j("#additional-flowfile-details").empty()},open:function(){h.toggleScrollable(j("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}})},resetTableSize:function(){var r=j("#queue-listing-table").data("gridInstance");if(h.isDefinedAndNotNull(r)){r.resizeCanvas()}},listQueue:function(r){d(r).done(function(){var s="";if(r.permissions.canRead){s=f.formatConnectionName(r.component)}if(s===""){s="Connection"}j("#queue-listing-header-text").text(s);c.showContent("#queue-listing-container").done(function(){j("#queue-listing-table").removeData("connection");var u=j("#queue-listing-table").data("gridInstance");var t=u.getData();t.beginUpdate();t.setItems([],"uuid");t.endUpdate();j("#displayed-flowfiles, #total-flowfiles-count").text("0");j("#total-flowfiles-size").text(h.formatDataSize(0))});q.resetTableSize();j("#queue-listing-table").data("connection",r)})}};return q}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.ErrorHandler","nf.Common","nf.Client","nf.CanvasUtils","nf.ng.Bridge","nf.Dialog","nf.Shell"],function(h,d,j,e,k,f,i,g,c){return(nf.PolicyManagement=b(h,d,j,e,k,f,i,g,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.PolicyManagement=b(require("jquery"),require("Slick"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Client"),require("nf.CanvasUtils"),require("nf.ng.Bridge"),require("nf.Dialog"),require("nf.Shell")))}else{nf.PolicyManagement=b(a.$,a.Slick,a.nf.ErrorHandler,a.nf.Common,a.nf.Client,a.nf.CanvasUtils,a.nf.ng.Bridge,a.nf.Dialog,a.nf.Shell)}}}(this,function(w,a,e,F,g,I,o,h,E){var A={urls:{api:"../nifi-api",searchTenants:"../nifi-api/tenants/search-results"}};var i=false;var s=function(){w("#new-policy-user-button").on("click",function(){w("#search-users-dialog").modal("show");w("#search-users-field").focus()});w("#delete-policy-button").on("click",function(){v()});w("#search-users-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Users/Groups",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var L=w("#policy-table").data("gridInstance");var K=L.getData();K.beginUpdate();w.each(f(w("#allowed-users")),function(N,M){K.addItem(M)});w.each(f(w("#allowed-groups")),function(M,N){K.addItem(N)});K.endUpdate();G();w("#search-users-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){w("#search-users-dialog").modal("hide")}}}],handler:{close:function(){w("#search-users-field").userSearchAutocomplete("reset").val("");w("#allowed-users, #allowed-groups").empty()}}});w(document).on("click","div.remove-allowed-entity",function(){w(this).closest("li").remove()});w.widget("nf.userSearchAutocomplete",w.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-no-matches)")},_normalize:function(L){var K=[];K.push(L);return K},_renderMenu:function(N,L){var P=L[0];var M=H();var O=n();var K=this;w.each(P.userGroups,function(Q,R){if(w.inArray(R.id,M)===-1){K._renderGroup(N,w.extend({type:"group"},R))}});w.each(P.users,function(Q,R){if(w.inArray(R.id,O)===-1){K._renderUser(N,w.extend({type:"user"},R))}});if(N.children().length===0){N.append('<li class="unset search-no-matches">No users matched the search terms</li>')}},_resizeMenu:function(){var K=this.menu.element;K.width(w("#search-users-field").outerWidth()-2)},_renderUser:function(M,L){var K=w("<a></a>").text(L.component.identity);return w("<li></li>").data("ui-autocomplete-item",L).append(K).appendTo(M)},_renderGroup:function(L,K){var N=w("<span></span>").text(K.component.identity);var M=w("<a></a>").append('<div class="fa fa-users" style="margin-right: 5px;"></div>').append(N);return w("<li></li>").data("ui-autocomplete-item",K).append(M).appendTo(L)}});w("#search-users-field").userSearchAutocomplete({minLength:0,appendTo:"#search-users-results",position:{my:"left top",at:"left bottom",offset:"0 1"},source:function(L,K){w.ajax({type:"GET",data:{q:L.term},dataType:"json",url:A.urls.searchTenants}).done(function(M){K(M)})},select:function(K,L){x(L.item);w(this).val("");return false}})};var H=function(){var N=w("#policy-table").data("gridInstance");var M=N.getData();var L=[];var K=M.getItems();w.each(K,function(O,P){if(P.type==="group"){L.push(P.id)}});w.each(f(w("#allowed-groups")),function(O,P){L.push(P.id)});return L};var f=function(K){var L=[];K.children("li").each(function(N,M){var O=w(M).data("tenant");if(F.isDefinedAndNotNull(O)){L.push(O)}});return L};var n=function(){var N=w("#policy-table").data("gridInstance");var L=N.getData();var M=[];var K=L.getItems();w.each(K,function(O,P){if(P.type==="user"){M.push(P.id)}});w.each(f(w("#allowed-users")),function(P,O){M.push(O.id)});return M};var x=function(K){var M=K.type==="user"?w("#allowed-users"):w("#allowed-groups");var N=w("<span></span>").addClass("allowed-entity ellipsis").text(K.component.identity).ellipsis();var L=w("<div></div>").addClass("remove-allowed-entity fa fa-trash");w("<li></li>").data("tenant",K).append(N).append(L).appendTo(M)};var c=function(K){return K==="controller"||K==="counters"||K==="policies"||K==="tenants"};var l=function(K){return K==="proxy"||K==="restricted-components"};var y=function(){w("#override-policy-dialog").modal({headerText:"Override Policy",buttons:[{buttonText:"Override",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){j(w("#copy-policy-radio-button").is(":checked"));w(this).modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){w(this).modal("hide")}}}],handler:{close:function(){w("#copy-policy-radio-button").prop("checked",true)}}});w("#create-policy-link, #add-local-admin-link").on("click",function(){j(false)});w("#override-policy-link").on("click",function(){w("#override-policy-dialog").modal("show")});w("#policy-type-list").combo({options:[F.getPolicyTypeListing("flow"),F.getPolicyTypeListing("controller"),F.getPolicyTypeListing("provenance"),F.getPolicyTypeListing("restricted-components"),F.getPolicyTypeListing("policies"),F.getPolicyTypeListing("tenants"),F.getPolicyTypeListing("site-to-site"),F.getPolicyTypeListing("system"),F.getPolicyTypeListing("proxy"),F.getPolicyTypeListing("counters")],select:function(Q){if(i){w("#selected-policy-type").text(Q.value);if(c(Q.value)){w("#controller-policy-target").combo("setSelectedOption",{value:"read"}).show()}else{w("#controller-policy-target").hide();if(l(Q.value)){w("#selected-policy-action").text("write")}else{w("#selected-policy-action").text("read")}b()}}}});w("#controller-policy-target").combo({options:[{text:"view",value:"read"},{text:"modify",value:"write"}],select:function(Q){if(i){w("#selected-policy-action").text(Q.value);b()}}});w("#component-policy-target").combo({options:[{text:"view the component",value:"read-component",description:"Allows users to view component configuration details"},{text:"modify the component",value:"write-component",description:"Allows users to modify component configuration details"},{text:"view the data",value:"read-data",description:"Allows users to view metadata and content for this component through provenance data and flowfile queues in outbound connections"},{text:"modify the data",value:"write-data",description:"Allows users to empty flowfile queues in outbound connections and submit replays"},{text:"receive data via site-to-site",value:"write-receive-data",description:"Allows this port to receive data from these NiFi instances",disabled:true},{text:"send data via site-to-site",value:"write-send-data",description:"Allows this port to send data to these NiFi instances",disabled:true},{text:"view the policies",value:"read-policies",description:"Allows users to view the list of users who can view/modify this component"},{text:"modify the policies",value:"write-policies",description:"Allows users to modify the list of users who can view/modify this component"}],select:function(Q){if(i){var R=w("#selected-policy-component-type").text();if(Q.value==="read-component"){w("#selected-policy-action").text("read")}else{if(Q.value==="write-component"){w("#selected-policy-action").text("write")}else{if(Q.value==="read-data"){w("#selected-policy-action").text("read");R=("data/"+R)}else{if(Q.value==="write-data"){w("#selected-policy-action").text("write");R=("data/"+R)}else{if(Q.value==="read-policies"){w("#selected-policy-action").text("read");R=("policies/"+R)}else{if(Q.value==="write-policies"){w("#selected-policy-action").text("write");R=("policies/"+R)}else{if(Q.value==="write-receive-data"){w("#selected-policy-action").text("write");R="data-transfer/input-ports"}else{if(Q.value==="write-send-data"){w("#selected-policy-action").text("write");R="data-transfer/output-ports"}}}}}}}}w("#selected-policy-type").text(R);b()}}});var K=function(V,R,U,T,Q){var S="";if(Q.type==="group"){S+='<div class="fa fa-users" style="margin-right: 5px;"></div>'}S+=F.escapeHtml(Q.component.identity);return S};var O=function(X,S,W,U,R){var T="";var Q=w("#policy-table").data("policy");var V=w("#delete-policy-button").is(":disabled")===false;if(Q.permissions.canWrite===true&&V){T+='<div title="Remove" class="pointer delete-user fa fa-trash"></div>'}return T};var N=[{id:"identity",name:"User",sortable:true,resizable:true,formatter:K},{id:"actions",name:"&nbsp;",sortable:false,resizable:false,formatter:O,width:100,maxWidth:100}];var M={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false};var L=new a.Data.DataView({inlineFilters:false});L.setItems([]);J({columnId:"identity",sortAsc:true},L);var P=new a.Grid("#policy-table",L,N,M);P.setSelectionModel(new a.RowSelectionModel());P.registerPlugin(new a.AutoTooltips());P.setSortColumn("identity",true);P.onSort.subscribe(function(R,Q){J({columnId:Q.sortCol.id,sortAsc:Q.sortAsc},L)});P.onClick.subscribe(function(T,Q){var S=w(T.target);var R=L.getItem(Q.row);if(P.getColumns()[Q.cell].id==="actions"){if(S.hasClass("delete-user")){D(R)}}});L.onRowCountChanged.subscribe(function(R,Q){P.updateRowCount();P.render();w("#displayed-policy-users").text(Q.current)});L.onRowsChanged.subscribe(function(R,Q){P.invalidateRows(Q.rows);P.render()});w("#policy-table").data("gridInstance",P);w("#displayed-policy-users").text("0")};var J=function(K,M){var L=function(P,N){if(P.permissions.canRead&&N.permissions.canRead){var O=F.isDefinedAndNotNull(P.component[K.columnId])?P.component[K.columnId]:"";var Q=F.isDefinedAndNotNull(N.component[K.columnId])?N.component[K.columnId]:"";return O===Q?0:O>Q?1:-1}else{if(!P.permissions.canRead&&!N.permissions.canRead){return 0}if(P.permissions.canRead){return 1}else{return -1}}};M.sort(L,K.sortAsc)};var D=function(K){h.showYesNoDialog({headerText:"Update Policy",dialogContent:"Remove '"+F.escapeHtml(K.component.identity)+"' from this policy?",yesHandler:function(){p(K)}})};var p=function(L){var M=w("#policy-table").data("gridInstance");var K=M.getData();K.beginUpdate();K.deleteItem(L.id);K.endUpdate();G()};var v=function(){h.showYesNoDialog({headerText:"Delete Policy",dialogContent:"By deleting this policy, the permissions for this component will revert to the inherited policy if applicable.",yesText:"Delete",noText:"Cancel",yesHandler:function(){k()}})};var k=function(){var K=w("#policy-table").data("policy");if(F.isDefinedAndNotNull(K)){w.ajax({type:"DELETE",url:K.uri+"?"+w.param(g.getRevision(K)),dataType:"json"}).done(function(){b()}).fail(function(N,L,M){e.handleAjaxError(N,L,M);r();b()})}else{h.showOkDialog({headerText:"Delete Policy",dialogContent:"No policy selected"})}};var m=function(){var K=w("#selected-policy-component-id").text();var L=w("#selected-policy-type").text();if(K!==""){L+=("/"+K)}return{action:w("#selected-policy-action").text(),resource:"/"+L}};var B=function(O,M){var N=w("#policy-table").data("gridInstance");var L=N.getData();L.beginUpdate();var K=[];w.each(O,function(Q,P){K.push(w.extend({type:"user"},P))});w.each(M,function(P,Q){K.push(w.extend({type:"group"},Q))});L.setItems(K);L.endUpdate();L.reSort();N.invalidate();N.getSelectionModel().setSelectedRows([])};var q=function(N){if(N==="/policies"){return w("<span>Showing effective policy inherited from all policies.</span>")}else{if(N==="/controller"){return w("<span>Showing effective policy inherited from the controller.</span>")}else{var K=F.substringAfterLast(N,"/");var M=K;var L=o.injector.get("breadcrumbsCtrl").getBreadcrumbs();w.each(L,function(O,P){if(P.id===K){M=P.label;return false}});return w("<span>Showing effective policy inherited from Process Group </span>").append(w('<span class="link ellipsis" style="max-width: 200px; vertical-align: top;"></span>').text(M).attr("title",M).on("click",function(){w("#shell-close-button").click();I.getComponentByType("ProcessGroup").enterGroup(K).done(function(){I.getSelection().classed("selected",false);o.digest()})})).append("<span>.</span>")}}};var t=function(L){var M=L.component;var K=m();d();w("#policy-table").data("policy",L);if(K.resource===M.resource){w("#delete-policy-button").prop("disabled",L.permissions.canWrite===false);w("#new-policy-user-button").prop("disabled",L.permissions.canWrite===false)}else{w("#policy-message").append(q(M.resource));w("#override-policy-message").show();w("#delete-policy-button").prop("disabled",true);w("#new-policy-user-button").prop("disabled",true)}B(M.users,M.userGroups)};var b=function(){var K=m();var L;if(K.resource.startsWith("/policies")){w("#admin-policy-message").show();L=w.Deferred(function(M){w.ajax({type:"GET",url:"../nifi-api/policies/"+K.action+K.resource,dataType:"json"}).done(function(N){w("#policy-last-refreshed").text(N.generated);if(N.permissions.canRead===true){var O=N.component;if(K.resource===O.resource){t(N)}else{r();w("#policy-message").text("No component specific administrators.");w("#add-local-admin-message").show()}}else{r();w("#policy-message").text("No component specific administrators.");w("#add-local-admin-message").show()}M.resolve()}).fail(function(P,N,O){if(P.status===404){r();w("#policy-message").text("No component specific administrators.");w("#add-local-admin-message").show();M.resolve()}else{if(P.status===403){r();w("#policy-message").text("Not authorized to access the policy for the specified resource.");M.resolve()}else{r();M.reject();e.handleAjaxError(P,N,O)}}})}).promise()}else{w("#admin-policy-message").hide();L=w.Deferred(function(M){w.ajax({type:"GET",url:"../nifi-api/policies/"+K.action+K.resource,dataType:"json"}).done(function(N){w("#policy-last-refreshed").text(N.generated);if(N.permissions.canRead===true){t(N)}else{r();w("#policy-message").text("Not authorized to view the policy.");w("#override-policy-message").show()}M.resolve()}).fail(function(P,N,O){if(P.status===404){r();w("#policy-message").text("No policy for the specified resource.");w("#new-policy-message").show();M.resolve()}else{if(P.status===403){r();w("#policy-message").text("Not authorized to access the policy for the specified resource.");M.resolve()}else{r();M.reject();e.handleAjaxError(P,N,O)}}})}).promise()}return L};var j=function(P){var O=m();var R=[];var N=[];if(P===true){var Q=w("#policy-table").data("gridInstance");var M=Q.getData();var L=M.getItems();w.each(L,function(T,U){var S=w.extend({},U);if(S.type==="user"){R.push(S)}else{N.push(S)}delete S.type})}var K={revision:g.getRevision({revision:{version:0}}),component:{action:O.action,resource:O.resource,users:R,userGroups:N}};w.ajax({type:"POST",url:"../nifi-api/policies",data:JSON.stringify(K),dataType:"json",contentType:"application/json"}).done(function(S){if(S.permissions.canRead===true){t(S)}else{r();b()}}).fail(e.handleAjaxError)};var G=function(){var Q=w("#policy-table").data("gridInstance");var O=Q.getData();var P=[];var N=[];var M=O.getItems();w.each(M,function(S,T){var R=w.extend({},T);if(R.type==="user"){P.push(R)}else{N.push(R)}delete R.type});var K=w("#policy-table").data("policy");if(F.isDefinedAndNotNull(K)){var L={revision:g.getRevision(K),component:{id:K.id,users:P,userGroups:N}};w.ajax({type:"PUT",url:K.uri,data:JSON.stringify(L),dataType:"json",contentType:"application/json"}).done(function(R){if(R.permissions.canRead===true){t(R)}else{r();b()}}).fail(function(T,R,S){e.handleAjaxError(T,R,S);r();b()}).always(function(){I.reload({transition:true})})}else{h.showOkDialog({headerText:"Update Policy",dialogContent:"No policy selected"})}};var z=function(){E.showContent("#policy-management").always(function(){C()});u.resetTableSize()};var d=function(){w("#policy-message").text("").empty();w("#new-policy-message").hide();w("#override-policy-message").hide();w("#add-local-admin-message").hide()};var r=function(){d();w("#delete-policy-button").prop("disabled",true);w("#new-policy-user-button").prop("disabled",true);w("#policy-table").removeData("policy");B([],[])};var C=function(){r();w("#selected-policy-type").text("");w("#selected-policy-action").text("");w("#selected-policy-component-id").text("");w("#selected-policy-component-type").text("");w("div.policy-selected-component-container").hide()};var u={init:function(){s();y();w("#policy-refresh-button").on("click",function(){b()});r();i=true},resetTableSize:function(){var K=w("#policy-table");if(K.is(":visible")){var L=K.data("gridInstance");if(F.isDefinedAndNotNull(L)){L.resizeCanvas()}}},showControllerServicePolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();if(K.permissions.canRead===true){w("#policy-selected-controller-service-container div.policy-selected-component-name").text(K.component.name)}else{w("#policy-selected-controller-service-container div.policy-selected-component-name").text(K.id)}w("#policy-selected-controller-service-container").show();w("#selected-policy-component-id").text(K.id);w("#selected-policy-component-type").text("controller-services");w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(z)},showReportingTaskPolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();if(K.permissions.canRead===true){w("#policy-selected-reporting-task-container div.policy-selected-component-name").text(K.component.name)}else{w("#policy-selected-reporting-task-container div.policy-selected-component-name").text(K.id)}w("#policy-selected-reporting-task-container").show();w("#selected-policy-component-id").text(K.id);w("#selected-policy-component-type").text("reporting-tasks");w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(z)},showTemplatePolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();if(K.permissions.canRead===true){w("#policy-selected-template-container div.policy-selected-component-name").text(K.template.name)}else{w("#policy-selected-template-container div.policy-selected-component-name").text(K.id)}w("#policy-selected-template-container").show();w("#selected-policy-component-id").text(K.id);w("#selected-policy-component-type").text("templates");w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},false).combo("setOptionEnabled",{value:"write-data"},false).combo("setSelectedOption",{value:"read-component"});return b().always(z)},showComponentPolicy:function(K){d();w("#component-policy-controls").show();w("#global-policy-controls").hide();w("#policy-selected-component-container").show();var L;if(K.empty()){w("#selected-policy-component-id").text(I.getGroupId());L="process-groups";w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},false).combo("setOptionEnabled",{value:"write-send-data"},false).combo("setOptionEnabled",{value:"read-data"},true).combo("setOptionEnabled",{value:"write-data"},true)}else{var M=K.datum();w("#selected-policy-component-id").text(M.id);if(I.isProcessor(K)){L="processors"}else{if(I.isProcessGroup(K)){L="process-groups"}else{if(I.isInputPort(K)){L="input-ports"}else{if(I.isOutputPort(K)){L="output-ports"}else{if(I.isRemoteProcessGroup(K)){L="remote-process-groups"}else{if(I.isLabel(K)){L="labels"}else{if(I.isFunnel(K)){L="funnels"}}}}}}}w("#component-policy-target").combo("setOptionEnabled",{value:"write-receive-data"},I.isInputPort(K)&&I.getParentGroupId()===null).combo("setOptionEnabled",{value:"write-send-data"},I.isOutputPort(K)&&I.getParentGroupId()===null).combo("setOptionEnabled",{value:"read-data"},!I.isLabel(K)).combo("setOptionEnabled",{value:"write-data"},!I.isLabel(K))}w("#selected-policy-component-type").text(L);w("#component-policy-target").combo("setSelectedOption",{value:"read-component"});return b().always(z)},showGlobalPolicies:function(){d();w("#component-policy-controls").hide();w("#global-policy-controls").show();var K=w("#policy-type-list").combo("getSelectedOption").value;w("#selected-policy-type").text(K);if(c(K)){w("#selected-policy-action").text(w("#controller-policy-target").combo("getSelectedOption").value)}else{if(l(K)){w("#selected-policy-action").text("write")}else{w("#selected-policy-action").text("read")}}return b().always(z)}};return u}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.CanvasUtils","nf.Common","nf.Dialog","nf.Client","nf.ErrorHandler","nf.Clipboard","nf.Snippet","nf.GoTo","nf.ng.Bridge","nf.Shell","nf.ComponentState","nf.Draggable","nf.Birdseye","nf.Connection","nf.Graph","nf.ProcessGroupConfiguration","nf.ProcessorConfiguration","nf.ProcessorDetails","nf.LabelConfiguration","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupDetails","nf.PortConfiguration","nf.PortDetails","nf.ConnectionConfiguration","nf.ConnectionDetails","nf.PolicyManagement","nf.RemoteProcessGroup","nf.Label","nf.Processor","nf.RemoteProcessGroupPorts","nf.ComponentVersion","nf.QueueListing","nf.StatusHistory"],function(f,G,C,j,u,J,h,i,B,r,K,F,c,x,p,k,g,m,I,w,H,n,E,o,y,A,v,D,t,q,s,l,d,z,e){return(nf.Actions=b(f,G,C,j,u,J,h,i,B,r,K,F,c,x,p,k,g,m,I,w,H,n,E,o,y,A,v,D,t,q,s,l,d,z,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Actions=b(require("jquery"),require("d3"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ErrorHandler"),require("nf.Clipboard"),require("nf.Snippet"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.Shell"),require("nf.ComponentState"),require("nf.Draggable"),require("nf.Birdseye"),require("nf.Connection"),require("nf.Graph"),require("nf.ProcessGroupConfiguration"),require("nf.ProcessorConfiguration"),require("nf.ProcessorDetails"),require("nf.LabelConfiguration"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupDetails"),require("nf.PortConfiguration"),require("nf.PortDetails"),require("nf.ConnectionConfiguration"),require("nf.ConnectionDetails"),require("nf.PolicyManagement"),require("nf.RemoteProcessGroup"),require("nf.Label"),require("nf.Processor"),require("nf.RemoteProcessGroupPorts"),require("nf.ComponentVersion"),require("nf.QueueListing"),require("nf.StatusHistory")))}else{nf.Actions=b(a.$,a.d3,a.nf.CanvasUtils,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ErrorHandler,a.nf.Clipboard,a.nf.Snippet,a.nf.GoTo,a.nf.ng.Bridge,a.nf.Shell,a.nf.ComponentState,a.nf.Draggable,a.nf.Birdseye,a.nf.Connection,a.nf.Graph,a.nf.ProcessGroupConfiguration,a.nf.ProcessorConfiguration,a.nf.ProcessorDetails,a.nf.LabelConfiguration,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupDetails,a.nf.PortConfiguration,a.nf.PortDetails,a.nf.ConnectionConfiguration,a.nf.ConnectionDetails,a.nf.PolicyManagement,a.nf.RemoteProcessGroup,a.nf.Label,a.nf.Processor,a.nf.RemoteProcessGroupPorts,a.nf.ComponentVersion,a.nf.QueueListing,a.nf.StatusHistory)}}}(this,function(C,I,M,H,l,k,f,y,N,h,n,G,g,v,i,O,q,E,L,c,z,B,J,D,r,o,p,x,a,u,s,b,t,A,K){var F={urls:{api:"../nifi-api",controller:"../nifi-api/controller"}};var e=function(){C("#drop-request-status-dialog").modal({scrollableContentStyle:"scrollable",handler:{close:function(){C("#drop-request-status-dialog").modal("setButtonModel",[])}}})};var m=function(Q,P){return C.ajax({type:"PUT",url:Q,data:JSON.stringify(P),dataType:"json",contentType:"application/json"}).fail(function(T,R,S){l.showOkDialog({headerText:"Update Resource",dialogContent:H.escapeHtml(T.responseText)})})};var j=function(P){C.ajax({type:"GET",url:F.urls.api+"/flow/process-groups/"+encodeURIComponent(P.id),dataType:"json"}).done(function(Q){q.set(Q.processGroupFlow.flow)})};var d=function(P,Q){return Q.filter(function(R){return M.getConnectionSourceComponentId(P)===R.id}).size()>0};var w={init:function(){e()},enterGroup:function(P){if(P.size()===1&&M.isProcessGroup(P)){var Q=P.datum();M.getComponentByType("ProcessGroup").enterGroup(Q.id)}},leaveGroup:function(){M.getComponentByType("ProcessGroup").enterGroup(M.getParentGroupId())},refreshRemoteFlow:function(Q){if(Q.size()===1&&M.isRemoteProcessGroup(Q)){var T=Q.datum();var U=T.component.flowRefreshed;var P=function(V){T.component.flowRefreshed=V;if(Q.classed("visible")){Q.select("text.remote-process-group-last-refresh").text(function(){return V})}};var S=function(V){C.ajax({type:"GET",url:T.uri,dataType:"json"}).done(function(W){var Y=W.component;if(U===Y.flowRefreshed){R(V)}else{a.set(W);var X=O.getComponentConnections(Y.id);C.each(X,function(aa,Z){if(Z.permissions.canRead){O.reload(Z.id)}})}})};var R=function(V){if(V<=32){setTimeout(function(){S(V*2)},V*1000)}else{P(U)}};P("Refreshing...");S(1)}},openUri:function(P){if(P.size()===1&&M.isRemoteProcessGroup(P)){var R=P.datum();var Q=R.component.targetUri;if(!H.isBlank(Q)){window.open(encodeURI(Q))}else{l.showOkDialog({headerText:"Remote Process Group",dialogContent:"No target URI defined."})}}},showSource:function(P){if(P.size()===1&&M.isConnection(P)){var R=P.datum();if(R.sourceGroupId===M.getGroupId()){var Q=I.select("#id-"+R.sourceId);w.show(Q)}else{if(R.sourceType==="REMOTE_OUTPUT_PORT"){var S=I.select("#id-"+R.sourceGroupId);w.show(S)}else{M.showComponent(R.sourceGroupId,R.sourceId)}}}},showDestination:function(R){if(R.size()===1&&M.isConnection(R)){var S=R.datum();if(S.destinationGroupId===M.getGroupId()){var P=I.select("#id-"+S.destinationId);w.show(P)}else{if(S.destinationType==="REMOTE_INPUT_PORT"){var Q=I.select("#id-"+S.destinationGroupId);w.show(Q)}else{M.showComponent(S.destinationGroupId,S.destinationId)}}}},showDownstream:function(P){if(P.size()===1&&!M.isConnection(P)){if(M.isProcessor(P)){h.showDownstreamFromProcessor(P)}else{if(M.isFunnel(P)){h.showDownstreamFromFunnel(P)}else{if(M.isInputPort(P)){h.showDownstreamFromInputPort(P)}else{if(M.isOutputPort(P)){h.showDownstreamFromOutputPort(P)}else{if(M.isProcessGroup(P)||M.isRemoteProcessGroup(P)){h.showDownstreamFromGroup(P)}}}}}}},showUpstream:function(P){if(P.size()===1&&!M.isConnection(P)){if(M.isProcessor(P)){h.showUpstreamFromProcessor(P)}else{if(M.isFunnel(P)){h.showUpstreamFromFunnel(P)}else{if(M.isInputPort(P)){h.showUpstreamFromInputPort(P)}else{if(M.isOutputPort(P)){h.showUpstreamFromOutputPort(P)}else{if(M.isProcessGroup(P)||M.isRemoteProcessGroup(P)){h.showUpstreamFromGroup(P)}}}}}}},show:function(P){var Q=M.getSelection();Q.classed("selected",false);P.classed("selected",true);if(P.size()===1){w.center(P)}else{n.injector.get("navigateCtrl").zoomFit()}M.setURLParameters(M.getGroupId(),P);n.digest()},select:function(P){P.classed("selected",true)},selectAll:function(){w.select(I.selectAll("g.component, g.connection"))},center:function(R){if(R.size()===1){var S;if(M.isConnection(R)){var P,W;var V=R.datum();if(V.bends.length>0){var Q=Math.min(Math.max(0,V.labelIndex),V.bends.length-1);P=V.bends[Q].x;W=V.bends[Q].y}else{P=(V.start.x+V.end.x)/2;W=(V.start.y+V.end.y)/2}S={x:P,y:W,width:1,height:1}}else{var T=R.datum();var U=T.position;S={x:U.x,y:U.y,width:T.dimensions.width,height:T.dimensions.height}}M.centerBoundingBox(S);M.refreshCanvasView({transition:true})}},enable:function(P){var R=M.filterEnable(P);if(R.empty()){l.showOkDialog({headerText:"Enable Components",dialogContent:"No eligible components are selected. Please select the components to be enabled and ensure they are no longer running."})}else{var Q=[];R.each(function(U){var T=I.select(this);var S={revision:k.getRevision(U),component:{id:U.id,state:"STOPPED"}};Q.push(m(U.uri,S).done(function(V){M.getComponentByType(U.type).set(V)}))});if(Q.length>0){C.when.apply(window,Q).always(function(){n.digest()})}}},disable:function(Q){var P=M.filterDisable(Q);if(P.empty()){l.showOkDialog({headerText:"Disable Components",dialogContent:"No eligible components are selected. Please select the components to be disabled and ensure they are no longer running."})}else{var R=[];P.each(function(U){var T=I.select(this);var S={revision:k.getRevision(U),component:{id:U.id,state:"DISABLED"}};R.push(m(U.uri,S).done(function(V){M.getComponentByType(U.type).set(V)}))});if(R.length>0){C.when.apply(window,R).always(function(){n.digest()})}}},openProvenance:function(P){if(P.size()===1){var Q=P.datum();G.showPage("provenance?"+C.param({componentId:Q.id}))}},start:function(R){if(R.empty()){var P={id:M.getGroupId(),state:"RUNNING"};m(F.urls.api+"/flow/process-groups/"+encodeURIComponent(M.getGroupId()),P).done(j)}else{var S=R.filter(function(T){return M.isRunnable(I.select(this))});if(S.empty()){l.showOkDialog({headerText:"Start Components",dialogContent:"No eligible components are selected. Please select the components to be started and ensure they are no longer running."})}else{var Q=[];S.each(function(W){var U=I.select(this);var V,T;if(M.isProcessGroup(U)){V=F.urls.api+"/flow/process-groups/"+encodeURIComponent(W.id);T={id:W.id,state:"RUNNING"}}else{V=W.uri;T={revision:k.getRevision(W),component:{id:W.id,state:"RUNNING"}}}Q.push(m(V,T).done(function(X){if(M.isProcessGroup(U)){M.getComponentByType("ProcessGroup").reload(W.id)}else{M.getComponentByType(W.type).set(X)}}))});if(Q.length>0){C.when.apply(window,Q).always(function(){n.digest()})}}}},stop:function(Q){if(Q.empty()){var P={id:M.getGroupId(),state:"STOPPED"};m(F.urls.api+"/flow/process-groups/"+encodeURIComponent(M.getGroupId()),P).done(j)}else{var S=Q.filter(function(T){return M.isStoppable(I.select(this))});if(S.empty()){l.showOkDialog({headerText:"Stop Components",dialogContent:"No eligible components are selected. Please select the components to be stopped."})}else{var R=[];S.each(function(W){var U=I.select(this);var V,T;if(M.isProcessGroup(U)){V=F.urls.api+"/flow/process-groups/"+encodeURIComponent(W.id);T={id:W.id,state:"STOPPED"}}else{V=W.uri;T={revision:k.getRevision(W),component:{id:W.id,state:"STOPPED"}}}R.push(m(V,T).done(function(X){if(M.isProcessGroup(U)){M.getComponentByType("ProcessGroup").reload(W.id)}else{M.getComponentByType(W.type).set(X)}}))});if(R.length>0){C.when.apply(window,R).always(function(){n.digest()})}}}},enableTransmission:function(P){var Q=P.filter(function(R){return M.canStartTransmitting(I.select(this))});Q.each(function(S){var R={revision:k.getRevision(S),component:{id:S.id,transmitting:true}};m(S.uri,R).done(function(T){a.set(T)})})},disableTransmission:function(Q){var P=Q.filter(function(R){return M.canStopTransmitting(I.select(this))});P.each(function(S){var R={revision:k.getRevision(S),component:{id:S.id,transmitting:false}};m(S.uri,R).done(function(T){a.set(T)})})},showConfiguration:function(P){if(P.empty()){E.showConfiguration(M.getGroupId())}else{if(P.size()===1){var Q=P.datum();if(M.isProcessor(P)){L.showConfiguration(P)}else{if(M.isLabel(P)){z.showConfiguration(P)}else{if(M.isProcessGroup(P)){E.showConfiguration(Q.id)}else{if(M.isRemoteProcessGroup(P)){B.showConfiguration(P)}else{if(M.isInputPort(P)||M.isOutputPort(P)){D.showConfiguration(P)}else{if(M.isConnection(P)){o.showConfiguration(P)}}}}}}}}},managePolicies:function(P){if(P.size()<=1){x.showComponentPolicy(P)}},showDetails:function(P){if(P.empty()){E.showConfiguration(M.getGroupId())}else{if(P.size()===1){var Q=P.datum();if(M.isProcessor(P)){c.showDetails(M.getGroupId(),Q.id)}else{if(M.isProcessGroup(P)){E.showConfiguration(Q.id)}else{if(M.isRemoteProcessGroup(P)){J.showDetails(P)}else{if(M.isInputPort(P)||M.isOutputPort(P)){r.showDetails(P)}else{if(M.isConnection(P)){p.showDetails(M.getGroupId(),Q.id)}}}}}}}},showUsage:function(P){if(P.size()===1&&M.isProcessor(P)){var Q=P.datum();G.showPage("../nifi-docs/documentation?"+C.param({select:Q.component.type,group:Q.component.bundle.group,artifact:Q.component.bundle.artifact,version:Q.component.bundle.version}))}},showStats:function(P){if(P.size()===1){var Q=P.datum();if(M.isProcessor(P)){K.showProcessorChart(M.getGroupId(),Q.id)}else{if(M.isProcessGroup(P)){K.showProcessGroupChart(M.getGroupId(),Q.id)}else{if(M.isRemoteProcessGroup(P)){K.showRemoteProcessGroupChart(M.getGroupId(),Q.id)}else{if(M.isConnection(P)){K.showConnectionChart(M.getGroupId(),Q.id)}}}}}},remotePorts:function(P){if(P.size()===1&&M.isRemoteProcessGroup(P)){b.showPorts(P)}},reload:function(){M.reload({transition:true})},"delete":function(R){if(H.isUndefined(R)||R.empty()){l.showOkDialog({headerText:"Reload",dialogContent:"No eligible components are selected. Please select the components to be deleted."})}else{if(R.size()===1){var T=R.datum();var Q=k.getRevision(T);C.ajax({type:"DELETE",url:T.uri+"?"+C.param({version:Q.version,clientId:Q.clientId}),dataType:"json"}).done(function(U){M.getComponentByType(T.type).remove(T.id);if(M.isConnection(R)===false){var V=O.getComponentConnections(T.id);if(V.length>0){var W=[];C.each(V,function(Y,X){W.push(X.id)});O.remove(W)}}M.setURLParameters();i.refresh();n.digest()}).fail(f.handleAjaxError)}else{var P=M.getGroupId();var S=N.marshal(R,P);N.create(S).done(function(U){N.remove(U.snippet.id).done(function(){var W=I.map();var V=function(X,Y){if(!W.has(X)){W.set(X,[])}W.get(X).push(Y)};R.each(function(Y){V(Y.type,Y.id);if(Y.type!=="Connection"){var X=O.getComponentConnections(Y.id);if(X.length>0){C.each(X,function(aa,Z){V("Connection",Z.id)})}}});W.forEach(function(Y,X){if(Y!=="Connection"){M.getComponentByType(Y).remove(X)}});if(W.has("Connection")){O.remove(W.get("Connection"))}M.setURLParameters();i.refresh();n.digest()}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},emptyQueue:function(P){if(P.size()!==1||!M.isConnection(P)){return}l.showYesNoDialog({headerText:"Empty Queue",dialogContent:"Are you sure you want to empty this queue? All FlowFiles waiting at the time of the request will be removed.",noText:"Cancel",yesText:"Empty",yesHandler:function(){var T=P.datum();var X=4;var V=false;var W=null;var S=null;var R=function(aa){var ab=C("#drop-request-percent-complete");ab.find("div.progress-label").remove();ab.find("md-progress-linear").remove();var Z=C('<div class="progress-label"></div>').text(aa+"%");(n.injector.get("$compile")(C('<md-progress-linear ng-cloak ng-value="'+aa+'" class="md-hue-2" md-mode="determinate" aria-label="Drop request percent complete"></md-progress-linear>'))(n.rootScope)).appendTo(ab);ab.append(Z)};C("#drop-request-status-dialog").modal("setButtonModel",[{buttonText:"Stop",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){V=true;if(S!==null){clearTimeout(S);Q()}}}}]);var Q=function(){O.reloadStatus(T.id);if(H.isDefinedAndNotNull(W)){C.ajax({type:"DELETE",url:W.uri,dataType:"json"}).done(function(Z){W=Z.dropRequest;var ac=W.dropped.split(/ \/ /);var ab=C("<div></div>");C('<span class="label"></span>').text(ac[0]).appendTo(ab);C("<span></span>").text(" FlowFiles ("+ac[1]+")").appendTo(ab);if(W.percentCompleted<100){var aa=W.original.split(/ \/ /);C('<span class="label"></span>').text(" out of "+aa[0]).appendTo(ab);C("<span></span>").text(" ("+aa[1]+")").appendTo(ab)}C("<span></span>").text(" were removed from the queue.").appendTo(ab);if(H.isDefinedAndNotNull(W.failureReason)){C("<br/><br/><span></span>").text(W.failureReason).appendTo(ab)}l.showOkDialog({headerText:"Empty Queue",dialogContent:ab})}).always(function(){C("#drop-request-status-dialog").modal("hide")})}else{l.showOkDialog({headerText:"Empty Queue",dialogContent:"No FlowFiles were removed."});C("#drop-request-status-dialog").modal("hide")}};var Y=function(Z){R(W.percentCompleted);C("#drop-request-status-message").text(W.state);if(W.finished===true||V===true){Q()}else{S=setTimeout(function(){S=null;U(Math.min(X,Z*2))},Z*1000)}};var U=function(Z){C.ajax({type:"GET",url:W.uri,dataType:"json"}).done(function(aa){W=aa.dropRequest;Y(Z)}).fail(function(ac,aa,ab){if(ac.status===403){f.handleAjaxError(ac,aa,ab)}else{Q()}})};C.ajax({type:"POST",url:"../nifi-api/flowfile-queues/"+encodeURIComponent(T.id)+"/drop-requests",dataType:"json",contentType:"application/json"}).done(function(Z){R(0);C("#drop-request-status-dialog").modal("show");W=Z.dropRequest;Y(1)}).fail(function(ab,Z,aa){if(ab.status===403){f.handleAjaxError(ab,Z,aa)}else{Q()}})}})},listQueue:function(Q){if(Q.size()!==1||!M.isConnection(Q)){return}var P=Q.datum();A.listQueue(P)},viewState:function(Q){if(Q.size()!==1||!M.isProcessor(Q)){return}var P=Q.datum();g.showState(P,M.isConfigurable(Q))},changeVersion:function(Q){if(Q.size()!==1||!M.isProcessor(Q)){return}var P=Q.datum();t.promptForVersionChange(P)},alignVertical:function(R){var T=I.map();if(M.canModify(R)===false){l.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var Q=null,S=null;R.each(function(V){if(V.type!=="Connection"){if(Q===null||V.position.x<Q){Q=V.position.x}var U=V.position.x+V.dimensions.width;if(S===null||U>S){S=U}}});var P=(Q+S)/2;R.each(function(V){if(V.type!=="Connection"){var W={x:P-(V.position.x+V.dimensions.width/2),y:0};if(W.x!==0){var U=O.getComponentConnections(V.id);C.each(U,function(Z,Y){var aa=I.select("#id-"+Y.id);if(!T.has(Y.id)&&M.getConnectionSourceComponentId(Y)===M.getConnectionDestinationComponentId(Y)){var X=v.updateConnectionPosition(O.get(Y.id),W);if(X!==null){T.set(Y.id,X)}}else{if(!T.has(Y.id)&&aa.classed("selected")&&M.canModify(aa)){if(M.getConnectionSourceComponentId(Y)===V.id||!d(Y,R)){var X=v.updateConnectionPosition(O.get(Y.id),W);if(X!==null){T.set(Y.id,X)}}}}});T.set(V.id,v.updateComponentPosition(V,W))}}});v.refreshConnections(T)},alignHorizontal:function(Q){var S=I.map();if(M.canModify(Q)===false){l.showOkDialog({headerText:"Component Position",dialogContent:"Must be authorized to modify every component selected."});return}var T=null,R=null;Q.each(function(V){if(V.type!=="Connection"){if(T===null||V.position.y<T){T=V.position.y}var U=V.position.y+V.dimensions.height;if(R===null||U>R){R=U}}});var P=(T+R)/2;Q.each(function(V){if(V.type!=="Connection"){var W={x:0,y:P-(V.position.y+V.dimensions.height/2)};if(W.y!==0){var U=O.getComponentConnections(V.id);C.each(U,function(Z,Y){var aa=I.select("#id-"+Y.id);if(!S.has(Y.id)&&M.getConnectionSourceComponentId(Y)===M.getConnectionDestinationComponentId(Y)){var X=v.updateConnectionPosition(O.get(Y.id),W);if(X!==null){S.set(Y.id,X)}}else{if(!S.has(Y.id)&&aa.classed("selected")&&M.canModify(aa)){if(M.getConnectionSourceComponentId(Y)===V.id||!d(Y,Q)){var X=v.updateConnectionPosition(O.get(Y.id),W);if(X!==null){S.set(Y.id,X)}}}}});S.set(V.id,v.updateComponentPosition(V,W))}}});v.refreshConnections(S)},fillColor:function(R){if(M.isColorable(R)){var P=M.isProcessor(R);var Q;if(P){Q=s.defaultFillColor()}else{Q=u.defaultColor()}if(R.size()===1){var S=R.datum();if(H.isDefinedAndNotNull(S.component.style["background-color"])){Q=S.component.style["background-color"]}}C("#fill-color").minicolors("value",Q);if(P){C("#fill-color-processor-preview").show();C("#fill-color-label-preview").hide()}else{C("#fill-color-processor-preview").hide();C("#fill-color-label-preview").show()}C("#fill-color-dialog").modal("show")}},group:function(){var Q=M.getSelection();if(Q.empty()){return}var P=M.getOrigin(Q);var R={x:P.x,y:P.y};C.when(n.injector.get("groupComponent").promptForGroupName(R)).done(function(S){var T=I.select("#id-"+S.id);M.moveComponents(Q,T)})},moveIntoParent:function(){var P=M.getSelection();if(P.empty()){return}M.moveComponentsToParent(P)},uploadTemplate:function(){C("#upload-template-dialog").modal("show")},template:function(){var P=M.getSelection();if(P.empty()){P=I.selectAll("g.component, g.connection")}if(P.empty()){l.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}P=M.trimDanglingEdges(P);if(P.empty()){l.showOkDialog({headerText:"Create Template",dialogContent:"The current selection is not valid to create a template."});return}C("#new-template-dialog").modal("setButtonModel",[{buttonText:"Create",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var R=C("#new-template-name").val();if(H.isBlank(R)){l.showOkDialog({headerText:"Create Template",dialogContent:"The template name cannot be blank."});return}C("#new-template-dialog").modal("hide");var T=C("#new-template-description").val();var Q=M.getGroupId();var S=N.marshal(P,Q);N.create(S).done(function(U){var V={name:R,description:T,snippetId:U.snippet.id};C.ajax({type:"POST",url:F.urls.api+"/process-groups/"+encodeURIComponent(M.getGroupId())+"/templates",data:JSON.stringify(V),dataType:"json",contentType:"application/json"}).done(function(){l.showOkDialog({headerText:"Create Template",dialogContent:"Template '"+H.escapeHtml(R)+"' was successfully created."})}).always(function(){C("#new-template-name").val("");C("#new-template-description").val("")}).fail(f.handleAjaxError)}).fail(f.handleAjaxError)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){C("#new-template-name").val("");C("#new-template-description").val("");C("#new-template-dialog").modal("hide")}}}]).modal("show");C("#new-template-name").focus()},copy:function(R){if(R.empty()){return}var Q=M.getOrigin(R);var P=M.getGroupId();y.copy({snippet:N.marshal(R,P),origin:Q})},paste:function(W,X){if(H.isDefinedAndNotNull(X)){var R=M.scaleCanvasView();var P=M.translateCanvasView();var S=X.pageX;var Q=X.pageY-M.getCanvasOffset();var V=(S/R)-(P[0]/R);var U=(Q/R)-(P[1]/R);var T={x:V,y:U}}y.paste().done(function(Z){var Y=C.Deferred(function(aa){var ab=function(af,ad,ae){aa.reject(af.responseText)};var ac=M.getGroupId();N.create(Z.snippet).done(function(af){var ae=T;var ad=Z.origin;if(!H.isDefinedAndNotNull(ae)){ad.x+=25;ad.y+=25;ae=ad}N.copy(af.snippet.id,ae,ac).done(function(ah){var ag=ah.flow;q.add(ag,{selectAll:true});q.updateVisibility();i.refresh()}).fail(function(){M.reload().done(function(){q.updateVisibility();i.refresh()})}).fail(ab)}).fail(ab)}).promise();Y.fail(function(ab){var aa="An error occurred while attempting to copy and paste.";if(C.trim(ab)!==""){aa=ab}l.showOkDialog({headerText:"Paste Error",dialogContent:H.escapeHtml(aa)})})})},toFront:function(S){if(S.size()!==1||!M.isConnection(S)){return}var P=S.datum();var R=-1;C.each(O.get(),function(U,V){if(P.id!==V.id&&V.zIndex>R){R=V.zIndex}});if(R>=0){var T=R+1;var Q={revision:k.getRevision(P),component:{id:P.id,zIndex:T}};C.ajax({type:"PUT",url:P.uri,data:JSON.stringify(Q),dataType:"json",contentType:"application/json"}).done(function(U){O.set(U)})}}};return w}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Common","nf.Graph","nf.Shell","nf.ng.Bridge","nf.ClusterSummary","nf.ErrorHandler","nf.Storage","nf.CanvasUtils","nf.Birdseye","nf.ContextMenu","nf.Actions","nf.ProcessGroup"],function(i,p,h,l,e,k,n,m,j,g,d,o,f,c){return(nf.Canvas=b(i,p,h,l,e,k,n,m,j,g,d,o,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Canvas=b(require("jquery"),require("d3"),require("nf.Common"),require("nf.Graph"),require("nf.Shell"),require("nf.ng.Bridge"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.Birdseye"),require("nf.ContextMenu"),require("nf.Actions"),require("nf.ProcessGroup")))}else{nf.Canvas=b(a.$,a.d3,a.nf.Common,a.nf.Graph,a.nf.Shell,a.nf.ng.Bridge,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Storage,a.nf.CanvasUtils,a.nf.Birdseye,a.nf.ContextMenu,a.nf.Actions,a.nf.ProcessGroup)}}}(this,function(t,D,B,k,A,j,z,c,m,G,d,q,o,r){var x=1;var l=[0,0];var a=1.2;var E=8;var n=0.2;var s=0.6;var f=false;var w=false;var H="root";var J=null;var h=null;var i=null;var C=false;var b=null;var e=null;var I=false;var g=false;var v={urls:{api:"../nifi-api",currentUser:"../nifi-api/flow/current-user",controllerBulletins:"../nifi-api/flow/controller/bulletins",kerberos:"../nifi-api/access/kerberos",revision:"../nifi-api/flow/revision",banners:"../nifi-api/flow/banners"}};var y=function(K){if(f){p.reload({transition:true}).done(function(){setTimeout(function(){y(K)},K*1000)})}};var F=function(K,M){var L=new Date().getTime();return t.ajax({type:"GET",url:v.urls.api+"/flow/process-groups/"+encodeURIComponent(K),dataType:"json"}).done(function(N){var O=N.processGroupFlow;p.setGroupId(O.id);var P=O.breadcrumb;if(P.permissions.canRead){p.setGroupName(P.breadcrumb.name)}else{p.setGroupName(P.id)}h=N.permissions;j.injector.get("breadcrumbsCtrl").resetBreadcrumbs();j.digest();j.injector.get("breadcrumbsCtrl").generateBreadcrumbs(P);j.injector.get("breadcrumbsCtrl").resetScrollPosition();t("#stats-last-refreshed").text(O.lastRefreshed);if(B.isDefinedAndNotNull(O.parentGroupId)){p.setParentGroupId(O.parentGroupId)}else{p.setParentGroupId(null)}k.expireCaches(L);k.set(O.flow,t.extend({selectAll:false,overrideRevisionCheck:z.didConnectedStateChange()},M));p.View.updateVisibility();d.refresh()}).fail(c.handleAjaxError)};var u=function(){return t.ajax({type:"GET",url:v.urls.currentUser,dataType:"json"}).done(function(K){B.setCurrentUser(K)})};var p={CANVAS_OFFSET:0,SUPPORTS_SVG:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,hideSplash:function(){t("#splash").fadeOut()},stopPolling:function(){f=false},disableRefreshHotKey:function(){w=true},reload:function(K){return t.Deferred(function(N){var M=F(p.getGroupId(),K);var P=j.injector.get("flowStatusCtrl").reloadFlowStatus();var O=u();var L=t.ajax({type:"GET",url:v.urls.controllerBulletins,dataType:"json"}).done(function(R){j.injector.get("flowStatusCtrl").updateBulletins(R)});var Q=z.loadClusterSummary().done(function(R){var S=R.clusterSummary;j.injector.get("flowStatusCtrl").updateClusterSummary(S)});t.when(M,P,O,L,Q).done(function(R){j.digest();N.resolve(R)}).fail(function(T,R,S){N.reject(T,R,S)})}).promise()},initCanvas:function(){var R=t("#canvas-container");b=D.select("#canvas-container").append("svg").on("contextmenu",function(){I=false;G.getSelection().classed("selected",false);G.setURLParameters();q.show();D.event.preventDefault()});var K=b.append("defs");K.selectAll("marker").data(["normal","ghost","unauthorized","full"]).enter().append("marker").attr({id:function(S){return S},viewBox:"0 0 6 6",refX:5,refY:3,markerWidth:6,markerHeight:6,orient:"auto",fill:function(S){if(S==="ghost"){return"#aaaaaa"}else{if(S==="unauthorized"){return"#ba554a"}else{if(S==="full"){return"#ba554a"}else{return"#000000"}}}}}).append("path").attr("d","M2,3 L0,6 L6,3 L0,0 z");var M=K.append("filter").attr({id:"component-drop-shadow",height:"140%",y:"-20%"});M.append("feGaussianBlur").attr({"in":"SourceAlpha",stdDeviation:3,result:"blur"});M.append("feOffset").attr({"in":"blur",dx:0,dy:1,result:"offsetBlur"});M.append("feFlood").attr({"flood-color":"#000000","flood-opacity":0.4,result:"offsetColor"});M.append("feComposite").attr({"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var O=M.append("feMerge");O.append("feMergeNode").attr("in","offsetColorBlur");O.append("feMergeNode").attr("in","SourceGraphic");var L=K.append("filter").attr({id:"connection-full-drop-shadow",height:"140%",y:"-20%"});L.append("feGaussianBlur").attr({"in":"SourceAlpha",stdDeviation:3,result:"blur"});L.append("feOffset").attr({"in":"blur",dx:0,dy:1,result:"offsetBlur"});L.append("feFlood").attr({"flood-color":"#ba554a","flood-opacity":1,result:"offsetColor"});L.append("feComposite").attr({"in":"offsetColor",in2:"offsetBlur",operator:"in",result:"offsetColorBlur"});var Q=L.append("feMerge");Q.append("feMergeNode").attr("in","offsetColorBlur");Q.append("feMergeNode").attr("in","SourceGraphic");e=b.append("g").attr({transform:"translate("+l+") scale("+x+")","pointer-events":"all",id:"canvas"});b.on("mousedown.selection",function(){I=true;if(D.event.button!==0){D.event.stopImmediatePropagation();return}if(D.event.shiftKey){var S=D.mouse(e.node());e.append("rect").attr("rx",6).attr("ry",6).attr("x",S[0]).attr("y",S[1]).attr("class","selection").attr("width",0).attr("height",0).attr("stroke-width",function(){return 1/p.View.scale()}).attr("stroke-dasharray",function(){return 4/p.View.scale()}).datum(S);D.event.stopImmediatePropagation();D.event.preventDefault()}}).on("mousemove.selection",function(){if(D.event.shiftKey){var T=D.select("rect.selection");if(!T.empty()){var U=T.datum();var S=D.mouse(e.node());var V={};if(U[0]<S[0]){V.x=U[0];V.width=S[0]-U[0]}else{V.x=S[0];V.width=U[0]-S[0]}if(U[1]<S[1]){V.y=U[1];V.height=S[1]-U[1]}else{V.y=S[1];V.height=U[1]-S[1]}T.attr(V);D.event.stopPropagation()}}}).on("mouseup.selection",function(){if(I===false){return}I=false;var S=D.select("rect.selection");if(!S.empty()){var T={x:parseInt(S.attr("x"),10),y:parseInt(S.attr("y"),10),width:parseInt(S.attr("width"),10),height:parseInt(S.attr("height"),10)};D.selectAll("g.component").classed("selected",function(U){return D.select(this).classed("selected")||U.position.x>=T.x&&(U.position.x+U.dimensions.width)<=(T.x+T.width)&&U.position.y>=T.y&&(U.position.y+U.dimensions.height)<=(T.y+T.height)});D.selectAll("g.connection").classed("selected",function(W){var V=[W.start].concat(W.bends,[W.end]);var U=D.extent(V,function(Y){return Y.x});var X=D.extent(V,function(Y){return Y.y});return D.select(this).classed("selected")||U[0]>=T.x&&U[1]<=(T.x+T.width)&&X[0]>=T.y&&X[1]<=(T.y+T.height)});S.remove();G.setURLParameters()}else{if(g===false){G.getSelection().classed("selected",false);G.setURLParameters()}}j.digest()});var N=function(){var W=t("#banner-footer");var S=0;if(W.is(":visible")){S=W.height()}var U=parseInt(R.css("top"),10);var V=t(window).height();var T=(V-(S+U));R.css({height:T+"px",bottom:S+"px"});b.attr({height:R.height(),width:t(window).width()});j.injector.get("breadcrumbsCtrl").updateBreadcrumbsCss({bottom:S+"px"});t("#canvas-body").css({height:V+"px",width:t(window).width()+"px"})};var P=function(){t("#flow-status-container").css({width:(((t("#nifi-logo").width()+t("#component-container").width())/t(window).width())*100)*2+"%"})};P();t("body").on("GoTo:Component",function(T,S){G.showComponent(S.parentGroupId,S.id)});t("body").on("GoTo:ProcessGroup",function(T,S){r.enterGroup(S.id).done(function(){G.getSelection().classed("selected",false);j.digest()})});t(window).on("resize",function(aa){if(aa.target===window){if(t(".md-menu-backdrop").is(":visible")===true){t(".md-menu-backdrop").click()}N();P();var Y=t("#shell-dialog");if(Y.is(":visible")){setTimeout(function(ac){A.resizeContent(ac);if(ac.find("#shell-iframe").is(":visible")){A.resizeIframe(ac)}},50,Y)}var S=t(".dialog");for(var X=0,Z=S.length;X<Z;X++){if(t(S[X]).is(":visible")){setTimeout(function(ac){ac.modal("resize")},50,t(S[X]))}}var ab=t('*[class*="slickgrid_"]');for(var W=0,Z=ab.length;W<Z;W++){if(t(ab[W]).is(":visible")){setTimeout(function(ac){ac.data("gridInstance").resizeCanvas()},50,t(ab[W]))}}var U=t(".tab-container");var T=[];for(var V=0,Z=U.length;V<Z;V++){if(t(U[V]).is(":visible")){T.push(t("#"+t(U[V]).attr("id")+"-content"))}}t.each(T,function(ac,ad){B.toggleScrollable(ad.get(0))})}}).on("keydown",function(S){if(t(".dialog").is(":visible")||t("#search-field").is(":focus")){return}var T=G.getSelection();var U=S.ctrlKey||S.metaKey;if(U){if(S.keyCode===82){if(w===true){location.reload();return}o.reload()}else{if(S.keyCode===65){o.selectAll();G.setURLParameters();j.digest();S.preventDefault()}else{if(S.keyCode===67){if(p.canWrite()&&G.isCopyable(T)){o.copy(T)}}else{if(S.keyCode===86){if(p.canWrite()&&G.isPastable()){o.paste(T);S.preventDefault()}}}}}}else{if(S.keyCode===8||S.keyCode===46){if(p.canWrite()&&G.areDeletable(T)){o["delete"](T)}}}});t.ajax({type:"GET",url:v.urls.banners,dataType:"json"}).done(function(U){if(B.isDefinedAndNotNull(U.banners)){if(B.isDefinedAndNotNull(U.banners.headerText)&&U.banners.headerText!==""){t("#banner-header").addClass("banner-header-background").text(U.banners.headerText).show();t("#canvas-container").css("top","98px")}if(B.isDefinedAndNotNull(U.banners.footerText)&&U.banners.footerText!==""){var S=t("#banner-footer").text(U.banners.footerText).show();var T=function(V){var W=t("#"+V);W.css("bottom",parseInt(S.css("height"),10)+"px")};T("graph")}}N()}).fail(c.handleAjaxError)},init:function(){var K=t.Deferred(function(L){if(m.hasItem("jwt")){L.resolve()}else{t.ajax({type:"POST",url:v.urls.kerberos,dataType:"text"}).done(function(O){var N=B.getJwtPayload(O);var M=parseInt(N.exp,10)*B.MILLIS_PER_SECOND;m.setItem("jwt",O,M);L.resolve()}).fail(function(){L.reject()})}}).promise();return t.Deferred(function(L){K.always(function(){u().done(function(M){if(M.anonymous===false){t("#current-user").text(M.identity).show();if(m.getItem("jwt")!==null){t("#logout-link-container").show()}}else{B.setAnonymousUserLabel()}L.resolve()}).fail(function(O,M,N){if(O.status===401){window.location="/nifi/login"}else{L.reject(O,M,N)}})})}).promise()},setGroupId:function(K){H=K},getGroupId:function(){return H},setGroupName:function(K){J=K},getGroupName:function(){return J},setParentGroupId:function(K){i=K},getParentGroupId:function(){return i},setConfigurableAuthorizer:function(K){C=K},isConfigurableAuthorizer:function(){return C},canRead:function(){if(h===null){return false}else{return h.canRead===true}},canWrite:function(){if(h===null){return false}else{return h.canWrite===true}},startPolling:function(K){f=true;y(K)},View:(function(){var L=function(){var U=t("#canvas-container");var P=p.View.translate();var Q=p.View.scale();P=[P[0]/Q,P[1]/Q];var M=U.width()/Q;var N=U.height()/Q;var R=-P[0]-M;var O=-P[1]-N;var W=R+(M*3);var Y=O+(N*3);var T=function(ad){if(!p.View.shouldRenderPerScale()){return false}var ac=ad.position.x;var ab=ad.position.y;var aa=ac+ad.dimensions.width;var Z=ab+ad.dimensions.height;return R<aa&&W>ac&&O<Z&&Y>ab};var V=function(ab){if(!p.View.shouldRenderPerScale()){return false}var Z,ac;if(ab.bends.length>0){var aa=Math.min(Math.max(0,ab.labelIndex),ab.bends.length-1);Z=ab.bends[aa].x;ac=ab.bends[aa].y}else{Z=(ab.start.x+ab.end.x)/2;ac=(ab.start.y+ab.end.y)/2}return R<Z&&W>Z&&O<ac&&Y>ac};var S=function(ad,Z){var ab=D.select("#id-"+ad.id);var ac=Z(ad);var aa=ab.classed("visible");ab.classed("visible",ac).classed("entering",function(){return ac&&!aa}).classed("leaving",function(){return !ac&&aa})};var X=k.get();t.each(X.processors,function(Z,aa){S(aa,T)});t.each(X.ports,function(Z,aa){S(aa,T)});t.each(X.processGroups,function(Z,aa){S(aa,T)});t.each(X.remoteProcessGroups,function(Z,aa){S(aa,T)});t.each(X.connections,function(Z,aa){S(aa,V)})};var K;return{init:function(){var M;var N=false;K=D.behavior.zoom().scaleExtent([n,E]).translate(l).scale(x).on("zoomstart",function(){q.hide()}).on("zoom",function(){if(N){g=true}else{N=true}var O=D.event.sourceEvent.type==="wheel"||D.event.sourceEvent.type==="mousewheel";M=p.View.refresh({persist:false,transition:O,refreshComponents:false,refreshBirdseye:false})}).on("zoomend",function(){if(B.isDefinedAndNotNull(M)){p.View.updateVisibility();M.done(function(){d.refresh()});G.persistUserView();M=null}g=false;N=false});b.call(K).on("dblclick.zoom",null)},shouldRenderPerScale:function(){return p.View.scale()>=s},updateVisibility:function(){L();k.pan()},translate:function(M){if(B.isUndefined(M)){return K.translate()}else{K.translate(M)}},scale:function(M){if(B.isUndefined(M)){return K.scale()}else{K.scale(M)}},zoomIn:function(){var O=p.View.translate();var N=p.View.scale();var R=Math.min(N*a,E);var Q=t("#canvas-container");var M=Q.width()/N;var P=Q.height()/N;p.View.scale(R);G.centerBoundingBox({x:(M/2)-(O[0]/N),y:(P/2)-(O[1]/N),width:1,height:1})},zoomOut:function(){var O=p.View.translate();var N=p.View.scale();var R=Math.max(N/a,n);var Q=t("#canvas-container");var M=Q.width()/N;var P=Q.height()/N;p.View.scale(R);G.centerBoundingBox({x:(M/2)-(O[0]/N),y:(P/2)-(O[1]/N),width:1,height:1})},fit:function(){var O=p.View.translate();var Q=p.View.scale();var T;var S=t("#canvas-container");var P=S.width();var R=S.height();var V=D.select("#canvas").node().getBoundingClientRect();var W=V.width/Q;var N=V.height/Q;var U=V.left/Q;var M=(V.top-p.CANVAS_OFFSET)/Q;if(W>P||N>R){T=Math.min(P/W,R/N);T=Math.min(Math.max(T,n),E)}else{T=1;U-=100;M-=50}p.View.scale(T);G.centerBoundingBox({x:U-(O[0]/Q),y:M-(O[1]/Q),width:P/T,height:R/T})},actualSize:function(){var R=p.View.translate();var Q=p.View.scale();var N=G.getSelection();p.View.scale(1);var O;if(!N.empty()){var M=N.node().getBoundingClientRect();O={x:(M.left/Q)-(R[0]/Q),y:((M.top-p.CANVAS_OFFSET)/Q)-(R[1]/Q),width:M.width/Q,height:M.height/Q}}else{var T=t("#canvas-container");var P=T.width()/Q;var S=T.height()/Q;O={x:(P/2)-(R[0]/Q),y:(S/2)-(R[1]/Q),width:1,height:1}}G.centerBoundingBox(O)},refresh:function(M){return t.Deferred(function(N){var O=true;var Q=false;var P=true;var R=true;if(B.isDefinedAndNotNull(M)){O=B.isDefinedAndNotNull(M.persist)?M.persist:O;Q=B.isDefinedAndNotNull(M.transition)?M.transition:Q;P=B.isDefinedAndNotNull(M.refreshComponents)?M.refreshComponents:P;R=B.isDefinedAndNotNull(M.refreshBirdseye)?M.refreshBirdseye:R}if(P){p.View.updateVisibility()}if(O===true){G.persistUserView()}if(Q===true){e.transition().duration(500).attr("transform",function(){return"translate("+K.translate()+") scale("+K.scale()+")"}).each("end",function(){if(R===true){d.refresh()}N.resolve()})}else{e.attr("transform",function(){return"translate("+K.translate()+") scale("+K.scale()+")"});if(R===true){d.refresh()}N.resolve()}}).promise()}}}())};return p}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ErrorHandler","nf.Common","nf.Canvas","nf.ContextMenu"],function(f,e,d,c){return(nf.ErrorHandler=b(f,e,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ErrorHandler=b(require("nf.ErrorHandler"),require("nf.Common"),require("nf.Canvas"),require("nf.ContextMenu")))}else{nf.ErrorHandler=b(a.nf.ErrorHandler,a.nf.Common,a.nf.Canvas,a.nf.ContextMenu)}}}(this,function(d,c,b,a){return{handleAjaxError:function(g,e,f){d.handleAjaxError(g,e,f);c.showLogoutLink();if($("#splash").is(":visible")){b.hideSplash()}a.hide();b.stopPolling();b.disableRefreshHotKey()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.Settings","nf.UniversalCapture","nf.CustomUi","nf.CanvasUtils","nf.ReportingTask","nf.Processor"],function(g,m,k,d,f,n,e,h,j,c,l,i){return(nf.ControllerService=b(g,m,k,d,f,n,e,h,j,c,l,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerService=b(require("jquery"),require("d3"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.Settings"),require("nf.UniversalCapture"),require("nf.CustomUi"),require("nf.CanvasUtils"),require("nf.ReportingTask"),require("nf.Processor")))}else{nf.ControllerService=b(a.$,a.d3,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.Settings,a.nf.UniversalCapture,a.nf.CustomUi,a.nf.CanvasUtils,a.nf.ReportingTask,a.nf.Processor)}}}(this,function(C,U,d,S,j,g,H,c,z,X,D,s){var N;var M={edit:"edit",readOnly:"read-only",serviceOnly:"SERVICE_ONLY",serviceAndReferencingComponents:"SERVICE_AND_REFERENCING_COMPONENTS",urls:{api:"../nifi-api"}};var w=function(ad,aa,ab){if(ad.status===400){var ae=ad.responseText.split("\n");var ac;if(ae.length===1){ac=C("<span></span>").text(ae[0])}else{ac=S.formatUnorderedList(ae)}j.showOkDialog({dialogContent:ac,headerText:"Controller Service"})}else{d.handleAjaxError(ad,aa,ab)}};var G=function(){var aa=C("#controller-service-configuration").data("controllerServiceDetails");if(C("#controller-service-name").val()!==aa.component.name){return true}if(C("#controller-service-comments").val()!==aa.component.comments){return true}return C("#controller-service-properties").propertytable("isSaveRequired")};var n=function(){var ab=C("#controller-service-properties").propertytable("marshalProperties");var ac={};ac.id=C("#controller-service-id").text();ac.name=C("#controller-service-name").val();ac.comments=C("#controller-service-comments").val();if(C.isEmptyObject(ab)===false){ac.properties=ab}var aa={};aa.component=ac;return aa};var b=function(aa){return true};var Y=function(ad,ae){var ab=ad.data("gridInstance");var ac=ab.getData();var aa=ac.getItemById(ae);if(S.isUndefined(aa)||aa.permissions.canRead===false){return C.Deferred(function(af){af.reject()}).promise()}return C.ajax({type:"GET",url:aa.uri,dataType:"json"}).done(function(af){O(ad,af)}).fail(d.handleAjaxError)};var O=function(ae,aa){var ab=ae.data("gridInstance");var ad=ab.getData();var ac=ad.getItemById(aa.id);ad.updateItem(aa.id,C.extend({type:"ControllerService",bulletins:ac.bulletins},aa))};var h=function(ab,aa){Y(ab,aa.id).done(function(ac){f(ab,ac.component)})};var f=function(ab,aa){C.each(aa.referencingComponents,function(ad,af){if(af.permissions.canRead===false){return}var ac=af.component;if(ac.referenceType==="Processor"){if(X.getGroupId()===ac.groupId){s.reload(ac.id)}C("div."+ac.id+"-active-threads").text(ac.activeThreadCount);var ae=C("div."+ac.id+"-state");if(ae.length){l(ae,ac)}}else{if(ac.referenceType==="ReportingTask"){D.reload(ac.id);C("div."+ac.id+"-active-threads").text(ac.activeThreadCount);var ae=C("div."+ac.id+"-state");if(ae.length){l(ae,ac)}}else{Y(ab,ac.id);var ae=C("div."+ac.id+"-state");if(ae.length){I(ae,ac)}if(ac.referenceCycle===false){f(ab,ac)}}}});T.reloadReferencedServices(ab,aa)};var V=function(aa){var ab=aa.get(0).scrollHeight>Math.round(aa.innerHeight())||aa.get(0).scrollWidth>Math.round(aa.innerWidth());if(aa.is(":visible")&&ab){aa.css("border-width","1px")}else{aa.css("border-width","0px")}};var k=function(ad,ab){var ae=ab.data("bulletins");if(S.doBulletinsDiffer(ae,ad)){ab.data("bulletins",ad);var aa=S.getFormattedBulletins(ad);if(ad.length>0){var ac=S.formatUnorderedList(aa);if(ab.data("qtip")){ab.qtip("option","content.text",ac)}else{ab.addClass("has-bulletins").show().qtip(C.extend({},X.config.systemTooltipConfig,{content:ac}))}}else{if(ab.data("qtip")){ab.removeClass("has-bulletins").removeData("bulletins").hide().qtip("api").destroy(true)}}}};var l=function(aa,ab){aa.removeClass("disabled stopped running invalid").addClass(function(){var ac=C(this);var ae=ab.state.toLowerCase();if(ae==="stopped"&&!S.isEmpty(ab.validationErrors)){ae="invalid";var ad=S.formatUnorderedList(ab.validationErrors);if(ac.data("qtip")){ac.qtip("option","content.text",ad)}else{ac.qtip(C.extend({},X.config.systemTooltipConfig,{content:ad}))}}else{if(ac.data("qtip")){ac.qtip("api").destroy(true)}}return ae})};var I=function(ab,aa){ab.removeClass("disabled enabled invalid").addClass(function(){var ac=C(this);var ae=aa.state==="ENABLED"?"enabled":"disabled";if(ae==="disabled"&&!S.isEmpty(aa.validationErrors)){ae="invalid";var ad=S.formatUnorderedList(aa.validationErrors);if(ac.data("qtip")){ac.qtip("option","content.text",ad)}else{ac.qtip(C.extend({},X.config.systemTooltipConfig,{content:ad}))}}else{if(ac.data("qtip")){ac.qtip("api").destroy(true)}}return ae})};var m=function(ab){var aa=U.nest().key(function(ac){return ac.sourceId}).map(ab,U.map);aa.forEach(function(ad,ac){C("div."+ad+"-bulletins").each(function(){k(ac,C(this))})})};var L=function(ai,aj,ad){if(S.isEmpty(ad)){aj.append('<div class="unset">No referencing components.</div>');return}var ab=function(al,ak){if(al.hasClass("expanded")){al.removeClass("expanded").addClass("collapsed");ak.hide()}else{al.removeClass("collapsed").addClass("expanded");ak.show()}};var ac=[];var ae=C('<ul class="referencing-component-listing clear"></ul>');var ah=C('<ul class="referencing-component-listing clear"></ul>');var aa=C('<ul class="referencing-component-listing clear"></ul>');var af=C('<ul class="referencing-component-listing clear"></ul>');C.each(ad,function(aH,aq){if(aq.permissions.canRead===false||aq.permissions.canWrite===false){var an=C('<div class="unset"></div>').text(aq.id);af.append(an)}else{var aA=aq.component;ac.push(aA.id);if(aA.referenceType==="Processor"){var aG=C('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){X.showComponent(aA.groupId,aA.id);aj.closest(".dialog").modal("hide");C("#shell-close-button").click()});var aw=C('<div class="referencing-component-state"></div>').addClass(aA.id+"-state");l(aw,aA);var ay=C('<div class="referencing-component-bulletins"></div>').addClass(aA.id+"-bulletins");var aB=C('<span class="referencing-component-type"></span>').text(S.substringAfterLast(aA.type,"."));var am=C('<span class="referencing-component-active-thread-count"></span>').addClass(aA.id+"-active-threads");if(S.isDefinedAndNotNull(aA.activeThreadCount)&&aA.activeThreadCount>0){am.text("("+aA.activeThreadCount+")")}var at=C("<li></li>").append(aw).append(ay).append(aG).append(aB).append(am);ae.append(at)}else{if(aA.referenceType==="ControllerService"){var aD=C('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){var aI=ai.data("gridInstance");var aJ=aI.getData();var aK=aJ.getRowById(aA.id);aI.setSelectedRows([aK]);aI.scrollRowIntoView(aK);aj.closest(".dialog").modal("hide")});var aE=C('<div class="referencing-component-references hidden"></div>');var ap=C('<div class="service expansion-button collapsed pointer"></div>').on("click",function(){if(ap.hasClass("collapsed")){if(aA.referenceCycle===true){aE.append('<div class="unset">Reference cycle detected.</div>')}else{var aI=ai.data("gridInstance");var aJ=aI.getData();o(aA.id,aJ).done(function(aK){var aL=aK.component;L(ai,aE,aL.referencingComponents)})}}else{aE.empty()}ab(ap,aE);V(aj)});var au=C('<div class="referencing-component-state"></div>').addClass(aA.id+"-state");I(au,aA);var aF=C('<div class="referencing-component-bulletins"></div>').addClass(aA.id+"-bulletins");var az=C('<span class="referencing-component-type"></span>').text(S.substringAfterLast(aA.type,"."));var ar=C("<li></li>").append(ap).append(au).append(aF).append(aD).append(az).append(aE);ah.append(ar)}else{if(aA.referenceType==="ReportingTask"){var ao=C('<span class="referencing-component-name link"></span>').text(aA.name).on("click",function(){var aK=C("#reporting-tasks-table").data("gridInstance");var aI=aK.getData();var aJ=aI.getRowById(aA.id);aK.setSelectedRows([aJ]);aK.scrollRowIntoView(aJ);C("#settings-tabs").find("li:last").click();aj.closest(".dialog").modal("hide")});var ax=C('<div class="referencing-component-state"></div>').addClass(aA.id+"-state");l(ax,aA);var ak=C('<div class="referencing-component-bulletins"></div>').addClass(aA.id+"-bulletins");var al=C('<span class="referencing-component-type"></span>').text(S.substringAfterLast(aA.type,"."));var av=C('<span class="referencing-component-active-thread-count"></span>').addClass(aA.id+"-active-threads");if(S.isDefinedAndNotNull(aA.activeThreadCount)&&aA.activeThreadCount>0){av.text("("+aA.activeThreadCount+")")}var aC=C("<li></li>").append(ax).append(ak).append(ao).append(al).append(av);aa.append(aC)}}}}});P(ac).done(function(ak){var al=ak.bulletinBoard.bulletins;m(al)});var ag=function(ak,am){if(am.is(":empty")){am.remove();return}var ao=C('<div class="expansion-button expanded"></div>');var an=C('<span class="referencing-component-title"></span>').text(ak);var al=C('<span class="referencing-component-count"></span>').text("("+am.children().length+")");C('<div class="referencing-component-block pointer unselectable"></div>').on("click",function(){ab(ao,am);V(aj)}).append(ao).append(an).append(al).appendTo(aj);am.appendTo(aj)};ag("Processors",ae);ag("Reporting Tasks",aa);ag("Controller Services",ah);ag("Unauthorized",af)};var P=function(ab){var aa=ab.join("|");return C.ajax({type:"GET",url:"../nifi-api/flow/bulletin-board",data:{sourceId:aa},dataType:"json"}).fail(d.handleAjaxError)};var e=function(af,ab,ad,ae){var aa={revision:g.getRevision(ab),component:{id:ab.id,state:ad?"ENABLED":"DISABLED"}};var ac=C.ajax({type:"PUT",url:ab.uri,data:JSON.stringify(aa),dataType:"json",contentType:"application/json"}).done(function(ag){O(af,ag)}).fail(d.handleAjaxError);return C.Deferred(function(ag){ac.done(function(){var ah=t(ab,function(ai,aj){if(C.isArray(aj)){if(ad){k(aj,C("#enable-controller-service-bulletins"))}else{k(aj,C("#disable-controller-service-bulletins"))}}if(ad){return ai.state==="ENABLING"||ai.state==="ENABLED"}else{return ai.state==="DISABLED"}},function(ai){return P([ai.id])},ae);ah.done(function(){ag.resolve()}).fail(function(){ag.reject()})}).fail(function(){ag.reject()})}).promise()};var q=function(aa){var ab=U.set();ab.add(aa.id);var ac=function(ad){C.each(ad,function(ae,ag){var af=ag.component;if(af.referenceType==="ControllerService"){ab.add(af.id);if(af.referenceCycle===false){ac(af.referencingComponents)}}})};ac(aa.referencingComponents);return ab};var a=function(ab,aa,ac){C.each(ab,function(ad,af){var ae=af.component;if(ac){if(ae.referenceType==="ControllerService"){aa[af.id]=g.getRevision(af)}}else{if(ae.referenceType!=="ControllerService"){aa[af.id]=g.getRevision(af)}}a(ae.referencingComponents,aa,ac)})};var E=function(af,aa,ac,ae){var ag={};a(aa.component.referencingComponents,ag,false);var ad={id:aa.id,state:ac?"RUNNING":"STOPPED",referencingComponentRevisions:ag};var ab=C.ajax({type:"PUT",url:aa.uri+"/references",data:JSON.stringify(ad),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return C.Deferred(function(ah){ab.done(function(ai){aa.component.referencingComponents=ai.controllerServiceReferencingComponents;if(ac){ah.resolve()}else{var aj=q(aa.component);var ak=af.data("gridInstance");var am=ak.getData();var al=[];aj.forEach(function(an){o(an,am).done(function(ao){al.push(v(ao,ae))})});C.when.apply(window,al).done(function(){ah.resolve()}).fail(function(){ah.reject()})}}).fail(function(){ah.reject()})}).promise()};var o=function(ab,ac){var aa=ac.getItemById(ab);if(S.isDefinedAndNotNull(aa)){return C.Deferred(function(ad){ad.resolve(aa)})}else{return C.ajax({type:"GET",url:"../nifi-api/controller-services/"+encodeURIComponent(ab),dataType:"json"}).fail(d.handleAjaxError)}};var t=function(aa,ad,ac,ae){var ab=aa.component;return C.Deferred(function(af){var ai=2;var ah=function(){var ak=ai;ai=Math.min(ai*2,4);return ak*1000};var aj=function(){var al=ac(ab);var ak=C.ajax({type:"GET",url:aa.uri,dataType:"json"});C.when(al,ak).done(function(ap,ao){var an=ap[0];var am=ao[0];ag(am.component,an.bulletinBoard.bulletins)}).fail(function(ao,am,an){af.reject();d.handleAjaxError(ao,am,an)})};var ag=function(ak,al){if(ad(ak,al)){af.resolve()}else{if(typeof ae==="function"&&ae()){setTimeout(aj,ah())}else{af.reject()}}};ac(ab).done(function(ak){ag(ab,ak.bulletinBoard.bulletins)}).fail(function(am,ak,al){af.reject();d.handleAjaxError(am,ak,al)})}).promise()};var v=function(aa,ab){return t(aa,function(ac,af){var ad=ac.referencingComponents;var ae=false;C.each(ad,function(ag,aj){var ai=aj.component;if(ai.referenceType==="Processor"||ai.referenceType==="ReportingTask"){if(ai.state==="RUNNING"||ai.activeThreadCount>0){ae=true}C("div."+ai.id+"-active-threads").text(ai.activeThreadCount);var ah=C("div."+ai.id+"-state");l(ah,ai)}});m(af);return ae===false},function(ac){var ae=[];var ad=ac.referencingComponents;C.each(ad,function(af,ah){var ag=ah.component;if(ag.referenceType==="Processor"||ag.referenceType==="ReportingTask"){ae.push(ag.id)}});return P(ae)},ab)};var Z=function(aa,ab){return t(aa,function(ac,af){var ad=ac.referencingComponents;var ae=false;C.each(ad,function(ag,aj){var ah=aj.component;if(ah.referenceType==="ControllerService"){if(ah.state!=="ENABLING"&&ah.state!=="ENABLED"){ae=true}var ai=C("div."+ah.id+"-state");I(ai,ah)}});m(af);return ae===false},function(ac){var ae=[];var ad=ac.referencingComponents;C.each(ad,function(af,ah){var ag=ah.component;if(ag.referenceType==="ControllerService"){ae.push(ag.id)}});return P(ae)},ab)};var K=function(aa,ab){return t(aa,function(ac,ae){var ad=ac.referencingComponents;var af=false;C.each(ad,function(ag,aj){var ah=aj.component;if(ah.referenceType==="ControllerService"){if(ah.state!=="DISABLED"){af=true}var ai=C("div."+ah.id+"-state");I(ai,ah)}});m(ae);return af===false},function(ac){var ae=[];var ad=ac.referencingComponents;C.each(ad,function(af,ah){var ag=ah.component;if(ag.referenceType==="ControllerService"){ae.push(ag.id)}});return P(ae)},ab)};var r=function(af,aa,ac,ae){var ag={};a(aa.component.referencingComponents,ag,true);var ad={id:aa.id,state:ac?"ENABLED":"DISABLED",referencingComponentRevisions:ag};var ab=C.ajax({type:"PUT",url:aa.uri+"/references",data:JSON.stringify(ad),dataType:"json",contentType:"application/json"}).fail(d.handleAjaxError);return C.Deferred(function(ah){ab.done(function(ai){aa.component.referencingComponents=ai.controllerServiceReferencingComponents;var aj=q(aa.component);var ak=af.data("gridInstance");var am=ak.getData();var al=[];aj.forEach(function(an){o(an,am).done(function(ao){if(ac){al.push(Z(ao,ae))}else{al.push(K(ao,ae))}})});C.when.apply(window,al).done(function(){ah.resolve()}).fail(function(){ah.reject()})}).fail(function(){ah.reject()})}).promise()};var y=function(ad,ab){C("#disable-controller-service-id").text(ab.id);C("#disable-controller-service-name").text(ab.name);var aa=C("#disable-controller-service-referencing-components");L(ad,aa,ab.referencingComponents);var ac=[{buttonText:"Disable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){F(ad)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:R}}];C("#disable-controller-service-dialog").modal("setButtonModel",ac).modal("show");P([ab.id]).done(function(ae){k(ae.bulletinBoard.bulletins,C("#disable-controller-service-bulletins"))});V(aa)};var B=function(ad,ab){C("#enable-controller-service-id").text(ab.id);C("#enable-controller-service-name").text(ab.name);var aa=C("#enable-controller-service-referencing-components");L(ad,aa,ab.referencingComponents);var ac=[{buttonText:"Enable",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){i(ad)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:R}}];C("#enable-controller-service-dialog").modal("setButtonModel",ac).modal("show");P([ab.id]).done(function(ae){k(ae.bulletinBoard.bulletins,C("#enable-controller-service-bulletins"))});V(aa)};var R=function(){C(this).modal("hide")};var F=function(aj){var ad=C("#disable-controller-service-dialog");var ac=false;ad.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac=true;ad.modal("setButtonModel",[]);C("#disable-controller-service-dialog div.controller-service-canceling").show()}}}]);C("#disable-controller-service-scope-container").hide();C("#disable-controller-service-progress-container").show();var ai=C("#disable-controller-service-id").text();var aa=aj.data("gridInstance");var ae=aa.getData();var ab=ae.getItemById(ai);var af=ab.component;var ak=function(){return ac===false};var ah=function(){C("#disable-controller-service-dialog div.controller-service-canceling").hide();ad.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:R}}])};if(A(af.referencingComponents)){ah();j.showOkDialog({headerText:"Controller Service",dialogContent:"Unable to disable due to unauthorized referencing components."});return}C("#disable-progress-label").text("Steps to disable "+af.name);var ag=C("#disable-referencing-schedulable").addClass("ajax-loading");C.Deferred(function(al){var am=E(aj,ab,false,ak);am.done(function(){ag.removeClass("ajax-loading").addClass("ajax-complete");var an=C("#disable-referencing-services").addClass("ajax-loading");var ao=r(aj,ab,false,ak);ao.done(function(){an.removeClass("ajax-loading").addClass("ajax-complete");var ap=C("#disable-controller-service").addClass("ajax-loading");e(aj,ab,false,ak).done(function(){al.resolve();ap.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){al.reject();ap.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){al.reject();an.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){al.reject();ag.removeClass("ajax-loading").addClass("ajax-error")})}).always(function(){h(aj,af);ah();if(ac===true&&C("#nf-ok-dialog").not(":visible")){j.showOkDialog({headerText:"Controller Service",dialogContent:"The request to disable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var A=function(aa){var ab=false;C.each(aa,function(ac,ae){if(ae.permissions.canRead===false||ae.permissions.canWrite===false){ab=true;return false}var ad=ae.component;if(A(ad.referencingComponents)){ab=true;return false}});return ab};var i=function(aj){var aa=C("#enable-controller-service-dialog");var ad=false;var ai=C("#enable-controller-service-id").text();var ab=aj.data("gridInstance");var ae=ab.getData();var ac=ae.getItemById(ai);var af=ac.component;var al=C("#enable-controller-service-scope").combo("getSelectedOption").value;if(al===M.serviceOnly){C("#enable-controller-service-progress li.referencing-component").hide()}aa.modal("setButtonModel",[{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ad=true;aa.modal("setButtonModel",[]);C("#enable-controller-service-dialog div.controller-service-canceling").show()}}}]);C("#enable-controller-service-scope-container").hide();C("#enable-controller-service-progress-container").show();var ak=function(){return ad===false};var ah=function(){C("#enable-controller-service-dialog div.controller-service-canceling").hide();aa.modal("setButtonModel",[{buttonText:"Close",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:R}}])};if(al===M.serviceAndReferencingComponents&&A(af.referencingComponents)){ah();j.showOkDialog({headerText:"Controller Service",dialogContent:"Unable to enable due to unauthorized referencing components."});return}C("#enable-progress-label").text("Steps to enable "+af.name);var ag=C("#enable-controller-service").addClass("ajax-loading");C.Deferred(function(am){var an=e(aj,ac,true,ak);if(al===M.serviceAndReferencingComponents){an.done(function(){ag.removeClass("ajax-loading").addClass("ajax-complete");var ao=C("#enable-referencing-services").addClass("ajax-loading");var ap=r(aj,ac,true,ak);ap.done(function(){ao.removeClass("ajax-loading").addClass("ajax-complete");var aq=C("#enable-referencing-schedulable").addClass("ajax-loading");E(aj,ac,true,ak).done(function(){am.resolve();aq.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){am.reject();aq.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){am.reject();ao.removeClass("ajax-loading").addClass("ajax-error")})}).fail(function(){am.reject();ag.removeClass("ajax-loading").addClass("ajax-error")})}else{an.done(function(){am.resolve();ag.removeClass("ajax-loading").addClass("ajax-complete")}).fail(function(){am.reject();ag.removeClass("ajax-loading").addClass("ajax-error")})}}).always(function(){h(aj,af);ah();if(ad===true&&C("#nf-ok-dialog").not(":visible")){j.showOkDialog({headerText:"Controller Service",dialogContent:"The request to enable has been canceled. Parts of this request may have already completed. Please verify the state of this service and all referencing components."})}})};var J=function(ab){var aa=C("#controller-service-configuration").data("controllerServiceDetails");return C.ajax({type:"GET",url:aa.uri+"/descriptors",data:{propertyName:ab},dataType:"json"}).fail(d.handleAjaxError)};var Q=function(aa){return C.Deferred(function(ab){C("#controller-service-properties").propertytable("saveRow");if(G()){j.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){ab.resolve()},yesHandler:function(){var ac=C("#controller-service-configuration").data("controllerServiceDetails");x(aa,ac).done(function(){ab.resolve()}).fail(function(){ab.reject()})}})}else{ab.resolve()}}).promise()};var x=function(ac,aa){var ad=n();if(b(ad)){ad.revision=g.getRevision(aa);var ab=[];C.each(p(aa.component),function(af,ah){var ae=!S.isUndefined(ad.component.properties)&&!S.isUndefined(ad.component.properties[ah.name]);var ag=S.isDefinedAndNotNull(aa.component.properties[ah.name]);if(ae&&ag){ab.push(aa.component.properties[ah.name])}});return C.ajax({type:"PUT",data:JSON.stringify(ad),url:aa.uri,dataType:"json",contentType:"application/json"}).done(function(ae){O(ac,ae);C.each(ab,function(af,ag){Y(ac,ag)})}).fail(w)}else{return C.Deferred(function(ae){ae.reject()}).promise()}};var p=function(ab){var aa=[];C.each(ab.descriptors,function(ac,ad){if(S.isDefinedAndNotNull(ad.identifiesControllerService)){aa.push(ad)}});return aa};var u=function(ab){var aa=[];C.each(p(ab),function(ac,ad){var ae=ab.properties[ad.name];if(S.isDefinedAndNotNull(ae)&&C.trim(ae).length>0){aa.push(ae)}});return aa};var W;var T={init:function(aa){N=aa;C("#controller-service-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"controller-service-standard-settings-tab-content"},{name:"Properties",tabContentId:"controller-service-properties-tab-content"},{name:"Comments",tabContentId:"controller-service-comments-tab-content"}],select:function(){c.removeAllPropertyDetailDialogs();if(C(this).text()==="Properties"){C("#controller-service-properties").propertytable("resetTableSize")}C("#controller-service-properties").propertytable("saveRow");var ab=C("#controller-service-referencing-components");V(ab)}});C("#controller-service-configuration").modal({headerText:"Configure Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ab=C("#controller-service-referencing-components");S.cleanUpTooltips(ab,"div.referencing-component-state");S.cleanUpTooltips(ab,"div.referencing-component-bulletins");ab.css("border-width","0").empty();C("#controller-service-properties").propertytable("cancelEdit");C("#controller-service-properties").propertytable("clear");S.clearField("read-only-controller-service-comments");C("#controller-service-compatible-apis").empty();C("#controller-service-configuration").removeData("controllerServiceDetails")},open:function(){S.toggleScrollable(C("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});C("#disable-controller-service-dialog").modal({headerText:"Disable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ac=C(this);C("#disable-controller-service-scope-container").show();C("#disable-controller-service-progress-container").hide();C("#disable-controller-service-id").text("");C("#disable-controller-service-name").text("");C("#disable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();S.cleanUpTooltips(C("#disable-controller-service-service-container"),"#disable-controller-service-bulletins");C("div.disable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var ab=C("#disable-controller-service-referencing-components");S.cleanUpTooltips(ab,"div.referencing-component-state");S.cleanUpTooltips(ab,"div.referencing-component-bulletins");ab.css("border-width","0").empty()}}});C("#enable-controller-service-scope").combo({options:[{text:"Service only",value:M.serviceOnly,description:"Enable only this controller service"},{text:"Service and referencing components",value:M.serviceAndReferencingComponents,description:"Enable this controller service and enable/start all referencing components"}]});C("#enable-controller-service-dialog").modal({headerText:"Enable Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){var ac=C(this);C("#enable-controller-service-scope-container").show();C("#enable-controller-service-progress-container").hide();C("#enable-controller-service-progress li.referencing-component").show();C("#enable-controller-service-id").text("");C("#enable-controller-service-name").text("");C("#enable-controller-service-bulletins").removeClass("has-bulletins").removeData("bulletins").hide();S.cleanUpTooltips(C("#enable-controller-service-service-container"),"#enable-controller-service-bulletins");C("div.enable-referencing-components").removeClass("ajax-loading ajax-complete ajax-error");var ab=C("#enable-controller-service-referencing-components");S.cleanUpTooltips(ab,"div.referencing-component-state");S.cleanUpTooltips(ab,"div.referencing-component-bulletins");ab.css("border-width","0").empty()}}})},showConfiguration:function(ad,ab){if(S.isUndefined(W)){W=ad}var ac=C("#controller-service-configuration");if(ac.data("mode")!==M.edit||W!==ad){C("#controller-service-configuration .controller-service-read-only").hide();C("#controller-service-configuration .controller-service-editable").show();C("#controller-service-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-controller-service-property-container",descriptorDeferred:J,controllerServiceCreatedDeferred:function(ag){var af;var ah=ag.component;if(S.isDefinedAndNotNull(ah.parentGroupId)){af=M.urls.api+"/flow/process-groups/"+encodeURIComponent(ah.parentGroupId)+"/controller-services"}else{af=M.urls.api+"/flow/controller/controller-services"}return N.loadControllerServices(af,ad)},goToServiceDeferred:function(){return Q(ad)}});ac.data("mode",M.edit)}W=ad;var ae=C.ajax({type:"GET",url:ab.uri,dataType:"json"});var aa=C.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ab.id),dataType:"json"});C.when(ae,aa).done(function(ak,aj){ab=ak[0];var ag=ab.component;var al=aj[0].componentHistory;ac.data("controllerServiceDetails",ab);S.populateField("controller-service-id",ag.id);S.populateField("controller-service-type",S.formatType(ag));S.populateField("controller-service-bundle",S.formatBundle(ag.bundle));C("#controller-service-name").val(ag.name);C("#controller-service-comments").val(ag.comments);if(!S.isEmpty(ag.controllerServiceApis)){var af=S.getFormattedServiceApis(ag.controllerServiceApis);var ai=S.formatUnorderedList(af);C("#controller-service-compatible-apis").append(ai)}else{C("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ah=C("#controller-service-referencing-components");L(ad,ah,ag.referencingComponents);var am=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){C("#controller-service-properties").propertytable("saveRow");x(ad,ab).done(function(an){f(ad,an.component);ac.modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac.modal("hide")}}}];if(S.isDefinedAndNotNull(ag.customUiUrl)&&ag.customUiUrl!==""){am.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var an=function(){ac.modal("hide");C("#shell-close-button").click();z.showCustomUi(ab,ag.customUiUrl,true).done(function(){h(ad,ag);H.showSettings()})};C("#controller-service-properties").propertytable("saveRow");if(G()){j.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:an,yesHandler:function(){x(ad,ab).done(function(){an()})}})}else{an()}}}})}ac.modal("setButtonModel",am);C("#controller-service-properties").propertytable("setGroupId",ag.parentGroupId).propertytable("loadProperties",ag.properties,ag.descriptors,al.propertyHistory);ac.modal("show");V(ah);C("#controller-service-properties").propertytable("resetTableSize")}).fail(d.handleAjaxError)},showDetails:function(ad,ab){var ac=C("#controller-service-configuration");if(ac.data("mode")!==M.readOnly){C("#controller-service-configuration .controller-service-read-only").show();C("#controller-service-configuration .controller-service-editable").hide();C("#controller-service-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});ac.data("mode",M.readOnly)}var ae=C.ajax({type:"GET",url:ab.uri,dataType:"json"});var aa=C.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(ab.id),dataType:"json"});C.when(ae,aa).done(function(ak,aj){ab=ak[0];var ag=ab.component;var al=aj[0].componentHistory;ac.data("controllerServiceDetails",ab);S.populateField("controller-service-id",ag.id);S.populateField("controller-service-type",S.formatType(ag));S.populateField("controller-service-bundle",S.formatBundle(ag.bundle));S.populateField("read-only-controller-service-name",ag.name);S.populateField("read-only-controller-service-comments",ag.comments);if(!S.isEmpty(ag.controllerServiceApis)){var af=S.getFormattedServiceApis(ag.controllerServiceApis);var ai=S.formatUnorderedList(af);C("#controller-service-compatible-apis").append(ai)}else{C("#controller-service-compatible-apis").append('<span class="unset">None</span>')}var ah=C("#controller-service-referencing-components");L(ad,ah,ag.referencingComponents);var am=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){ac.modal("hide")}}}];if(S.isDefinedAndNotNull(z)&&S.isDefinedAndNotNull(ag.customUiUrl)&&ag.customUiUrl!==""){am.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){ac.modal("hide");C("#shell-close-button").click();z.showCustomUi(ab,ag.customUiUrl,false).done(function(){H.showSettings()})}}})}ac.modal("setButtonModel",am);C("#controller-service-properties").propertytable("loadProperties",ag.properties,ag.descriptors,al.propertyHistory);ac.modal("show");V(ah);C("#controller-service-properties").propertytable("resetTableSize")})},enable:function(ab,aa){B(ab,aa.component)},disable:function(ab,aa){y(ab,aa.component)},reloadReferencedServices:function(ab,aa){C.each(u(aa),function(ac,ad){Y(ab,ad)})},promptToDeleteController:function(ab,aa){j.showYesNoDialog({headerText:"Delete Controller Service",dialogContent:"Delete controller service '"+S.escapeHtml(aa.component.name)+"'?",yesHandler:function(){T.remove(ab,aa)}})},remove:function(ac,aa){var ab=g.getRevision(aa);C.ajax({type:"DELETE",url:aa.uri+"?"+C.param({version:ab.version,clientId:ab.clientId}),dataType:"json"}).done(function(ad){var ae=ac.data("gridInstance");var af=ae.getData();af.deleteItem(aa.id);if(aa.permissions.canRead){f(ac,aa.component)}}).fail(d.handleAjaxError)}};return T}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","Slick","nf.Client","nf.Shell","nf.ProcessGroupConfiguration","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common","nf.ControllerService","nf.ProcessGroup","nf.PolicyManagement","nf.ComponentState","nf.ComponentVersion","nf.ng.Bridge"],function(k,q,h,r,f,e,i,n,j,g,m,d,o,p,c,l){return(nf.ControllerServices=b(k,q,h,r,f,e,i,n,j,g,m,d,o,p,c,l))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ControllerServices=b(require("jquery"),require("d3"),require("Slick"),require("nf.Client"),require("nf.Shell"),require("nf.ProcessGroupConfiguration"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common"),require("nf.ControllerService"),require("nf.ProcessGroup"),require("nf.PolicyManagement"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.ng.Bridge")))}else{nf.ControllerServices=b(a.$,a.d3,a.Slick,a.nf.Client,a.nf.Shell,a.nf.ProcessGroupConfiguration,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common,a.nf.ControllerService,a.nf.ProcessGroup,a.nf.PolicyManagement,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.ng.Bridge)}}}(this,function(w,G,a,f,E,z,I,b,i,F,H,t,r,c,p,m){var h=null;var j=false;var A={urls:{api:"../nifi-api",controllerServiceTypes:"../nifi-api/flow/controller-service-types"}};var v={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var k=function(L){return F.isBlank(L.usageRestriction)||F.canAccessRestrictedComponents()};var e=function(){return w("#controller-service-type-filter").val()};var x=function(){var L=w("#controller-service-types-table").data("gridInstance");if(F.isDefinedAndNotNull(L)){var M=L.getData();M.setFilterArgs({searchString:e()});M.refresh();w("#new-controller-service-dialog").modal("refreshButtons");if(M.getLength()>0){L.setSelectedRows([0])}}};var y=function(){w("#controller-service-type-description").attr("title","").text("");w("#controller-service-type-name").attr("title","").text("");w("#controller-service-type-bundle").attr("title","").text("");w("#selected-controller-service-name").text("");w("#selected-controller-service-type").text("").removeData("bundle");w("#controller-service-description-container").hide()};var s=function(){y();var L=w("#controller-service-types-table").data("gridInstance");L.resetActiveCell()};var D=function(T,O){var R=K(T,O);var N=true;if(R){var S=w("#controller-service-tag-cloud").tagcloud("getSelectedTags");var Q=S.length>0;if(Q){N=n(S,T.tags)}}var P=true;if(R&&N){var L=w("#controller-service-bundle-group-combo").combo("getSelectedOption");if(F.isDefinedAndNotNull(L)&&L.value!==""){P=(T.bundle.group===L.value)}}var M=R&&N&&P;if(M===false&&w("#selected-controller-service-type").text()===T.type){s()}return M};var K=function(N,M){if(M.searchString===""){return true}try{var Q=new RegExp(M.searchString,"i")}catch(P){return false}var O=N.label.search(Q)>=0;var L=N.tags.search(Q)>=0;return O||L};var n=function(N,L){var M=[];w.each(N,function(Q,R){M.push(R)});var O=L.toLowerCase();var P=true;w.each(M,function(Q,R){if(O.indexOf(R)===-1){P=false;return false}});return P};var C=function(L,O){var N=w("#selected-controller-service-type").text();var M=w("#selected-controller-service-type").data("bundle");if(N===""){i.showOkDialog({headerText:"Controller Service",dialogContent:"The type of controller service to create must be selected."})}else{o(L,O,N,M)}};var o=function(M,P,O,Q){var L={revision:f.getRevision({revision:{version:0}}),component:{type:O,bundle:Q}};var N=w.ajax({type:"POST",url:M,data:JSON.stringify(L),dataType:"json",contentType:"application/json"}).done(function(R){var S=P.data("gridInstance");var U=S.getData();U.addItem(w.extend({type:"ControllerService",bulletins:[]},R));U.reSort();S.invalidate();var T=U.getRowById(R.id);S.setSelectedRows([T]);S.scrollRowIntoView(T)}).fail(b.handleAjaxError);w("#new-controller-service-dialog").modal("hide");return N};var l=function(){var N=[{id:"type",name:"Type",field:"label",formatter:F.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:F.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:F.genericValueFormatter}];var M=new a.Data.DataView({inlineFilters:false});M.setItems([]);M.setFilterArgs({searchString:e()});M.setFilter(D);F.sortType({columnId:"type",sortAsc:true},M);var L=new a.Grid("#controller-service-types-table",M,N,v);L.setSelectionModel(new a.RowSelectionModel());L.registerPlugin(new a.AutoTooltips());L.setSortColumn("type",true);L.onSort.subscribe(function(P,O){F.sortType({columnId:O.sortCol.field,sortAsc:O.sortAsc},M)});L.onSelectedRowsChanged.subscribe(function(T,Q){if(w.isArray(Q.rows)&&Q.rows.length===1){var O=Q.rows[0];var S=L.getDataItem(O);if(F.isDefinedAndNotNull(S)){w("#controller-service-description-container").show();if(F.isBlank(S.description)){w("#controller-service-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{w("#controller-service-type-description").width(w("#controller-service-description-container").innerWidth()-1).html(S.description).ellipsis()}var P=F.formatBundle(S.bundle);var R=F.formatType(S);w("#controller-service-type-name").text(R).attr("title",R);w("#controller-service-type-bundle").text(P).attr("title",P);w("#selected-controller-service-name").text(S.label);w("#selected-controller-service-type").text(S.type).data("bundle",S.bundle);w("#new-controller-service-dialog").modal("refreshButtons")}}});L.onViewportChanged.subscribe(function(P,O){F.cleanUpTooltips(w("#controller-service-types-table"),"div.view-usage-restriction");F.cleanUpTooltips(w("#controller-service-types-table"),"div.controller-service-apis")});M.onRowCountChanged.subscribe(function(P,O){L.updateRowCount();L.render();w("#displayed-controller-service-types").text(O.current)});M.onRowsChanged.subscribe(function(P,O){L.invalidateRows(O.rows);L.render()});M.syncGridSelection(L,true);w("#controller-service-types-table").data("gridInstance",L).on("mouseenter","div.slick-cell",function(U){var V=w(this).find("div.view-usage-restriction");if(V.length&&!V.data("qtip")){var T=w(this).find("span.row-id").text();var R=M.getItemById(T);if(F.isDefinedAndNotNull(R.usageRestriction)){V.qtip(w.extend({},F.config.tooltipConfig,{content:R.usageRestriction,position:{container:w("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}var Q=w(this).find("div.controller-service-apis");if(Q.length&&!Q.data("qtip")){var T=w(this).find("span.row-id").text();var R=M.getItemById(T);if(!F.isEmpty(R.controllerServiceApis)){var O=F.getFormattedServiceApis(R.controllerServiceApis);var P=F.formatUnorderedList(O);var S=w('<div style="padding: 4px;"><p>Supports Controller Services</p><br/></div>').append(P);Q.qtip(w.extend({},F.config.tooltipConfig,{content:S,position:{container:w("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});w.ajax({type:"GET",url:A.urls.controllerServiceTypes,dataType:"json"}).done(function(P){var S=0;var R=[];var O=G.set();M.beginUpdate();w.each(P.controllerServiceTypes,function(T,U){O.add(U.bundle.group);M.addItem({id:S++,label:F.substringAfterLast(U.type,"."),type:U.type,bundle:U.bundle,controllerServiceApis:U.controllerServiceApis,description:F.escapeHtml(U.description),usageRestriction:F.escapeHtml(U.usageRestriction),tags:U.tags.join(", ")});w.each(U.tags,function(W,V){R.push(V.toLowerCase())})});M.endUpdate();M.reSort();L.invalidate();w("#total-controller-service-types, #displayed-controller-service-types").text(P.controllerServiceTypes.length);w("#controller-service-tag-cloud").tagcloud({tags:R,select:x,remove:x});var Q=[{text:"all groups",value:""}];O.forEach(function(T){Q.push({text:T,value:T})});w("#controller-service-bundle-group-combo").combo({options:Q,select:x})}).fail(b.handleAjaxError);w("#new-controller-service-dialog").modal({headerText:"Add Controller Service",scrollableContentStyle:"scrollable",handler:{close:function(){y();w("#controller-service-type-filter").val("");w("#controller-service-tag-cloud").tagcloud("clearSelectedTags");w("#controller-service-bundle-group-combo").combo("setSelectedOption",{value:""});x();var O=w("#controller-service-types-table").data("gridInstance");O.setSelectedRows([]);O.resetActiveCell()},resize:function(){w("#controller-service-type-description").width(w("#controller-service-description-container").innerWidth()-1).text(w("#controller-service-type-description").attr("title")).ellipsis()}}})};var q=function(P,M,O,N,L){if(!L.permissions.canRead){return'<span class="blank">'+F.escapeHtml(L.id)+"</span>"}return F.escapeHtml(L.component.name)};var g=function(T,S,Q,N,M){if(!M.permissions.canRead){return""}if(F.isDefinedAndNotNull(M.component.parentGroupId)){var R=I.getSelection();if(R.empty()===false){var P=R.datum();if(P.id===M.component.parentGroupId){if(P.permissions.canRead){return F.escapeHtml(P.component.name)}else{return F.escapeHtml(P.id)}}}var L=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var O=M.component.parentGroupId;w.each(L,function(U,V){if(V.id===M.component.parentGroupId){O=V.label;return false}});return F.escapeHtml(O)}else{return"Controller"}};var u=function(L){var M=function(N){var Q=I.getSelection();if(Q.empty()===false){var P=Q.datum();if(P.id===N){return P.permissions.canWrite}}var O=m.injector.get("breadcrumbsCtrl").getBreadcrumbs();var R=false;w.each(O,function(S,T){if(T.id===N){R=T.permissions.canWrite;return false}});return R};if(F.isDefinedAndNotNull(L.component.parentGroupId)){return M(L.component.parentGroupId)}else{return F.canModifyController()}};var J=function(L,N){var M=function(V,U){if(V.permissions.canRead&&U.permissions.canRead){if(L.columnId==="moreDetails"){var R=0;if(!F.isEmpty(V.bulletins)){R=V.bulletins.length}var O=0;if(!F.isEmpty(U.bulletins)){O=U.bulletins.length}return R-O}else{if(L.columnId==="type"){var S=F.isDefinedAndNotNull(V.component[L.columnId])?F.substringAfterLast(V.component[L.columnId],"."):"";var Q=F.isDefinedAndNotNull(U.component[L.columnId])?F.substringAfterLast(U.component[L.columnId],"."):"";return S===Q?0:S>Q?1:-1}else{if(L.columnId==="state"){var T="Invalid";if(F.isEmpty(V.component.validationErrors)){T=F.isDefinedAndNotNull(V.component[L.columnId])?V.component[L.columnId]:""}var X="Invalid";if(F.isEmpty(U.component.validationErrors)){X=F.isDefinedAndNotNull(U.component[L.columnId])?U.component[L.columnId]:""}return T===X?0:T>X?1:-1}else{var P=F.isDefinedAndNotNull(V.component[L.columnId])?V.component[L.columnId]:"";var W=F.isDefinedAndNotNull(U.component[L.columnId])?U.component[L.columnId]:"";return P===W?0:P>W?1:-1}}}}else{if(!V.permissions.canRead&&!U.permissions.canRead){return 0}if(V.permissions.canRead){return 1}else{return -1}}};N.sort(M,L.sortAsc)};var B=function(R,L){var Q=function(aa,U,Z,W,T){if(!T.permissions.canRead){return""}var V='<div class="pointer view-controller-service fa fa-info-circle" title="View Details" style="margin-top: 5px; margin-right: 3px;" ></div>';V+='<div title="Usage" class="pointer controller-service-usage fa fa-book" style="margin-top: 5px; margin-right: 3px;" ></div>';var X=!F.isEmpty(T.component.validationErrors);var Y=!F.isEmpty(T.bulletins);if(X){V+='<div class="pointer has-errors fa fa-warning" style="margin-top: 4px; margin-right: 3px; float: left;" ></div>'}if(Y){V+='<div class="has-bulletins fa fa-sticky-note-o" style="margin-top: 5px; margin-right: 3px; float: left;"></div>'}if(X||Y){V+='<span class="hidden row-id">'+F.escapeHtml(T.id)+"</span>"}return V};var M=function(aa,U,Z,V,T){if(!T.permissions.canRead){return""}var Y="",W="";if(!F.isEmpty(T.component.validationErrors)){Y="invalid fa fa-warning";W="Invalid"}else{if(T.component.state==="DISABLED"){Y='disabled icon icon-enable-false"';W="Disabled"}else{if(T.component.state==="DISABLING"){Y='disabled icon icon-enable-false"';W="Disabling"}else{if(T.component.state==="ENABLED"){Y="enabled fa fa-flash";W="Enabled"}else{if(T.component.state==="ENABLING"){Y="enabled fa fa-flash";W="Enabling"}}}}}var X='<div layout="row"><div class="'+Y+'" style="margin-top: 5px;"></div>';return X+'<div class="status-text" style="margin-top: 4px;">'+W+"</div></div>"};var P=function(Z,U,Y,W,T){var V="";if(T.permissions.canRead&&T.permissions.canWrite){var X=false;if(F.isDefinedAndNotNull(T.component.parentGroupId)){if(T.component.parentGroupId===w("#process-group-id").text()){X=true}}else{X=true}if(X===true){if(T.component.state==="ENABLED"||T.component.state==="ENABLING"){V+='<div class="pointer disable-controller-service icon icon-enable-false" title="Disable" style="margin-top: 2px; margin-right: 3px;" ></div>'}else{if(T.component.state==="DISABLED"){V+='<div class="pointer edit-controller-service fa fa-pencil" title="Edit" style="margin-top: 2px; margin-right: 3px;" ></div>';if(F.isEmpty(T.component.validationErrors)){V+='<div class="pointer enable-controller-service fa fa-flash" title="Enable" style="margin-top: 2px; margin-right: 3px;"></div>'}if(T.component.multipleVersionsAvailable===true){V+='<div title="Change Version" class="pointer change-version-controller-service fa fa-exchange" style="margin-top: 2px; margin-right: 3px;" ></div>'}if(u(T)){V+='<div class="pointer delete-controller-service fa fa-trash" title="Remove" style="margin-top: 2px; margin-right: 3px;" ></div>'}}}if(T.component.persistsState===true){V+='<div title="View State" class="pointer view-state-controller-service fa fa-tasks" style="margin-top: 2px; margin-right: 3px;" ></div>'}}else{V+='<div class="pointer go-to-controller-service fa fa-long-arrow-right" title="Go To" style="margin-top: 2px; margin-right: 3px;" ></div>'}}if(I.isConfigurableAuthorizer()&&F.canAccessTenants()){V+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key" style="margin-top: 2px;"></div>'}return V};var O=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:Q,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",formatter:q,sortable:true,resizable:true},{id:"type",name:"Type",formatter:F.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:F.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"State",formatter:M,sortable:true,resizeable:true},{id:"parentGroupId",name:"Scope",formatter:g,sortable:true,resizeable:true}];O.push({id:"actions",name:"&nbsp;",resizable:false,formatter:P,sortable:false,width:90,maxWidth:90});var S=new a.Data.DataView({inlineFilters:false});S.setItems([]);J({columnId:"name",sortAsc:true},S);var N=new a.Grid(R,S,O,v);N.setSelectionModel(new a.RowSelectionModel());N.registerPlugin(new a.AutoTooltips());N.setSortColumn("name",true);N.onSort.subscribe(function(U,T){J({columnId:T.sortCol.id,sortAsc:T.sortAsc},S)});N.onClick.subscribe(function(W,U){var V=w(W.target);var T=S.getItem(U.row);if(N.getColumns()[U.cell].id==="actions"){if(V.hasClass("edit-controller-service")){H.showConfiguration(R,T)}else{if(V.hasClass("enable-controller-service")){H.enable(R,T)}else{if(V.hasClass("disable-controller-service")){H.disable(R,T)}else{if(V.hasClass("delete-controller-service")){H.promptToDeleteController(R,T)}else{if(V.hasClass("view-state-controller-service")){c.showState(T,T.state==="DISABLED")}else{if(V.hasClass("change-version-controller-service")){p.promptForVersionChange(T)}else{if(V.hasClass("edit-access-policies")){r.showControllerServicePolicy(T);w("#shell-close-button").click()}else{if(V.hasClass("go-to-controller-service")){t.enterGroup(T.component.parentGroupId);w.Deferred(function(X){if(w("#process-group-configuration").is(":visible")){z.loadConfiguration(T.component.parentGroupId).done(function(){X.resolve()})}else{z.showConfiguration(T.component.parentGroupId).done(function(){X.resolve()})}}).done(function(){z.selectControllerService(T.id)})}}}}}}}}}else{if(N.getColumns()[U.cell].id==="moreDetails"){if(V.hasClass("view-controller-service")){H.showDetails(R,T)}else{if(V.hasClass("controller-service-usage")){w("#shell-close-button").click();E.showPage("../nifi-docs/documentation?"+w.param({select:T.component.type,group:T.component.bundle.group,artifact:T.component.bundle.artifact,version:T.component.bundle.version})).done(function(){if(F.isDefinedAndNotNull(T.component.parentGroupId)){var X;var Y=t.get(T.component.parentGroupId);if(F.isDefinedAndNotNull(Y)){X=Y.id}else{X=I.getGroupId()}z.showConfiguration(X)}else{L()}})}}}}});S.onRowCountChanged.subscribe(function(U,T){N.updateRowCount();N.render()});S.onRowsChanged.subscribe(function(U,T){N.invalidateRows(T.rows);N.render()});S.syncGridSelection(N,true);R.data("gridInstance",N).on("mouseenter","div.slick-cell",function(aa){var X=w(this).find("div.has-errors");if(X.length&&!X.data("qtip")){var Z=w(this).find("span.row-id").text();var T=S.getItemById(Z);var W=F.formatUnorderedList(T.component.validationErrors);if(F.isDefinedAndNotNull(W)){X.qtip(w.extend({},F.config.tooltipConfig,{content:W,position:{target:"mouse",viewport:w("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var V=w(this).find("div.has-bulletins");if(V.length&&!V.data("qtip")){var U=w(this).find("span.row-id").text();var T=S.getItemById(U);var Y=F.getFormattedBulletins(T.bulletins);var W=F.formatUnorderedList(Y);if(F.isDefinedAndNotNull(W)){V.qtip(w.extend({},F.config.tooltipConfig,{content:W,position:{target:"mouse",viewport:w("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var d=function(L,M){return w.ajax({type:"GET",url:L,dataType:"json"}).done(function(N){var O=[];w.each(N.controllerServices,function(S,R){O.push(w.extend({type:"ControllerService",bulletins:[]},R))});F.cleanUpTooltips(M,"div.has-errors");F.cleanUpTooltips(M,"div.has-bulletins");var P=M.data("gridInstance");var Q=P.getData();Q.setItems(O);Q.reSort();P.invalidate();P.render()})};return{init:function(M,L){if(!j){l();j=true}B(M,L)},promptNewControllerService:function(M,O){var N=w("#controller-service-types-table").data("gridInstance");var L=N.getData();w("#controller-service-type-filter").off("keyup").on("keyup",function(S){var R=S.keyCode?S.keyCode:S.which;if(R===w.ui.keyCode.ENTER){var P=N.getSelectedRows();if(P.length>0){var Q=N.getDataItem(P[0]);if(k(Q)){C(M,O)}}}else{x()}});w("#new-controller-service-dialog").modal("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var P=N.getSelectedRows();if(P.length>0){var Q=N.getDataItem(P[0]);return k(Q)===false}else{return L.getLength()===0}},handler:{click:function(){C(M,O)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){w(this).modal("hide")}}}]).modal("show");if(h!==null){N.onDblClick.unsubscribe(h)}h=function(R,P){var Q=N.getDataItem(P.row);if(k(Q)){o(M,O,Q.type,Q.bundle)}};N.onDblClick.subscribe(h);N.resizeCanvas();if(L.getLength()>0){N.setSelectedRows([0])}w("#controller-service-type-filter").focus()},resetTableSize:function(M){var L=M.data("gridInstance");if(F.isDefinedAndNotNull(L)){L.resizeCanvas()}},loadControllerServices:function(L,M){return d(L,M)},setBulletins:function(P,M){var O=P.data("gridInstance");var Q=O.getData();Q.beginUpdate();if(!F.isEmpty(M)){var N=G.nest().key(function(R){return R.sourceId}).map(M,G.map);N.forEach(function(T,R){var S=Q.getItemById(T);if(F.isDefinedAndNotNull(S)){Q.updateItem(T,w.extend(S,{bulletins:R}))}})}else{var L=Q.getItems();w.each(L,function(S,R){Q.updateItem(R.id,w.extend(R,{bulletins:[]}))})}Q.endUpdate()}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.ErrorHandler","nf.Common","nf.Dialog","nf.Client","nf.ControllerService","nf.ControllerServices","nf.UniversalCapture","nf.CustomUi"],function(f,i,d,e,k,j,c,g,h){return(nf.ReportingTask=b(f,i,d,e,k,j,c,g,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ReportingTask=b(require("jquery"),require("nf.ErrorHandler"),require("nf.Common"),require("nf.Dialog"),require("nf.Client"),require("nf.ControllerService"),require("nf.ControllerServices"),require("nf.UniversalCapture"),require("nf.CustomUi")))}else{nf.ReportingTask=b(a.$,a.nf.ErrorHandler,a.nf.Common,a.nf.Dialog,a.nf.Client,a.nf.ControllerService,a.nf.ControllerServices,a.nf.UniversalCapture,a.nf.CustomUi)}}}(this,function(f,g,i,l,v,a,c,o,d){var s;var t={edit:"edit",readOnly:"read-only",urls:{api:"../nifi-api"}};var h=t.urls.api+"/flow/controller/controller-services";var b=function(){return f("#controller-services-table")};var n=function(A,x,y){if(A.status===400){var B=A.responseText.split("\n");var z;if(B.length===1){z=f("<span></span>").text(B[0])}else{z=i.formatUnorderedList(B)}l.showOkDialog({dialogContent:z,headerText:"Reporting Task"})}else{g.handleAjaxError(A,x,y)}};var w=function(){var y=f("#reporting-task-configuration").data("reportingTaskDetails");if(f("#reporting-task-name").val()!==y.component.name){return true}if(f("#reporting-task-comments").val()!==y.component.comments){return true}if(f("#reporting-task-enabled").hasClass("checkbox-checked")&&y.component.state==="DISABLED"){return true}else{if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")&&(y.component.state==="RUNNING"||y.component.state==="STOPPED")){return true}}var z=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;if(z!==(y.component.schedulingStrategy+"")){return true}var x;if(z==="CRON_DRIVEN"){x=f("#reporting-task-cron-driven-scheduling-period")}else{x=f("#reporting-task-timer-driven-scheduling-period")}if(i.isDefinedAndNotNull(x)&&x.val()!==(y.component.schedulingPeriod+"")){return true}return f("#reporting-task-properties").propertytable("isSaveRequired")};var j=function(){var y=f("#reporting-task-properties").propertytable("marshalProperties");var B=f("#reporting-task-scheduling-strategy-combo").combo("getSelectedOption").value;var x;if(B==="CRON_DRIVEN"){x=f("#reporting-task-cron-driven-scheduling-period")}else{x=f("#reporting-task-timer-driven-scheduling-period")}var A={};A.id=f("#reporting-task-id").text();A.name=f("#reporting-task-name").val();A.schedulingStrategy=B;A.schedulingPeriod=x.val();A.comments=f("#reporting-task-comments").val();if(f("#reporting-task-enabled").hasClass("checkbox-unchecked")){A.state="DISABLED"}else{if(f("#reporting-task-enabled").hasClass("checkbox-checked")){A.state="STOPPED"}}if(f.isEmptyObject(y)===false){A.properties=y}var z={};z.component=A;return z};var r=function(x){var z=[];var y=x.component;if(i.isBlank(y.schedulingPeriod)){z.push("Run schedule must be specified")}if(z.length>0){l.showOkDialog({dialogContent:i.formatUnorderedList(z),headerText:"Reporting Task"});return false}else{return true}};var q=function(y){var A=f("#reporting-tasks-table").data("gridInstance");var x=A.getData();var z=x.getItemById(y.id);x.updateItem(y.id,f.extend({type:"ReportingTask",bulletins:z.bulletins},y))};var e=function(z,y){var x={revision:v.getRevision(z),component:{id:z.id,state:y===true?"RUNNING":"STOPPED"}};return f.ajax({type:"PUT",url:z.uri,data:JSON.stringify(x),dataType:"json",contentType:"application/json"}).done(function(A){q(A);a.reloadReferencedServices(b(),A.component)}).fail(g.handleAjaxError)};var m=function(){return f.Deferred(function(x){f("#reporting-task-properties").propertytable("saveRow");if(w()){l.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before going to this Controller Service?",noHandler:function(){x.resolve()},yesHandler:function(){var y=f("#reporting-task-configuration").data("reportingTaskDetails");k(y).done(function(){x.resolve()}).fail(function(){x.reject()})}})}else{x.resolve()}}).promise()};var k=function(y){var x=j();if(r(x)){x.revision=v.getRevision(y);return f.ajax({type:"PUT",data:JSON.stringify(x),url:y.uri,dataType:"json",contentType:"application/json"}).done(function(z){q(z)}).fail(n)}else{return f.Deferred(function(z){z.reject()}).promise()}};var p=function(x){var y=f("#reporting-task-configuration").data("reportingTaskDetails");return f.ajax({type:"GET",url:y.uri+"/descriptors",data:{propertyName:x},dataType:"json"}).fail(g.handleAjaxError)};var u={init:function(x){s=x;f("#reporting-task-configuration-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"Settings",tabContentId:"reporting-task-standard-settings-tab-content"},{name:"Properties",tabContentId:"reporting-task-properties-tab-content"},{name:"Comments",tabContentId:"reporting-task-comments-tab-content"}],select:function(){o.removeAllPropertyDetailDialogs();if(f(this).text()==="Properties"){f("#reporting-task-properties").propertytable("resetTableSize")}f("#reporting-task-properties").propertytable("saveRow")}});f("#reporting-task-configuration").data("mode",t.edit).modal({scrollableContentStyle:"scrollable",headerText:"Configure Reporting Task",handler:{close:function(){f("#reporting-task-properties").propertytable("cancelEdit");f("#reporting-task-properties").propertytable("clear");i.clearField("read-only-reporting-task-comments");f("#reporting-task-configuration").removeData("reportingTaskDetails")},open:function(){i.toggleScrollable(f("#"+this.find(".tab-container").attr("id")+"-content").get(0))}}});f("#reporting-task-properties").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:p,controllerServiceCreatedDeferred:function(y){return c.loadControllerServices(h,f("#controller-services-table"))},goToServiceDeferred:m})},showConfiguration:function(y){var z=f("#reporting-task-configuration");if(z.data("mode")===t.readOnly){f("#reporting-task-configuration .reporting-task-read-only").hide();f("#reporting-task-configuration .reporting-task-editable").show();f("#reporting-task-properties").propertytable("destroy").propertytable({readOnly:false,supportsGoTo:true,dialogContainer:"#new-reporting-task-property-container",descriptorDeferred:p,controllerServiceCreatedDeferred:function(B){return c.loadControllerServices(h,f("#controller-services-table"))},goToServiceDeferred:m});z.data("mode",t.edit)}var A=f.ajax({type:"GET",url:y.uri,dataType:"json"});var x=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(y.id),dataType:"json"});f.when(A,x).done(function(D,I){y=D[0];var J=y.component;var C=I[0].componentHistory;f("#reporting-task-configuration").data("reportingTaskDetails",y);var G="checkbox-checked";if(J.state==="DISABLED"){G="checkbox-unchecked"}i.populateField("reporting-task-id",J.id);i.populateField("reporting-task-type",i.formatType(J));i.populateField("reporting-task-bundle",i.formatBundle(J.bundle));f("#reporting-task-name").val(J.name);f("#reporting-task-enabled").removeClass("checkbox-unchecked checkbox-checked").addClass(G);f("#reporting-task-comments").val(J.comments);var E=J.defaultSchedulingPeriod;var B=f("#reporting-task-cron-driven-scheduling-period").val(E.CRON_DRIVEN);var F=f("#reporting-task-timer-driven-scheduling-period").val(E.TIMER_DRIVEN);if(J.schedulingStrategy==="CRON_DRIVEN"){B.val(J.schedulingPeriod)}else{F.val(J.schedulingPeriod)}f("#reporting-task-scheduling-strategy-combo").combo({options:[{text:"Timer driven",value:"TIMER_DRIVEN",description:"Reporting task will be scheduled to run on an interval defined by the run schedule."},{text:"CRON driven",value:"CRON_DRIVEN",description:"Reporting task will be scheduled to run on at specific times based on the specified CRON string."}],selectedOption:{value:J.schedulingStrategy},select:function(K){if(K.value==="CRON_DRIVEN"){F.hide();B.show()}else{F.show();B.hide()}}});var H=[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){f("#reporting-task-properties").propertytable("saveRow");k(y).done(function(K){a.reloadReferencedServices(b(),K.component);f("#reporting-task-configuration").modal("hide")})}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#reporting-task-configuration").modal("hide")}}}];if(i.isDefinedAndNotNull(J.customUiUrl)&&J.customUiUrl!==""){H.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){var K=function(){f("#reporting-task-configuration").modal("hide");f("#shell-close-button").click();d.showCustomUi(y,J.customUiUrl,true).done(function(){u.reload(y.id).done(function(L){a.reloadReferencedServices(b(),L.reportingTask)});s.showSettings()})};f("#reporting-task-properties").propertytable("saveRow");if(w()){l.showYesNoDialog({headerText:"Save",dialogContent:"Save changes before opening the advanced configuration?",noHandler:K,yesHandler:function(){k(y).done(function(){K()})}})}else{K()}}}})}f("#reporting-task-configuration").modal("setButtonModel",H);f("#reporting-task-properties").propertytable("setGroupId",J.parentGroupId).propertytable("loadProperties",J.properties,J.descriptors,C.propertyHistory);f("#reporting-task-configuration").modal("show");f("#reporting-task-properties").propertytable("resetTableSize")}).fail(g.handleAjaxError)},showDetails:function(y){var z=f("#reporting-task-configuration");if(z.data("mode")===t.edit){f("#reporting-task-configuration .reporting-task-read-only").show();f("#reporting-task-configuration .reporting-task-editable").hide();f("#reporting-task-properties").propertytable("destroy").propertytable({supportsGoTo:true,readOnly:true});z.data("mode",t.readOnly)}var A=f.ajax({type:"GET",url:y.uri,dataType:"json"});var x=f.ajax({type:"GET",url:"../nifi-api/flow/history/components/"+encodeURIComponent(y.id),dataType:"json"});f.when(A,x).done(function(B,C){y=B[0];var G=y.component;var D=C[0].componentHistory;i.populateField("reporting-task-id",G.id);i.populateField("reporting-task-type",i.substringAfterLast(G.type,"."));i.populateField("reporting-task-bundle",i.formatBundle(G.bundle));i.populateField("read-only-reporting-task-name",G.name);i.populateField("read-only-reporting-task-comments",G.comments);var F=G.schedulingStrategy;if(F==="CRON_DRIVEN"){F="CRON driven"}else{F="Timer driven"}i.populateField("read-only-reporting-task-scheduling-strategy",F);i.populateField("read-only-reporting-task-scheduling-period",G.schedulingPeriod);var E=[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){z.modal("hide")}}}];if(i.isDefinedAndNotNull(d)&&i.isDefinedAndNotNull(G.customUiUrl)&&G.customUiUrl!==""){E.push({buttonText:"Advanced",clazz:"fa fa-cog button-icon",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){z.modal("hide");f("#shell-close-button").click();d.showCustomUi(y,G.customUiUrl,false).done(function(){s.showSettings()})}}})}z.modal("setButtonModel",E).modal("show");f("#reporting-task-properties").propertytable("loadProperties",G.properties,G.descriptors,D.propertyHistory);z.modal("show");f("#reporting-task-properties").propertytable("resetTableSize")})},start:function(x){e(x,true)},stop:function(x){e(x,false)},reload:function(A){var z=f("#reporting-tasks-table").data("gridInstance");var x=z.getData();var y=x.getItemById(A);return f.ajax({type:"GET",url:y.uri,dataType:"json"}).done(function(B){q(B)}).fail(g.handleAjaxError)},promptToDeleteReportingTask:function(x){l.showYesNoDialog({headerText:"Delete Reporting Task",dialogContent:"Delete reporting task '"+i.escapeHtml(x.component.name)+"'?",yesHandler:function(){u.remove(x)}})},remove:function(y){var x=v.getRevision(y);f.ajax({type:"DELETE",url:y.uri+"?"+f.param({version:x.version,clientId:x.clientId}),dataType:"json"}).done(function(A){var B=f("#reporting-tasks-table").data("gridInstance");var z=B.getData();z.deleteItem(y.id)}).fail(g.handleAjaxError)}};return u}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","d3","nf.Client","nf.Dialog","nf.Common","nf.CanvasUtils","nf.ControllerServices","nf.ErrorHandler","nf.ReportingTask","nf.Shell","nf.ComponentState","nf.ComponentVersion","nf.PolicyManagement"],function(j,f,o,p,i,g,h,d,k,l,e,n,c,m){return(nf.Settings=b(j,f,o,p,i,g,h,d,k,l,e,n,c,m))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.Settings=b(require("jquery"),require("Slick"),require("d3"),require("nf.Client"),require("nf.Dialog"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ControllerServices"),require("nf.ErrorHandler"),require("nf.ReportingTask"),require("nf.Shell"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.PolicyManagement")))}else{nf.Settings=b(a.$,a.Slick,a.d3,a.nf.Client,a.nf.Dialog,a.nf.Common,a.nf.CanvasUtils,a.nf.ControllerServices,a.nf.ErrorHandler,a.nf.ReportingTask,a.nf.Shell,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.PolicyManagement)}}}(this,function(u,a,G,g,i,F,K,A,c,v,D,d,p,r){var y={urls:{api:"../nifi-api",controllerConfig:"../nifi-api/controller/config",reportingTaskTypes:"../nifi-api/flow/reporting-task-types",createReportingTask:"../nifi-api/controller/reporting-tasks",reportingTasks:"../nifi-api/flow/reporting-tasks"}};var t={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var o=function(){return u("#controller-services-table")};var k=function(N){var P=J();var O={revision:g.getRevision({revision:{version:N}}),component:P};u.ajax({type:"PUT",url:y.urls.controllerConfig,data:JSON.stringify(O),dataType:"json",contentType:"application/json"}).done(function(Q){i.showOkDialog({headerText:"Settings",dialogContent:"Settings successfully applied."});u("#settings-save").off("click").on("click",function(){k(Q.revision.version)})}).fail(c.handleAjaxError)};var h=function(){};var J=function(){var N={};N.maxTimerDrivenThreadCount=u("#maximum-timer-driven-thread-count-field").val();N.maxEventDrivenThreadCount=u("#maximum-event-driven-thread-count-field").val();return N};var M=function(P,O){if(O.searchString===""){return true}try{var S=new RegExp(O.searchString,"i")}catch(R){return false}var Q=P.label.search(S)>=0;var N=P.tags.search(S)>=0;return Q||N};var m=function(P,N){var O=[];u.each(P,function(S,T){O.push(T)});var Q=N.toLowerCase();var R=true;u.each(O,function(S,T){if(Q.indexOf(T)===-1){R=false;return false}});return R};var l=function(N){return F.isBlank(N.usageRestriction)||F.canAccessRestrictedComponents()};var q=function(R,O,Q,P,N){if(!N.permissions.canRead){return'<span class="blank">'+F.escapeHtml(N.id)+"</span>"}return F.escapeHtml(N.component.name)};var L=function(N,P){var O=function(X,W){if(X.permissions.canRead&&W.permissions.canRead){if(N.columnId==="moreDetails"){var T=0;if(!F.isEmpty(X.bulletins)){T=X.bulletins.length}var Q=0;if(!F.isEmpty(W.bulletins)){Q=W.bulletins.length}return T-Q}else{if(N.columnId==="type"){var U=F.isDefinedAndNotNull(X.component[N.columnId])?F.substringAfterLast(X.component[N.columnId],"."):"";var S=F.isDefinedAndNotNull(W.component[N.columnId])?F.substringAfterLast(W.component[N.columnId],"."):"";return U===S?0:U>S?1:-1}else{if(N.columnId==="state"){var V="Invalid";if(F.isEmpty(X.component.validationErrors)){V=F.isDefinedAndNotNull(X.component[N.columnId])?X.component[N.columnId]:""}var Z="Invalid";if(F.isEmpty(W.component.validationErrors)){Z=F.isDefinedAndNotNull(W.component[N.columnId])?W.component[N.columnId]:""}return V===Z?0:V>Z?1:-1}else{var R=F.isDefinedAndNotNull(X.component[N.columnId])?X.component[N.columnId]:"";var Y=F.isDefinedAndNotNull(W.component[N.columnId])?W.component[N.columnId]:"";return R===Y?0:R>Y?1:-1}}}}else{if(!X.permissions.canRead&&!W.permissions.canRead){return 0}if(X.permissions.canRead){return 1}else{return -1}}};P.sort(O,N.sortAsc)};var w=function(){return u("#reporting-task-type-filter").val()};var n=function(){var O=u("#reporting-task-types-table").data("gridInstance");if(F.isDefinedAndNotNull(O)){var N=O.getData();N.setFilterArgs({searchString:w()});N.refresh();u("#new-reporting-task-dialog").modal("refreshButtons");if(N.getLength()>0){O.setSelectedRows([0])}}};var I=function(){u("#reporting-task-type-description").attr("title","").text("");u("#reporting-task-type-name").attr("title","").text("");u("#reporting-task-type-bundle").attr("title","").text("");u("#selected-reporting-task-name").text("");u("#selected-reporting-task-type").text("").removeData("bundle");u("#reporting-task-description-container").hide()};var f=function(){I();var N=u("#reporting-task-types-table").data("gridInstance");N.resetActiveCell()};var B=function(V,Q){var T=M(V,Q);var P=true;if(T){var U=u("#reporting-task-tag-cloud").tagcloud("getSelectedTags");var S=U.length>0;if(S){P=m(U,V.tags)}}var R=true;if(T&&P){var N=u("#reporting-task-bundle-group-combo").combo("getSelectedOption");if(F.isDefinedAndNotNull(N)&&N.value!==""){R=(V.bundle.group===N.value)}}var O=T&&P&&R;if(O===false&&u("#selected-reporting-task-type").text()===V.type){f()}return O};var E=function(){var O=u("#selected-reporting-task-type").text();var N=u("#selected-reporting-task-type").data("bundle");if(O===""){i.showOkDialog({headerText:"Settings",dialogContent:"The type of reporting task to create must be selected."})}else{j(O,N)}};var j=function(N,P){var Q={revision:g.getRevision({revision:{version:0}}),component:{type:N,bundle:P}};var O=u.ajax({type:"POST",url:y.urls.createReportingTask,data:JSON.stringify(Q),dataType:"json",contentType:"application/json"}).done(function(S){var U=u("#reporting-tasks-table").data("gridInstance");var R=U.getData();R.addItem(u.extend({type:"ReportingTask",bulletins:[]},S));R.reSort();U.invalidate();var T=R.getRowById(S.id);U.setSelectedRows([T]);U.scrollRowIntoView(T)}).fail(c.handleAjaxError);u("#new-reporting-task-dialog").modal("hide");return O};var e=function(){u("#reporting-task-type-filter").on("keyup",function(U){var T=U.keyCode?U.keyCode:U.which;if(T===u.ui.keyCode.ENTER){var Q=u("#reporting-task-types-table").data("gridInstance");var R=Q.getSelectedRows();if(R.length>0){var S=Q.getDataItem(R[0]);if(l(S)){E()}}}else{n()}});var O=[{id:"type",name:"Type",field:"label",formatter:F.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:F.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:F.genericValueFormatter}];var N=new a.Data.DataView({inlineFilters:false});N.setItems([]);N.setFilterArgs({searchString:w()});N.setFilter(B);F.sortType({columnId:"type",sortAsc:true},N);var P=new a.Grid("#reporting-task-types-table",N,O,t);P.setSelectionModel(new a.RowSelectionModel());P.registerPlugin(new a.AutoTooltips());P.setSortColumn("type",true);P.onSort.subscribe(function(R,Q){F.sortType({columnId:Q.sortCol.field,sortAsc:Q.sortAsc},N)});P.onSelectedRowsChanged.subscribe(function(V,S){if(u.isArray(S.rows)&&S.rows.length===1){var U=S.rows[0];var Q=P.getDataItem(U);if(F.isDefinedAndNotNull(Q)){u("#reporting-task-description-container").show();if(F.isBlank(Q.description)){u("#reporting-task-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{u("#reporting-task-type-description").width(u("#reporting-task-description-container").innerWidth()-1).html(Q.description).ellipsis()}var R=F.formatBundle(Q.bundle);var T=F.formatType(Q);u("#reporting-task-type-name").text(T).attr("title",T);u("#reporting-task-type-bundle").text(R).attr("title",R);u("#selected-reporting-task-name").text(Q.label);u("#selected-reporting-task-type").text(Q.type).data("bundle",Q.bundle);u("#new-reporting-task-dialog").modal("refreshButtons")}}});P.onDblClick.subscribe(function(S,R){var Q=P.getDataItem(R.row);if(l(Q)){j(Q.type,Q.bundle)}});P.onViewportChanged.subscribe(function(R,Q){F.cleanUpTooltips(u("#reporting-task-types-table"),"div.view-usage-restriction")});N.onRowCountChanged.subscribe(function(R,Q){P.updateRowCount();P.render();u("#displayed-reporting-task-types").text(Q.current)});N.onRowsChanged.subscribe(function(R,Q){P.invalidateRows(Q.rows);P.render()});N.syncGridSelection(P,true);u("#reporting-task-types-table").data("gridInstance",P).on("mouseenter","div.slick-cell",function(S){var T=u(this).find("div.view-usage-restriction");if(T.length&&!T.data("qtip")){var R=u(this).find("span.row-id").text();var Q=N.getItemById(R);if(F.isDefinedAndNotNull(Q.usageRestriction)){T.qtip(u.extend({},F.config.tooltipConfig,{content:Q.usageRestriction,position:{container:u("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});u.ajax({type:"GET",url:y.urls.reportingTaskTypes,dataType:"json"}).done(function(R){var U=0;var T=[];var Q=G.set();N.beginUpdate();u.each(R.reportingTaskTypes,function(V,W){Q.add(W.bundle.group);N.addItem({id:U++,label:F.substringAfterLast(W.type,"."),type:W.type,bundle:W.bundle,description:F.escapeHtml(W.description),usageRestriction:F.escapeHtml(W.usageRestriction),tags:W.tags.join(", ")});u.each(W.tags,function(Y,X){T.push(X.toLowerCase())})});N.endUpdate();N.reSort();P.invalidate();u("#total-reporting-task-types, #displayed-reporting-task-types").text(R.reportingTaskTypes.length);u("#reporting-task-tag-cloud").tagcloud({tags:T,select:n,remove:n});var S=[{text:"all groups",value:""}];Q.forEach(function(V){S.push({text:V,value:V})});u("#reporting-task-bundle-group-combo").combo({options:S,select:n})}).fail(c.handleAjaxError);u("#new-reporting-task-dialog").modal({scrollableContentStyle:"scrollable",headerText:"Add Reporting Task",buttons:[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var Q=P.getSelectedRows();if(Q.length>0){var R=P.getDataItem(Q[0]);return l(R)===false}else{return P.getData().getLength()===0}},handler:{click:function(){E()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){u(this).modal("hide")}}}],handler:{close:function(){I();u("#reporting-task-type-filter").val("");u("#reporting-task-tag-cloud").tagcloud("clearSelectedTags");u("#reporting-task-bundle-group-combo").combo("setSelectedOption",{value:""});n();var Q=u("#reporting-task-types-table").data("gridInstance");Q.setSelectedRows([]);Q.resetActiveCell()},resize:function(){u("#reporting-task-type-description").width(u("#reporting-task-description-container").innerWidth()-1).text(u("#reporting-task-type-description").attr("title")).ellipsis()}}})};var b=function(){e();var R=function(aa,U,Z,W,T){if(!T.permissions.canRead){return""}var V='<div title="View Details" class="pointer view-reporting-task fa fa-info-circle"></div>';V+='<div title="Usage" class="pointer reporting-task-usage fa fa-book"></div>';var X=!F.isEmpty(T.component.validationErrors);var Y=!F.isEmpty(T.bulletins);if(X){V+='<div class="pointer has-errors fa fa-warning" ></div>'}if(Y){V+='<div class="has-bulletins fa fa-sticky-note-o"></div>'}if(X||Y){V+='<span class="hidden row-id">'+F.escapeHtml(T.component.id)+"</span>"}return V};var S=function(ab,aa,Z,V,T){if(!T.permissions.canRead){return""}var X="",Y="";if(!F.isEmpty(T.component.validationErrors)){Y="Invalid";X="invalid fa fa-warning"}else{if(T.component.state==="STOPPED"){Y="Stopped";X="fa fa-stop stopped"}else{if(T.component.state==="RUNNING"){Y="Running";X="fa fa-play running"}else{Y="Disabled";X="icon icon-enable-false disabled"}}}var W="";if(F.isDefinedAndNotNull(T.component.activeThreadCount)&&T.component.activeThreadCount>0){W="("+T.component.activeThreadCount+")"}var U='<div layout="row"><div class="'+X+'" style="margin-top: 3px;"></div>';return U+'<div class="status-text" style="margin-top: 4px;">'+F.escapeHtml(Y)+'</div><div style="float: left; margin-left: 4px;">'+F.escapeHtml(W)+"</div></div>"};var Q=function(Y,U,X,W,T){var V="";if(T.permissions.canRead&&T.permissions.canWrite){if(T.component.state==="RUNNING"){V+='<div title="Stop" class="pointer stop-reporting-task fa fa-stop" style="margin-top: 2px; margin-right: 3px;" ></div>'}else{if(T.component.state==="STOPPED"||T.component.state==="DISABLED"){V+='<div title="Edit" class="pointer edit-reporting-task fa fa-pencil" style="margin-top: 2px; margin-right: 3px;" ></div>';if(T.component.state==="STOPPED"&&F.isEmpty(T.component.validationErrors)){V+='<div title="Start" class="pointer start-reporting-task fa fa-play" style="margin-top: 2px; margin-right: 3px;"></div>'}if(T.component.multipleVersionsAvailable===true){V+='<div title="Change Version" class="pointer change-version-reporting-task fa fa-exchange" style="margin-top: 2px; margin-right: 3px;" ></div>'}if(F.canModifyController()){V+='<div title="Remove" class="pointer delete-reporting-task fa fa-trash" style="margin-top: 2px; margin-right: 3px;" ></div>'}}}if(T.component.persistsState===true){V+='<div title="View State" class="pointer view-state-reporting-task fa fa-tasks" style="margin-top: 2px; margin-right: 3px;" ></div>'}}if(K.isConfigurableAuthorizer()&&F.canAccessTenants()){V+='<div title="Access Policies" class="pointer edit-access-policies fa fa-key" style="margin-top: 2px;"></div>'}return V};var N=[{id:"moreDetails",name:"&nbsp;",resizable:false,formatter:R,sortable:true,width:90,maxWidth:90,toolTip:"Sorts based on presence of bulletins"},{id:"name",name:"Name",sortable:true,resizable:true,formatter:q},{id:"type",name:"Type",formatter:F.instanceTypeFormatter,sortable:true,resizable:true},{id:"bundle",name:"Bundle",formatter:F.instanceBundleFormatter,sortable:true,resizable:true},{id:"state",name:"Run Status",sortable:true,resizeable:true,formatter:S}];N.push({id:"actions",name:"&nbsp;",resizable:false,formatter:Q,sortable:false,width:90,maxWidth:90});var P=new a.Data.DataView({inlineFilters:false});P.setItems([]);L({columnId:"name",sortAsc:true},P);var O=new a.Grid("#reporting-tasks-table",P,N,t);O.setSelectionModel(new a.RowSelectionModel());O.registerPlugin(new a.AutoTooltips());O.setSortColumn("name",true);O.onSort.subscribe(function(U,T){L({columnId:T.sortCol.id,sortAsc:T.sortAsc},P)});O.onClick.subscribe(function(X,U){var W=u(X.target);var V=P.getItem(U.row);if(O.getColumns()[U.cell].id==="actions"){if(W.hasClass("edit-reporting-task")){v.showConfiguration(V)}else{if(W.hasClass("start-reporting-task")){v.start(V)}else{if(W.hasClass("stop-reporting-task")){v.stop(V)}else{if(W.hasClass("delete-reporting-task")){v.promptToDeleteReportingTask(V)}else{if(W.hasClass("view-state-reporting-task")){var T=V.component.state==="STOPPED"&&V.component.activeThreadCount===0;d.showState(V,T)}else{if(W.hasClass("change-version-reporting-task")){p.promptForVersionChange(V)}else{if(W.hasClass("edit-access-policies")){r.showReportingTaskPolicy(V);u("#shell-close-button").click()}}}}}}}}else{if(O.getColumns()[U.cell].id==="moreDetails"){if(W.hasClass("view-reporting-task")){v.showDetails(V)}else{if(W.hasClass("reporting-task-usage")){u("#shell-close-button").click();D.showPage("../nifi-docs/documentation?"+u.param({select:V.component.type,group:V.component.bundle.group,artifact:V.component.bundle.artifact,version:V.component.bundle.version})).done(function(){x.showSettings()})}}}}});P.onRowCountChanged.subscribe(function(U,T){O.updateRowCount();O.render()});P.onRowsChanged.subscribe(function(U,T){O.invalidateRows(T.rows);O.render()});P.syncGridSelection(O,true);u("#reporting-tasks-table").data("gridInstance",O).on("mouseenter","div.slick-cell",function(Z){var X=u(this).find("div.has-errors");if(X.length&&!X.data("qtip")){var T=u(this).find("span.row-id").text();var V=P.getItemById(T);var W=F.formatUnorderedList(V.component.validationErrors);if(F.isDefinedAndNotNull(W)){X.qtip(u.extend({},F.config.tooltipConfig,{content:W,position:{target:"mouse",viewport:u("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}var U=u(this).find("div.has-bulletins");if(U.length&&!U.data("qtip")){var T=u(this).find("span.row-id").text();var V=P.getItemById(T);var Y=F.getFormattedBulletins(V.bulletins);var W=F.formatUnorderedList(Y);if(F.isDefinedAndNotNull(W)){U.qtip(u.extend({},F.config.tooltipConfig,{content:W,position:{target:"mouse",viewport:u("#shell-container"),adjust:{x:8,y:8,method:"flipinvert flipinvert"}}}))}}})};var H=function(){var S=function(){u("#read-only-maximum-timer-driven-thread-count-field").addClass("unset").text("Unauthorized");u("#read-only-maximum-event-driven-thread-count-field").addClass("unset").text("Unauthorized")};var Q=function(T){if(T){u("#general-settings div.editable").show();u("#general-settings div.read-only").hide();u("#settings-save").show()}else{u("#general-settings div.editable").hide();u("#general-settings div.read-only").show();u("#settings-save").hide()}};var P=u.Deferred(function(T){u.ajax({type:"GET",url:y.urls.controllerConfig,dataType:"json"}).done(function(U){if(U.permissions.canWrite){u("#maximum-timer-driven-thread-count-field").removeClass("unset").val(U.component.maxTimerDrivenThreadCount);u("#maximum-event-driven-thread-count-field").removeClass("unset").val(U.component.maxEventDrivenThreadCount);Q(true);u("#settings-save").off("click").on("click",function(){k(U.revision.version)})}else{if(U.permissions.canRead){u("#read-only-maximum-timer-driven-thread-count-field").removeClass("unset").text(U.component.maxTimerDrivenThreadCount);u("#read-only-maximum-event-driven-thread-count-field").removeClass("unset").text(U.component.maxEventDrivenThreadCount)}else{S()}Q(false)}T.resolve()}).fail(function(W,U,V){if(W.status===403){S();Q(false);T.resolve()}else{T.reject(W,U,V)}})}).promise();var N=y.urls.api+"/flow/controller/controller-services";var O=A.loadControllerServices(N,o());var R=z();return u.when(P,O,R).done(function(V,U){var T=U[0];u("#settings-last-refreshed").text(T.currentTime)}).fail(c.handleAjaxError)};var z=function(){return u.ajax({type:"GET",url:y.urls.reportingTasks,dataType:"json"}).done(function(N){var R=[];u.each(N.reportingTasks,function(T,S){R.push(u.extend({type:"ReportingTask",bulletins:[]},S))});var P=u("#reporting-tasks-table");F.cleanUpTooltips(P,"div.has-errors");F.cleanUpTooltips(P,"div.has-bulletins");var O=P.data("gridInstance");var Q=O.getData();Q.setItems(R);Q.reSort();O.invalidate()})};var s=function(){D.showContent("#settings").done(function(){C()});u("#settings-tabs").find(".selected-tab").click();x.resetTableSize()};var C=function(){u("#settings-save").mouseout()};var x={init:function(){u("#settings-tabs").tabbs({tabStyle:"tab",selectedTabStyle:"selected-tab",scrollableTabContentStyle:"scrollable",tabs:[{name:"General",tabContentId:"general-settings-tab-content"},{name:"Controller Services",tabContentId:"controller-services-tab-content"},{name:"Reporting Tasks",tabContentId:"reporting-tasks-tab-content"}],select:function(){var N=u(this).text();if(N==="General"){u("#controller-cs-availability").hide();u("#new-service-or-task").hide();u("#settings-save").show()}else{var O=false;if(F.isDefinedAndNotNull(F.currentUser)){O=F.currentUser.controllerPermissions.canWrite===true}if(O){u("#new-service-or-task").show();u("div.controller-settings-table").css("top","32px");u("#new-service-or-task").attr("title",function(){if(N==="Controller Services"){u("#settings-save").hide();return"Create a new controller service"}else{if(N==="Reporting Tasks"){u("#settings-save").hide();return"Create a new reporting task"}}})}else{u("#new-service-or-task").hide();u("div.controller-settings-table").css("top","0")}if(N==="Controller Services"){u("#controller-cs-availability").show()}else{if(N==="Reporting Tasks"){u("#controller-cs-availability").hide()}}x.resetTableSize()}}});u("#settings-refresh-button").click(function(){H()});u("#new-service-or-task").on("click",function(){var P=u("#settings-tabs li.selected-tab").text();if(P==="Controller Services"){var O=y.urls.api+"/controller/controller-services";A.promptNewControllerService(O,o())}else{if(P==="Reporting Tasks"){u("#new-reporting-task-dialog").modal("show");var Q=u("#reporting-task-types-table").data("gridInstance");if(F.isDefinedAndNotNull(Q)){var N=Q.getData();Q.resizeCanvas();if(N.getLength()>0){Q.setSelectedRows([0])}}u("#reporting-task-type-filter").focus()}}});h();A.init(o(),x.showSettings);b()},resetTableSize:function(){A.resetTableSize(o());var N=u("#reporting-tasks-table").data("gridInstance");if(F.isDefinedAndNotNull(N)){N.resizeCanvas()}},showSettings:function(){return H().done(s)},loadSettings:function(){return H()},selectControllerService:function(N){var O=o().data("gridInstance");var P=O.getData();var Q=P.getRowById(N);O.setSelectedRows([Q]);O.scrollRowIntoView(Q);u("#settings-tabs").find("li:eq(1)").click()},selectReportingTask:function(N){var Q=u("#reporting-tasks-table").data("gridInstance");var O=Q.getData();var P=O.getRowById(N);Q.setSelectedRows([P]);Q.scrollRowIntoView(P);u("#settings-tabs").find("li:eq(2)").click()},setBulletins:function(P,N){if(u("#controller-services-table").data("gridInstance")){A.setBulletins(o(),P)}var O=u("#reporting-tasks-table").data("gridInstance");var R=O.getData();R.beginUpdate();if(!F.isEmpty(N)){var S=G.nest().key(function(T){return T.sourceId}).map(N,G.map);S.forEach(function(U,T){var V=R.getItemById(U);if(F.isDefinedAndNotNull(V)){R.updateItem(U,u.extend(V,{bulletins:T}))}})}else{var Q=R.getItems();u.each(Q,function(T,U){R.updateItem(U.id,u.extend(U,{bulletins:[]}))})}R.endUpdate()}};return x}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common"],function(c,d){return(nf.ng.BreadcrumbsCtrl=b(c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsCtrl=b(require("jquery"),require("nf.Common")))}else{nf.ng.BreadcrumbsCtrl=b(a.$,a.nf.Common)}}}(this,function(a,b){return function(e){function d(){this.breadcrumbs=[]}d.prototype={constructor:d,register:function(){if(e.breadcrumbsCtrl===undefined){e.register("breadcrumbsCtrl",c)}},generateBreadcrumbs:function(g){var f=g.id;if(g.permissions.canRead){f=g.breadcrumb.name}this.breadcrumbs.unshift(a.extend({label:f},g));if(b.isDefinedAndNotNull(g.parentBreadcrumb)){this.generateBreadcrumbs(g.parentBreadcrumb)}},resetBreadcrumbs:function(){this.breadcrumbs=[]},getBreadcrumbs:function(){return this.breadcrumbs},updateBreadcrumbsCss:function(f){a("#breadcrumbs").css(f)},resetScrollPosition:function(){var l=a("#data-flow-title-container");var i=l.position();var m=l.outerWidth();var k=i.left+m;var j=a("#breadcrumbs-right-border").width();var g=a("#data-flow-title-viewport");var h=g.width();var f=h-j;if(k>f){l.css("left",(i.left-(k-f))+"px")}else{l.css("left","10px")}},registerMouseWheelEvent:function(f){f.on("DOMMouseScroll mousewheel",function(s,l){if(b.isUndefinedOrNull(s.originalEvent)){return}var m=a("#data-flow-title-container");var g=m.position();var q=m.outerWidth();var j=g.left+q;var n=a("#breadcrumbs-right-border").width();var k=a("#data-flow-title-viewport");var i=k.width();var h=i-n;if(q>i){var p=false;var r=0;if(b.isDefinedAndNotNull(s.originalEvent.wheelDelta)){r=s.originalEvent.wheelDelta}else{if(b.isDefinedAndNotNull(s.originalEvent.detail)){r=-s.originalEvent.detail}}if(r>0&&j>h){var o=-25;p=true}else{if(r<0&&(g.left-n)<0){o=25;if(g.left+o>n){o=n-g.left}p=true}}if(p){m.css("left",(g.left+o)+"px")}}})}};var c=new d();c.register();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Storage","nf.Shell","nf.ErrorHandler"],function(e,f,d,c,g){return(nf.ng.Canvas.HeaderCtrl=b(e,f,d,c,g))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.HeaderCtrl=b(require("jquery"),require("nf.Common"),require("nf.Storage"),require("nf.Shell"),require("nf.ErrorHandler")))}else{nf.ng.Canvas.HeaderCtrl=b(a.$,a.nf.Common,a.nf.Storage,a.nf.Shell,a.nf.ErrorHandler)}}}(this,function(c,d,b,a,e){return function(k,m,f,i){var j=640;var h={urls:{accessConfig:"../nifi-api/access/config"}};function l(p,n,o){this.toolboxCtrl=p;this.globalMenuCtrl=n;this.flowStatusCtrl=o;this.loginCtrl={init:function(){var q=this;if(c("#current-user").text()!==d.ANONYMOUS_USER_TEXT||location.protocol==="http:"){c("#login-link-container").css("display","none")}if(location.protocol==="http:"){c("#current-user-container").css("display","none")}var r=c.ajax({type:"GET",url:h.urls.accessConfig,dataType:"json"});c.when(r).done(function(s){q.supportsLogin=s.config.supportsLogin}).fail(e.handleAjaxError)},supportsLogin:undefined,shell:{launch:function(){a.showPage("login",false)}}};this.logoutCtrl={logout:function(){b.removeItem("jwt");window.location="/nifi"}}}l.prototype={constructor:l,register:function(){if(k.headerCtrl===undefined){k.register("headerCtrl",g)}},init:function(){this.toolboxCtrl.init();this.globalMenuCtrl.init();this.flowStatusCtrl.init();this.loginCtrl.init()}};var g=new l(m,f,i);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.ToolboxCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.ToolboxCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.ToolboxCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(l,e,h,c,j,k,g,i){function f(m,p,r,q,n,t,s,o){this.processorComponent=m;this.inputPortComponent=p;this.outputPortComponent=r;this.groupComponent=q;this.remoteGroupComponent=n;this.funnelComponent=t;this.templateComponent=s;this.labelComponent=o;this.config={type:{processor:"Processor",inputPort:"Input Port",outputPort:"Output Port",processGroup:"Process Group",remoteProcessGroup:"Remote Process Group",connection:"Connection",funnel:"Funnel",template:"Template",label:"Label"},urls:{api:"../nifi-api",controller:"../nifi-api/controller",processorTypes:"../nifi-api/flow/processor-types"}}}f.prototype={constructor:f,init:function(){l.modal.init();e.modal.init();h.modal.init();c.modal.init();j.modal.init();g.modal.init()},draggableComponentConfig:function(m){m.getElement().hover(function(){m.getElement().removeClass(m.icon).addClass(m.hoverIcon)},function(){m.getElement().removeClass(m.hoverIcon).addClass(m.icon)});return{zIndex:1011,revert:true,revertDuration:0,cancel:false,containment:"body",cursor:"-webkit-grabbing",start:function(o,n){a.hide()},stop:function(r,q){var t=b.translateCanvasView();var s=b.scaleCanvasView();var p=r.originalEvent.pageX;var o=r.originalEvent.pageY-b.getCanvasOffset();if(p>=0&&o>=0){var n=(p/s)-(t[0]/s);var u=(o/s)-(t[1]/s);m.dropHandler.apply(m,[{x:n,y:u}])}},helper:m.dragIcon}}};var d=new f(l,e,h,c,j,k,g,i);return d}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.Dialog","nf.CanvasUtils","nf.ContextMenu","nf.ClusterSummary","nf.ErrorHandler","nf.Settings"],function(h,i,g,f,d,c,j,e){return(nf.ng.Canvas.FlowStatusCtrl=b(h,i,g,f,d,c,j,e))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.FlowStatusCtrl=b(require("jquery"),require("nf.Common"),require("nf.Dialog"),require("nf.CanvasUtils"),require("nf.ContextMenu"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Settings")))}else{nf.ng.Canvas.FlowStatusCtrl=b(a.$,a.nf.Common,a.nf.Dialog,a.nf.CanvasUtils,a.nf.ContextMenu,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Settings)}}}(this,function(f,g,e,d,b,a,h,c){return function(l){var i={search:"Search",urls:{search:"../nifi-api/flow/search-results",status:"../nifi-api/flow/status"}};function k(){this.connectedNodesCount="-";this.activeThreadCount="-";this.totalQueued="-";this.controllerTransmittingCount="-";this.controllerNotTransmittingCount="-";this.controllerRunningCount="-";this.controllerStoppedCount="-";this.controllerInvalidCount="-";this.controllerDisabledCount="-";this.statsLastRefreshed="-";this.search={getInputElement:function(){return f("#search-field")},getButtonElement:function(){return f("#search-button")},getSearchContainerElement:function(){return f("#search-container")},init:function(){var m=this;f.widget("nf.searchAutocomplete",f.ui.autocomplete,{reset:function(){this.term=null},_create:function(){this._super();this.widget().menu("option","items","> :not(.search-header, .search-no-matches)")},_resizeMenu:function(){var n=this.menu.element;n.width(400)},_normalize:function(o){var n=[];n.push(o);return n},_renderMenu:function(p,o){var n=this;var q=o[0];if(!g.isEmpty(q.processorResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-processor"></div>Processors</li>');f.each(q.processorResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.processGroupResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-group"></div>Process Groups</li>');f.each(q.processGroupResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.remoteProcessGroupResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-group-remote"></div>Remote Process Groups</li>');f.each(q.remoteProcessGroupResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.connectionResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-connect"></div>Connections</li>');f.each(q.connectionResults,function(s,r){n._renderItem(p,r)})}if(!g.isEmpty(q.inputPortResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-port-in"></div>Input Ports</li>');f.each(q.inputPortResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.outputPortResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-port-out"></div>Output Ports</li>');f.each(q.outputPortResults,function(r,s){n._renderItem(p,s)})}if(!g.isEmpty(q.funnelResults)){p.append('<li class="search-header"><div class="search-result-icon icon icon-funnel"></div>Funnels</li>');f.each(q.funnelResults,function(s,r){n._renderItem(p,r)})}if(p.children().length===0){p.append('<li class="unset search-no-matches">No results matched the search terms</li>')}},_renderItem:function(o,n){var p=f("<a></a>").append(f('<div class="search-match-header"></div>').text(n.name));f.each(n.matches,function(r,q){p.append(f('<div class="search-match"></div>').text(q))});return f("<li></li>").data("ui-autocomplete-item",n).append(p).appendTo(o)}});this.getInputElement().searchAutocomplete({appendTo:"#search-flow-results",position:{my:"right top",at:"right bottom",offset:"1 1"},source:function(o,n){f.ajax({type:"GET",data:{q:o.term},dataType:"json",url:i.urls.search}).done(function(p){n(p.searchResultsDTO)})},select:function(o,p){var n=p.item;d.showComponent(n.groupId,n.id);m.getInputElement().val("").blur();return false},open:function(n,o){var p=f(this);f('<div class="search-glass-pane"></div>').one("click",function(){}).appendTo("body")},close:function(n,o){f(this).searchAutocomplete("reset");m.getInputElement().val("");f("div.search-glass-pane").remove()}});m.toggleSearchField()},toggleSearchField:function(){var p=this;b.hide();var m=p.getInputElement().is(":visible");var q="none";var o="search-container-opened";var n="search-container-closed";if(!m){p.getButtonElement().css("background-color","#FFFFFF");q="inline-block";o="search-container-closed";n="search-container-opened"}else{p.getInputElement().css("display",q)}this.getSearchContainerElement().switchClass(o,n,500,function(){p.getInputElement().css("display",q);if(!m){p.getButtonElement().css("background-color","#FFFFFF");p.getInputElement().focus()}else{p.getButtonElement().css("background-color","#E3E8EB")}})}};this.bulletins={update:function(m){var o=f("#bulletin-button");var q=o.data("bulletins");if(g.doBulletinsDiffer(q,m.bulletins)){o.data("bulletins",m.bulletins);var p=g.getFormattedBulletins(m.bulletins);if(p.length===0){if(o.data("qtip")){o.removeClass("has-bulletins").qtip("api").destroy(true)}}else{var n=g.formatUnorderedList(p);if(o.data("qtip")){o.qtip("option","content.text",n)}else{o.addClass("has-bulletins").qtip(f.extend({},d.config.systemTooltipConfig,{content:n,position:{at:"bottom left",my:"top right",adjust:{x:4}}}))}}}c.setBulletins(m.controllerServiceBulletins,m.reportingTaskBulletins)}}}k.prototype={constructor:k,init:function(){this.search.init()},reloadFlowStatus:function(){var m=this;return f.ajax({type:"GET",url:i.urls.status,dataType:"json"}).done(function(n){if(g.isDefinedAndNotNull(n.controllerStatus)){m.update(n.controllerStatus)}}).fail(h.handleAjaxError)},updateClusterSummary:function(o){if(a.isConnectedToCluster()!==o.connectedToCluster){if(o.connectedToCluster){e.showConnectedToClusterMessage()}else{e.showDisconnectedFromClusterMessage()}}var n="#728E9B";if(o.connectedToCluster){if(g.isDefinedAndNotNull(o.connectedNodes)){var m=o.connectedNodes.split(" / ");if(m.length===2&&m[0]!==m[1]){this.clusterConnectionWarning=true;n="#BA554A"}}this.connectedNodesCount=g.isDefinedAndNotNull(o.connectedNodes)?o.connectedNodes:"-"}else{this.connectedNodesCount="Disconnected";n="#BA554A"}f("#connected-nodes-count").closest("div.fa-cubes").css("color",n)},update:function(m){var n=(g.isDefinedAndNotNull(m.invalidCount))?m.invalidCount:0;if(this.controllerInvalidCount>0){f("#controller-invalid-count").parent().removeClass("zero").addClass("invalid")}else{f("#controller-invalid-count").parent().removeClass("invalid").addClass("zero")}this.activeThreadCount=m.activeThreadCount;if(this.activeThreadCount>0){f("#flow-status-container").find(".icon-threads").removeClass("zero")}else{f("#flow-status-container").find(".icon-threads").addClass("zero")}this.totalQueued=m.queued;if(this.totalQueued.indexOf("0 / 0")>=0){f("#flow-status-container").find(".fa-list").addClass("zero")}else{f("#flow-status-container").find(".fa-list").removeClass("zero")}this.controllerTransmittingCount=g.isDefinedAndNotNull(m.activeRemotePortCount)?m.activeRemotePortCount:"-";if(this.controllerTransmittingCount>0){f("#flow-status-container").find(".fa-bullseye").removeClass("zero").addClass("transmitting")}else{f("#flow-status-container").find(".fa-bullseye").removeClass("transmitting").addClass("zero")}this.controllerNotTransmittingCount=g.isDefinedAndNotNull(m.inactiveRemotePortCount)?m.inactiveRemotePortCount:"-";if(this.controllerNotTransmittingCount>0){f("#flow-status-container").find(".icon-transmit-false").removeClass("zero").addClass("not-transmitting")}else{f("#flow-status-container").find(".icon-transmit-false").removeClass("not-transmitting").addClass("zero")}this.controllerRunningCount=g.isDefinedAndNotNull(m.runningCount)?m.runningCount:"-";if(this.controllerRunningCount>0){f("#flow-status-container").find(".fa-play").removeClass("zero").addClass("running")}else{f("#flow-status-container").find(".fa-play").removeClass("running").addClass("zero")}this.controllerStoppedCount=g.isDefinedAndNotNull(m.stoppedCount)?m.stoppedCount:"-";if(this.controllerStoppedCount>0){f("#flow-status-container").find(".fa-stop").removeClass("zero").addClass("stopped")}else{f("#flow-status-container").find(".fa-stop").removeClass("stopped").addClass("zero")}this.controllerInvalidCount=g.isDefinedAndNotNull(m.invalidCount)?m.invalidCount:"-";if(this.controllerInvalidCount>0){f("#flow-status-container").find(".fa-warning").removeClass("zero").addClass("invalid")}else{f("#flow-status-container").find(".fa-warning").removeClass("invalid").addClass("zero")}this.controllerDisabledCount=g.isDefinedAndNotNull(m.disabledCount)?m.disabledCount:"-";if(this.controllerDisabledCount>0){f("#flow-status-container").find(".icon-enable-false").removeClass("zero").addClass("disabled")}else{f("#flow-status-container").find(".icon-enable-false").removeClass("disabled").addClass("zero")}},updateBulletins:function(m){this.bulletins.update(m)}};var j=new k();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Common","nf.QueueListing","nf.Shell","nf.PolicyManagement","nf.ClusterSummary","nf.ErrorHandler","nf.Settings","nf.CanvasUtils"],function(g,e,k,c,j,i,h,f,d){return(nf.ng.Canvas.GlobalMenuCtrl=b(g,e,k,c,j,i,h,f,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GlobalMenuCtrl=b(require("jquery"),require("nf.Common"),require("nf.QueueListing"),require("nf.Shell"),require("nf.PolicyManagement"),require("nf.ClusterSummary"),require("nf.ErrorHandler"),require("nf.Settings"),require("nf.CanvasUtils")))}else{nf.ng.Canvas.GlobalMenuCtrl=b(a.$,a.nf.Common,a.nf.QueueListing,a.nf.Shell,a.nf.PolicyManagement,a.nf.ClusterSummary,a.nf.ErrorHandler,a.nf.Settings,a.nf.CanvasUtils)}}}(this,function(e,c,i,a,h,g,f,d,b){return function(m){var k={urls:{helpDocument:"../nifi-docs/documentation",controllerAbout:"../nifi-api/flow/about"}};function l(n){this.summary={shell:{launch:function(){a.showPage("summary")}}};this.counters={shell:{launch:function(){if(c.canAccessCounters()){a.showPage("counters")}}}};this.bulletinBoard={shell:{launch:function(){a.showPage("bulletin-board")}}};this.dataProvenance={shell:{launch:function(){if(c.canAccessProvenance()){a.showPage("provenance")}}}};this.controllerSettings={shell:{launch:function(){d.showSettings()}}};this.cluster={visible:function(){return g.isConnectedToCluster()},shell:{launch:function(){if(c.canAccessController()){a.showPage("cluster")}}}};this.flowConfigHistory={shell:{launch:function(){a.showPage("history")}}};this.users={shell:{launch:function(){if(c.canAccessTenants()){a.showPage("users")}}}};this.policies={shell:{launch:function(){if(c.canModifyPolicies()&&c.canAccessTenants()){h.showGlobalPolicies()}}}};this.templates={shell:{launch:function(){a.showPage("templates?"+e.param({groupId:b.getGroupId()}))}}};this.help={shell:{launch:function(){a.showPage(k.urls.helpDocument)}}};this.about={init:function(){e.ajax({type:"GET",url:k.urls.controllerAbout,dataType:"json"}).done(function(q){var o=q.about;document.title=o.title;e("#nf-version").text(o.version);var p=false;if(o.buildTag&&o.buildTag!=="HEAD"){e("#nf-about-build-tag").text(o.buildTag);e("#nf-version-detail-tag").show();p=true}if(o.buildRevision){e("#nf-about-build-revision").text(o.buildRevision);e("#nf-about-build-branch").text(o.buildBranch);e("#nf-version-detail-commit").show();p=true}if(o.buildTimestamp){e("#nf-about-build-timestamp").text(o.buildTimestamp);e("#nf-version-detail-timestamp").show();p=true}if(p){e("#nf-version-detail").show()}if(!c.isBlank(o.contentViewerUrl)){e("#nifi-content-viewer-url").text(o.contentViewerUrl);i.initFlowFileDetailsDialog()}}).fail(f.handleAjaxError);this.modal.init()},modal:{getElement:function(){return e("#nf-about")},init:function(){var o=this;var p=function(){var q=e(this);var r=e("#nf-about-pic-container").height()+e(".dialog-header").height()+10;q.find(".dialog-content").css("top",r)};this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"About Apache NiFi",handler:{resize:p},buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){o.hide()}}}]})},update:function(p,o){this.getElement().modal(p,o)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}}l.prototype={constructor:l,init:function(){this.about.init()}};var j=new l();return j}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Actions","nf.Birdseye","nf.Storage","nf.CanvasUtils","nf.ProcessGroupConfiguration"],function(h,d,g,e,f,c){return(nf.ng.Canvas.GraphControlsCtrl=b(h,d,g,e,f,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.GraphControlsCtrl=b(require("jquery"),require("nf.Actions"),require("nf.Birdseye"),require("nf.Storage"),require("nf.CanvasUtils"),require("nf.ProcessGroupConfiguration")))}else{nf.ng.Canvas.GraphControlsCtrl=b(a.$,a.nf.Actions,a.nf.Birdseye,a.nf.Storage,a.nf.CanvasUtils,a.nf.ProcessGroupConfiguration)}}}(this,function(f,b,e,c,d,a){return function(m,i,l){var k=function(n){if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-docked").hide();f("#graph-controls div.graph-control-header-container").show();f(".graph-control").removeClass("docked")}n.children("div.graph-control-content").show();n.find("div.graph-control-expansion").removeClass("fa-plus-square-o").addClass("fa-minus-square-o");if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(true)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=true;c.setItem("graph-control-visibility",o)};var j=function(n){n.children("div.graph-control-content").hide();n.find("div.graph-control-expansion").removeClass("fa-minus-square-o").addClass("fa-plus-square-o");if(f("div.graph-control-content").is(":visible")===false){f("#graph-controls div.graph-control-header-container").hide();f("#graph-controls div.graph-control-docked").show();f(".graph-control").addClass("docked")}if(n.attr("id")==="navigation-control"){e.updateBirdseyeVisibility(false)}var o=c.getItem("graph-control-visibility");if(o===null){o={}}var p=n.attr("id");o[p]=false;c.setItem("graph-control-visibility",o)};function h(n,o){this.navigateCtrl=n;this.operateCtrl=o}h.prototype={constructor:h,register:function(){if(m.graphControlsCtrl===undefined){m.register("graphControlsCtrl",g)}},init:function(){this.operateCtrl.init();var n=c.getItem("graph-control-visibility");if(n!==null){f.each(n,function(q,o){var p=f("#"+q);if(p){if(o){k(p)}else{j(p)}}})}else{k(f("#navigation-control"));k(f("#operation-control"))}},undock:function(n){k(f(n.target).parent())},expand:function(n){var o=f(n.target);if(o.find(".fa-plus-square-o").length>0||o.hasClass("fa-plus-square-o")||o.parent().children().find(".fa-plus-square-o").length>0){k(o.closest("div.graph-control"))}else{j(o.closest("div.graph-control"))}},getContextIcon:function(){var n=d.getSelection();if(n.empty()){if(d.getParentGroupId()===null){return"icon-drop"}else{return"icon-group"}}else{if(n.size()===1){if(d.isProcessor(n)){return"icon-processor"}else{if(d.isProcessGroup(n)){return"icon-group"}else{if(d.isInputPort(n)){return"icon-port-in"}else{if(d.isOutputPort(n)){return"icon-port-out"}else{if(d.isRemoteProcessGroup(n)){return"icon-group-remote"}else{if(d.isFunnel(n)){return"icon-funnel"}else{if(d.isLabel(n)){return"icon-label"}else{if(d.isConnection(n)){return"icon-connect"}}}}}}}}}else{return"icon-drop"}}},hide:function(){var n=d.getSelection();if(n.size()>1){return"invisible"}else{return""}},getContextName:function(){var o=d.getSelection();var n=d.canReadFromGroup();if(o.empty()){if(n){return d.getGroupName()}else{return d.getGroupId()}}else{if(o.size()===1){var p=o.datum();if(p.permissions.canRead){if(d.isLabel(o)){if(f.trim(p.component.label)!==""){return p.component.label}else{return""}}else{if(d.isConnection(o)){return d.formatConnectionName(p.component)}else{return p.component.name}}}else{return p.id}}else{return"Multiple components selected"}}},getContextType:function(){var n=d.getSelection();if(n.empty()){return"Process Group"}else{if(n.size()===1){if(d.isProcessor(n)){return"Processor"}else{if(d.isProcessGroup(n)){return"Process Group"}else{if(d.isInputPort(n)){return"Input Port"}else{if(d.isOutputPort(n)){return"Output Port"}else{if(d.isRemoteProcessGroup(n)){return"Remote Process Group"}else{if(d.isFunnel(n)){return"Funnel"}else{if(d.isLabel(n)){return"Label"}else{if(d.isConnection(n)){return"Connection"}}}}}}}}}else{return"Multiple selected"}}},getContextId:function(){var n=d.getSelection();if(n.empty()){return d.getGroupId()}else{if(n.size()===1){var o=n.datum();return o.id}else{return"Multiple selected"}}},canConfigureOrOpenDetails:function(){var n=d.getSelection();if(n.empty()){return true}return d.isConfigurable(n)||d.hasDetails(n)},openConfigureOrDetailsView:function(){var n=d.getSelection();if(d.isConfigurable(n)){b.showConfiguration(n)}else{if(d.hasDetails(n)){b.showDetails(n)}}}};var g=new h(i,l);g.register();return g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.CanvasUtils","nf.ContextMenu"],function(d,c){return(nf.ng.Canvas.NavigateCtrl=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.NavigateCtrl=b(require("nf.CanvasUtils"),require("nf.ContextMenu")))}else{nf.ng.Canvas.NavigateCtrl=b(a.nf.CanvasUtils,a.nf.ContextMenu)}}}(this,function(b,a){return function(){function d(){this.zoomIn=function(){b.zoomCanvasViewIn();a.hide();b.refreshCanvasView({transition:true})};this.zoomOut=function(){b.zoomCanvasViewOut();a.hide();b.refreshCanvasView({transition:true})};this.zoomFit=function(){b.fitCanvasView();a.hide();b.refreshCanvasView({transition:true})};this.zoomActualSize=function(){b.actualSizeCanvasView();a.hide();b.refreshCanvasView({transition:true})}}d.prototype={constructor:d};var c=new d();return c}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","d3","nf.Dialog","nf.Birdseye","nf.CanvasUtils","nf.Common","nf.Client","nf.Processor"],function(i,f,h,g,e,j,d,c){return(nf.ng.Canvas.OperateCtrl=b(i,f,h,g,e,j,d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.Canvas.OperateCtrl=b(require("jquery"),require("d3"),require("nf.Dialog"),require("nf.Birdseye"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.Client"),require("nf.Processor")))}else{nf.ng.Canvas.OperateCtrl=b(a.$,a.d3,a.nf.Dialog,a.nf.Birdseye,a.nf.CanvasUtils,a.nf.Common,a.nf.Client,a.nf.Processor)}}}(this,function(g,d,f,e,c,h,b,a){return function(){var j=function(){var l=g("#fill-color-value").val();if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(l)){g("#fill-color").minicolors("value",l)}};function i(){this.template={modal:{getElement:function(){return g("#new-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Create Template"})},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.templateUpload={modal:{getElement:function(){return g("#upload-template-dialog")},init:function(){var l=g("#template-upload-form").ajaxForm({url:"../nifi-api/process-groups/",dataType:"xml",beforeSubmit:function(o,m,n){n.url+=(encodeURIComponent(c.getGroupId())+"/templates/upload")},success:function(m,p,q,o){if(m.documentElement.tagName==="templateEntity"){f.showOkDialog({headerText:"Success",dialogContent:"Template successfully imported."})}else{var p="Unable to import template. Please check the log for errors.";if(m.documentElement.tagName==="errorResponse"){var n=m.documentElement.getAttribute("statusText");if(!h.isBlank(n)){p=n}}f.showOkDialog({headerText:"Unable to Upload",dialogContent:h.escapeHtml(p)})}},error:function(o,n,m){f.showOkDialog({headerText:"Unable to Upload",dialogContent:h.escapeHtml(o.responseText)})}});this.getElement().modal({headerText:"Upload Template",buttons:[{buttonText:"Upload",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var m=g("#selected-template-name").text();if(h.isBlank(m)){g("#upload-template-status").text("No template selected. Please browse to select a template.")}else{l.submit();g("#upload-template-dialog").modal("hide")}}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#upload-template-dialog").modal("hide")}}}],handler:{close:function(){g("#selected-template-name").text("");g("#upload-template-status").text("");l.resetForm()}}});g("#template-file-field-button").on("click",function(m){g("#template-file-field").click()});g("#template-file-field").on("change",function(n){var m=g(this).val();if(!h.isBlank(m)){m=m.replace(/^.*[\\\/]/,"")}g("#selected-template-name").text(m);g("#upload-template-status").text("")})},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}};this.fillcolor={modal:{getElement:function(){return g("#fill-color-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Change Color",buttons:[{buttonText:"Apply",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var l=c.getSelection();l.each(function(q){var o=d.select(this);var p=o.datum();var n=g("#fill-color").minicolors("value");if(n!==p.component.style["background-color"]){var m={revision:b.getRevision(p),component:{id:p.id,style:{"background-color":n}}};g.ajax({type:"PUT",url:p.uri,data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(r){c.getComponentByType(p.type).set(r)}).fail(function(t,r,s){if(t.status===400||t.status===404||t.status===409){f.showOkDialog({headerText:"Error",dialogContent:h.escapeHtml(t.responseText)})}}).always(function(){e.refresh()})}});g("#fill-color-dialog").modal("hide")}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){g("#fill-color-dialog").modal("hide")}}}],handler:{close:function(){g("#fill-color-value").val("");g("#fill-color").minicolors("value","")}}})},update:function(m,l){this.getElement().modal(m,l)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")},minicolors:{getElement:function(){return g("#fill-color")},init:function(){this.getElement().minicolors({inline:true,change:function(m,l){g("#fill-color-value").val(m);if(m.toLowerCase()==="#ffffff"){g("#fill-color-processor-preview-icon").css({color:a.defaultIconColor(),"background-color":m})}else{g("#fill-color-processor-preview-icon").css({color:h.determineContrastColor(h.substringAfterLast(m,"#")),"background-color":m})}var n=m;if(n.toLowerCase()==="#ffffff"){n="rgba(0,0,0,0.25)"}g("#fill-color-processor-preview").css({"border-color":n});g("#fill-color-label-preview").css({background:m});g("#fill-color-label-preview-value").css("color",h.determineContrastColor(h.substringAfterLast(m,"#")))}});g("#fill-color-value").on("blur",j).on("keyup",function(m){var l=m.keyCode?m.keyCode:m.which;if(l===g.ui.keyCode.ENTER){j()}})}}}}}i.prototype={constructor:i,init:function(){this.template.modal.init();this.templateUpload.modal.init();this.fillcolor.modal.init();this.fillcolor.modal.minicolors.init()}};var k=new i();return k}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(h,e,k,c,i,f,j,g,d){return(nf.ng.ProcessorComponent=b(h,e,k,c,i,f,j,g,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.ProcessorComponent=b(require("jquery"),require("Slick"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.ProcessorComponent=b(a.$,a.Slick,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,c,i,a,g,d,h,e,b){return function(l){var o=function(){var u=f("#processor-types-table").data("gridInstance");if(b.isDefinedAndNotNull(u)){var v=u.getData();v.setFilterArgs({searchString:s()});v.refresh();f("#new-processor-dialog").modal("refreshButtons");if(v.getLength()>0){u.setSelectedRows([0])}}};var q=function(w,v){if(v.searchString===""){return true}try{var z=new RegExp(v.searchString,"i")}catch(y){return false}var x=w.label.search(z)>=0;var u=w.tags.search(z)>=0;return x||u};var j=function(D,y){var B=q(D,y);var x=true;if(B){var C=f("#processor-tag-cloud").tagcloud("getSelectedTags");var A=C.length>0;if(A){x=k(C,D.tags)}}var z=true;if(B&&x){var u=f("#processor-bundle-group-combo").combo("getSelectedOption");if(b.isDefinedAndNotNull(u)&&u.value!==""){z=(D.bundle.group===u.value)}}var v=B&&x&&z;if(v===false&&f("#selected-processor-type").text()===D.type){f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var w=f("#processor-types-table").data("gridInstance");w.resetActiveCell()}return v};var k=function(w,u){var v=[];f.each(w,function(z,A){v.push(A)});var x=u.toLowerCase();var y=true;f.each(v,function(z,A){if(x.indexOf(A)===-1){y=false;return false}});return y};var s=function(){return f("#processor-type-filter").val()};var m=function(){f("#processor-tag-cloud").tagcloud("clearSelectedTags");f("#processor-bundle-group-combo").combo("setSelectedOption",{value:""});f("#processor-type-filter").val("");o();f("#processor-type-description").attr("title","").text("");f("#processor-type-name").attr("title","").text("");f("#processor-type-bundle").attr("title","").text("");f("#selected-processor-name").text("");f("#selected-processor-type").text("").removeData("bundle");var u=f("#processor-types-table").data("gridInstance");u.setSelectedRows([]);u.resetActiveCell()};var p=function(v,y,u,w){var x={revision:i.getRevision({revision:{version:0}}),component:{type:y,bundle:u,name:v,position:{x:w.x,y:w.y}}};f.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(d.getGroupId())+"/processors",data:JSON.stringify(x),dataType:"json",contentType:"application/json"}).done(function(z){g.add({processors:[z]},{selectAll:true});g.updateVisibility();a.refresh()}).fail(h.handleAjaxError)};var n=function(u){return b.isBlank(u.usageRestriction)||b.canAccessRestrictedComponents()};function t(){this.icon="icon icon-processor";this.hoverIcon="icon icon-processor-add";this.modal={filter:{init:function(){var v=[{id:"type",name:"Type",field:"label",formatter:b.typeFormatter,sortable:true,resizable:true},{id:"version",name:"Version",field:"version",formatter:b.typeVersionFormatter,sortable:true,resizable:true},{id:"tags",name:"Tags",field:"tags",sortable:true,resizable:true,formatter:b.genericValueFormatter}];var x={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,autoEdit:false,multiSelect:false,rowHeight:24};var w=new c.Data.DataView({inlineFilters:false});w.setItems([]);w.setFilterArgs({searchString:s()});w.setFilter(j);b.sortType({columnId:"type",sortAsc:true},w);var u=new c.Grid("#processor-types-table",w,v,x);u.setSelectionModel(new c.RowSelectionModel());u.registerPlugin(new c.AutoTooltips());u.setSortColumn("type",true);u.onSort.subscribe(function(z,y){b.sortType({columnId:y.sortCol.field,sortAsc:y.sortAsc},w)});u.onSelectedRowsChanged.subscribe(function(C,A){if(f.isArray(A.rows)&&A.rows.length===1){var y=A.rows[0];var D=u.getDataItem(y);if(b.isDefinedAndNotNull(D)){if(b.isBlank(D.description)){f("#processor-type-description").attr("title","").html('<span class="unset">No description specified</span>')}else{f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).html(D.description).ellipsis()}var z=b.formatBundle(D.bundle);var B=b.formatType(D);f("#processor-type-name").text(B).attr("title",B);f("#processor-type-bundle").text(z).attr("title",z);f("#selected-processor-name").text(D.label);f("#selected-processor-type").text(D.type).data("bundle",D.bundle);f("#new-processor-dialog").modal("refreshButtons")}}});u.onViewportChanged.subscribe(function(z,y){b.cleanUpTooltips(f("#processor-types-table"),"div.view-usage-restriction")});w.onRowCountChanged.subscribe(function(z,y){u.updateRowCount();u.render();f("#displayed-processor-types").text(y.current)});w.onRowsChanged.subscribe(function(z,y){u.invalidateRows(y.rows);u.render()});w.syncGridSelection(u,false);f("#processor-types-table").data("gridInstance",u).on("mouseenter","div.slick-cell",function(A){var B=f(this).find("div.view-usage-restriction");if(B.length&&!B.data("qtip")){var z=f(this).find("span.row-id").text();var y=w.getItemById(z);if(b.isDefinedAndNotNull(y.usageRestriction)){B.qtip(f.extend({},b.config.tooltipConfig,{content:y.usageRestriction,position:{container:f("#summary"),at:"bottom right",my:"top left",adjust:{x:4,y:4}}}))}}});f.ajax({type:"GET",url:l.headerCtrl.toolboxCtrl.config.urls.processorTypes,dataType:"json"}).done(function(z){var B=[];var y=d3.set();w.beginUpdate();f.each(z.processorTypes,function(C,E){var D=E.type;y.add(E.bundle.group);w.addItem({id:C,label:b.substringAfterLast(D,"."),type:D,bundle:E.bundle,description:b.escapeHtml(E.description),usageRestriction:b.escapeHtml(E.usageRestriction),tags:E.tags.join(", ")});f.each(E.tags,function(G,F){B.push(F.toLowerCase())})});w.endUpdate();w.reSort();u.invalidate();f("#total-processor-types, #displayed-processor-types").text(z.processorTypes.length);f("#processor-tag-cloud").tagcloud({tags:B,select:o,remove:o});var A=[{text:"all groups",value:""}];y.forEach(function(C){A.push({text:C,value:C})});f("#processor-bundle-group-combo").combo({options:A,select:o})}).fail(h.handleAjaxError)}},getElement:function(){return f("#new-processor-dialog")},init:function(){this.filter.init();this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Processor",handler:{resize:function(){f("#processor-type-description").width(f("#processor-description-container").innerWidth()-1).text(f("#processor-type-description").attr("title")).ellipsis()}}})},update:function(v,u){this.getElement().modal(v,u)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}t.prototype={constructor:t,getElement:function(){return f("#processor-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(u){this.promptForProcessorType(u)},dragIcon:function(u){return f('<div class="icon icon-processor-add"></div>')},promptForProcessorType:function(z){var u=this;var y=function(){var B=f("#selected-processor-name").text();var C=f("#selected-processor-type").text();var A=f("#selected-processor-type").data("bundle");if(B===""||C===""){e.showOkDialog({headerText:"Add Processor",dialogContent:"The type of processor to create must be selected."})}else{p(B,C,A,z)}u.modal.hide()};var x=f("#processor-types-table").data("gridInstance");var v=x.getData();var w=function(B,A){var C=x.getDataItem(A.row);if(n(C)){f("#selected-processor-name").text(C.label);f("#selected-processor-type").text(C.type).data("bundle",C.bundle);y()}};x.onDblClick.subscribe(w);this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},disabled:function(){var A=x.getSelectedRows();if(A.length>0){var B=x.getDataItem(A[0]);return n(B)===false}else{return v.getLength()===0}},handler:{click:y}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){f("#new-processor-dialog").modal("hide")}}}]);this.modal.update("setCloseHandler",function(){x.onDblClick.unsubscribe(w);m()});this.modal.show();f("#processor-type-filter").focus().off("keyup").on("keyup",function(D){var C=D.keyCode?D.keyCode:D.which;if(C===f.ui.keyCode.ENTER){var A=x.getSelectedRows();if(A.length>0){var B=x.getDataItem(A[0]);if(n(B)){y()}}}else{o()}});x.resizeCanvas();if(v.getLength()>0){x.setSelectedRows([0])}}};var r=new t();return r}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(g,d,f,c,e,h){return(nf.ng.InputPortComponent=b(g,d,f,c,e,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.InputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.InputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(e,b,d,a,c,f){return function(j){var i=function(m,l){var k={revision:b.getRevision({revision:{version:0}}),component:{name:m,position:{x:l.x,y:l.y}}};e.ajax({type:"POST",url:j.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/input-ports",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(n){a.add({inputPorts:[n]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)};function g(){this.icon="icon icon-port-in";this.hoverIcon="icon icon-port-in-add";this.modal={getElement:function(){return e("#new-port-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Port",handler:{close:function(){e("#new-port-name").val("")}}})},update:function(l,k){this.getElement().modal(l,k)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}g.prototype={constructor:g,getElement:function(){return e("#port-in-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.promptForInputPortName(k)},dragIcon:function(k){return e('<div class="icon icon-port-in-add"></div>')},promptForInputPortName:function(m){var l=this;var k=function(){var n=e("#new-port-name").val();l.modal.hide();i(n,m)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:k}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){l.modal.hide()}}}]);e("#new-port-type").text("Input");this.modal.show();e("#new-port-name").focus().off("keyup").on("keyup",function(o){var n=o.keyCode?o.keyCode:o.which;if(n===e.ui.keyCode.ENTER){k()}})}};var h=new g();return h}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(g,d,f,c,e,h){return(nf.ng.OutputPortComponent=b(g,d,f,c,e,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.OutputPortComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.OutputPortComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(e,b,d,a,c,f){return function(j){var h=function(m,l){var k={revision:b.getRevision({revision:{version:0}}),component:{name:m,position:{x:l.x,y:l.y}}};e.ajax({type:"POST",url:j.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/output-ports",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(n){a.add({outputPorts:[n]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)};function g(){this.icon="icon icon-port-out";this.hoverIcon="icon icon-port-out-add";this.modal={getElement:function(){return e("#new-port-dialog")},init:function(){},update:function(l,k){this.getElement().modal(l,k)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}g.prototype={constructor:g,getElement:function(){return e("#port-out-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.promptForOutputPortName(k)},dragIcon:function(k){return e('<div class="icon icon-port-out-add"></div>')},promptForOutputPortName:function(l){var m=this;var k=function(){var n=e("#new-port-name").val();m.modal.hide();h(n,l)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:k}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){m.modal.hide()}}}]);e("#new-port-type").text("Output");this.modal.show();e("#new-port-name").focus().off("keyup").on("keyup",function(o){var n=o.keyCode?o.keyCode:o.which;if(n===e.ui.keyCode.ENTER){k()}})}};var i=new g();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(g,d,f,c,e,h){return(nf.ng.GroupComponent=b(g,d,f,c,e,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.GroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.GroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(e,b,d,a,c,f){return function(j){var i=function(m,l){var k={revision:b.getRevision({revision:{version:0}}),component:{name:m,position:{x:l.x,y:l.y}}};return e.ajax({type:"POST",url:j.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/process-groups",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(n){a.add({processGroups:[n]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)};function g(){this.icon="icon icon-group";this.hoverIcon="icon icon-group-add";this.modal={getElement:function(){return e("#new-process-group-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Process Group",handler:{close:function(){e("#new-process-group-name").val("")}}})},update:function(l,k){this.getElement().modal(l,k)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}g.prototype={constructor:g,getElement:function(){return e("#group-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.promptForGroupName(k)},dragIcon:function(k){return e('<div class="icon icon-group-add"></div>')},promptForGroupName:function(l){var k=this;return e.Deferred(function(m){var n=function(){var o=e("#new-process-group-name").val();k.modal.hide();i(o,l).done(function(p){m.resolve(p.component)}).fail(function(){m.reject()})};k.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:n}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){m.reject();k.modal.hide()}}}]);k.modal.show();e("#new-process-group-name").focus().off("keyup").on("keyup",function(p){var o=p.keyCode?p.keyCode:p.which;if(o===e.ui.keyCode.ENTER){n()}})}).promise()}};var h=new g();return h}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(h,d,f,c,e,j,g,i){return(nf.ng.RemoteProcessGroupComponent=b(h,d,f,c,e,j,g,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.RemoteProcessGroupComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.RemoteProcessGroupComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,d,a,c,h,e,g){return function(l){var k=function(n){var m={revision:b.getRevision({revision:{version:0}}),component:{targetUris:f("#new-remote-process-group-uris").val(),position:{x:n.x,y:n.y},communicationsTimeout:f("#new-remote-process-group-timeout").val(),yieldDuration:f("#new-remote-process-group-yield-duration").val(),transportProtocol:f("#new-remote-process-group-transport-protocol-combo").combo("getSelectedOption").value,localNetworkInterface:f("#new-remote-process-group-local-network-interface").val(),proxyHost:f("#new-remote-process-group-proxy-host").val(),proxyPort:f("#new-remote-process-group-proxy-port").val(),proxyUser:f("#new-remote-process-group-proxy-user").val(),proxyPassword:f("#new-remote-process-group-proxy-password").val()}};f.ajax({type:"POST",url:l.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/remote-process-groups",data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(o){a.add({remoteProcessGroups:[o]},{selectAll:true});f("#new-remote-process-group-dialog").modal("hide");a.updateVisibility();d.refresh()}).fail(function(r,o,p){if(r.status===400){var s=r.responseText.split("\n");var q;if(s.length===1){q=f("<span></span>").text(s[0])}else{q=g.formatUnorderedList(s)}e.showOkDialog({dialogContent:q,headerText:"Configuration Error"})}else{h.handleAjaxError(r,o,p)}})};function j(){this.icon="icon icon-group-remote";this.hoverIcon="icon icon-group-remote-add";this.modal={getElement:function(){return f("#new-remote-process-group-dialog")},init:function(){var m="30 sec";var n="10 sec";this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Remote Process Group",handler:{close:function(){f("#new-remote-process-group-uris").val("");f("#new-remote-process-group-timeout").val(m);f("#new-remote-process-group-yield-duration").val(n);f("#new-remote-process-group-transport-protocol-combo").combo("setSelectedOption",{value:"RAW"});f("#new-remote-process-group-local-network-interface").val("");f("#new-remote-process-group-proxy-host").val("");f("#new-remote-process-group-proxy-port").val("");f("#new-remote-process-group-proxy-user").val("");f("#new-remote-process-group-proxy-password").val("")}}});f("#new-remote-process-group-timeout").val(m);f("#new-remote-process-group-yield-duration").val(n);f("#new-remote-process-group-transport-protocol-combo").combo({options:[{text:"RAW",value:"RAW"},{text:"HTTP",value:"HTTP"}]})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}j.prototype={constructor:j,getElement:function(){return f("#group-remote-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(m){this.promptForRemoteProcessGroupUri(m)},dragIcon:function(m){return f('<div class="icon icon-group-remote-add"></div>')},promptForRemoteProcessGroupUri:function(o){var m=this;var n=function(){k(o)};this.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:n}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){m.modal.hide()}}}]);this.modal.show();f("#new-remote-process-group-uris").focus().off("keyup").on("keyup",function(q){var p=q.keyCode?q.keyCode:q.which;if(p===f.ui.keyCode.ENTER){n()}})}};var i=new j();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler"],function(g,d,f,c,e,h){return(nf.ng.FunnelComponent=b(g,d,f,c,e,h))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.FunnelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler")))}else{nf.ng.FunnelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler)}}}(this,function(e,b,d,a,c,f){return function(h){function g(){this.icon="icon icon-funnel";this.hoverIcon="icon icon-funnel-add"}g.prototype={constructor:g,getElement:function(){return e("#funnel-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(j){this.createFunnel(j)},dragIcon:function(j){return e('<div class="icon icon-funnel-add"></div>')},createFunnel:function(k){var j={revision:b.getRevision({revision:{version:0}}),component:{position:{x:k.x,y:k.y}}};e.ajax({type:"POST",url:h.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/funnels",data:JSON.stringify(j),dataType:"json",contentType:"application/json"}).done(function(l){a.add({funnels:[l]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)}};var i=new g();return i}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Dialog","nf.Common"],function(h,d,f,c,e,j,g,i){return(nf.ng.TemplateComponent=b(h,d,f,c,e,j,g,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.TemplateComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Dialog"),require("nf.Common")))}else{nf.ng.TemplateComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Dialog,a.nf.Common)}}}(this,function(f,b,d,a,c,h,e,g){return function(k){var j=function(n,o){var m={templateId:n,originX:o.x,originY:o.y};f.ajax({type:"POST",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/template-instance",data:JSON.stringify(m),dataType:"json",contentType:"application/json"}).done(function(p){a.add(p.flow,{selectAll:true});a.updateVisibility();d.refresh()}).fail(h.handleAjaxError)};function i(){this.icon="icon icon-template";this.hoverIcon="icon icon-template-add";this.modal={getElement:function(){return f("#instantiate-template-dialog")},init:function(){this.getElement().modal({scrollableContentStyle:"scrollable",headerText:"Add Template"})},update:function(n,m){this.getElement().modal(n,m)},show:function(){this.getElement().modal("show")},hide:function(){this.getElement().modal("hide")}}}i.prototype={constructor:i,getElement:function(){return f("#template-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(m){this.promptForTemplate(m)},dragIcon:function(m){return f('<div class="icon icon-template-add"></div>')},promptForTemplate:function(m){var n=this;f.ajax({type:"GET",url:k.headerCtrl.toolboxCtrl.config.urls.api+"/flow/templates",dataType:"json"}).done(function(o){var q=o.templates;if(g.isDefinedAndNotNull(q)&&q.length>0){q=q.sort(function(s,r){var u=g.parseDateTime(s.template.timestamp);var t=g.parseDateTime(r.template.timestamp);return t.getTime()-u.getTime()});var p=[];f.each(q,function(r,s){if(s.permissions.canRead===true){p.push({text:s.template.name,value:s.id,description:g.escapeHtml(s.template.description)})}});f("#available-templates").combo({maxHeight:300,options:p});n.modal.update("setButtonModel",[{buttonText:"Add",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){var s=f("#available-templates").combo("getSelectedOption");var r=s.value;n.modal.hide();j(r,m)}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){n.modal.hide()}}}]);n.modal.show()}else{e.showOkDialog({headerText:"Instantiate Template",dialogContent:"No templates have been loaded into this NiFi."})}}).fail(h.handleAjaxError)}};var l=new i();return l}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","nf.Client","nf.Birdseye","nf.Graph","nf.CanvasUtils","nf.ErrorHandler","nf.Label"],function(g,d,f,c,e,h,i){return(nf.ng.LabelComponent=b(g,d,f,c,e,h,i))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.LabelComponent=b(require("jquery"),require("nf.Client"),require("nf.Birdseye"),require("nf.Graph"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Label")))}else{nf.ng.LabelComponent=b(a.$,a.nf.Client,a.nf.Birdseye,a.nf.Graph,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Label)}}}(this,function(e,b,d,a,c,f,g){return function(j){function i(){this.icon="icon icon-label";this.hoverIcon="icon icon-label-add"}i.prototype={constructor:i,getElement:function(){return e("#label-component")},enabled:function(){this.getElement().attr("disabled",false)},disabled:function(){this.getElement().attr("disabled",true)},dropHandler:function(k){this.createLabel(k)},dragIcon:function(k){return e('<div class="icon icon-label-add"></div>')},createLabel:function(l){var k={revision:b.getRevision({revision:{version:0}}),component:{width:g.config.width,height:g.config.height,position:{x:l.x,y:l.y}}};e.ajax({type:"POST",url:j.headerCtrl.toolboxCtrl.config.urls.api+"/process-groups/"+encodeURIComponent(c.getGroupId())+"/labels",data:JSON.stringify(k),dataType:"json",contentType:"application/json"}).done(function(m){a.add({labels:[m]},{selectAll:true});a.updateVisibility();d.refresh()}).fail(f.handleAjaxError)}};var h=new i();return h}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.BreadcrumbsDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.BreadcrumbsDirective=b())}else{nf.ng.BreadcrumbsDirective=b()}}}(this,function(){return function(a){return{restrict:"E",templateUrl:"views/nf-ng-breadcrumbs-directive-view.html",scope:{breadcrumbs:"=",clickFunc:"=",highlightCrumbId:"=",separatorFunc:"="},link:function(d,c,b){a.registerMouseWheelEvent(c)}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.DraggableDirective=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.DraggableDirective=b())}else{nf.ng.DraggableDirective=b()}}}(this,function(){return function(){return{restrict:"AE",link:function(c,b,a){b.draggable(c.$eval(a.nfDraggable))}}}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["nf.ng.Bridge","nf.Common","nf.CanvasUtils","nf.ClusterSummary","nf.Actions"],function(e,f,g,c,d){return(nf.ng.AppCtrl=b(e,f,g,c,d))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppCtrl=b(require("nf.ng.Bridge"),require("nf.CanvasUtils"),require("nf.Common"),require("nf.ClusterSummary"),require("nf.Actions")))}else{nf.ng.AppCtrl=b(a.nf.ng.Bridge,a.nf.CanvasUtils,a.nf.Common,a.nf.ClusterSummary,a.nf.Actions)}}}(this,function(c,d,e,a,b){return function(g,i){function f(j){this.nf={Common:e,ClusterSummary:a,Actions:b,CanvasUtils:d,};this.serviceProvider=j}f.prototype={constructor:f};var h=new f(i);g.appCtrl=h;c.rootScope=g}}));
(function(a,b){if(typeof define==="function"&&define.amd){define([],function(){return(nf.ng.AppConfig=b())})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.ng.AppConfig=b())}else{nf.ng.AppConfig=b()}}}(this,function(){return function(a,b){b.debugInfoEnabled(false);a.definePalette("basePalette",{"50":"728E9B","100":"728E9B","200":"004849","300":"775351","400":"728E9B","500":"728E9B","600":"728E9B","700":"728E9B","800":"728E9B","900":"rgba(249,250,251,0.97)",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("tintPalette",{"50":"728E9B","100":"728E9B","200":"CCDADB","300":"728E9B","400":"AABBC3","500":"728E9B","600":"C7D2D7","700":"728E9B","800":"E3E8EB","900":"728E9B",A100:"728E9B",A200:"728E9B",A400:"728E9B",A700:"728E9B",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.definePalette("warnPalette",{"50":"BA554A","100":"BA554A","200":"BA554A","300":"BA554A","400":"BA554A","500":"BA554A","600":"BA554A","700":"BA554A","800":"BA554A","900":"BA554A",A100:"BA554A",A200:"BA554A",A400:"BA554A",A700:"BA554A",contrastDefaultColor:"light",contrastDarkColors:["A100"],contrastLightColors:undefined});a.theme("default").primaryPalette("basePalette",{"default":"500","hue-1":"200","hue-2":"300","hue-3":"900"}).accentPalette("tintPalette",{"default":"200","hue-1":"400","hue-2":"600","hue-3":"800"}).warnPalette("warnPalette",{"default":"500"})}}));
(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","angular","nf.Common","nf.CanvasUtils","nf.ErrorHandler","nf.Client","nf.ClusterSummary","nf.Dialog","nf.Storage","nf.Canvas","nf.Graph","nf.ContextMenu","nf.Shell","nf.Settings","nf.Snippet","nf.Actions","nf.QueueListing","nf.ComponentState","nf.ComponentVersion","nf.Draggable","nf.Connectable","nf.StatusHistory","nf.Birdseye","nf.ConnectionConfiguration","nf.ControllerService","nf.ReportingTask","nf.PolicyManagement","nf.ProcessorConfiguration","nf.ProcessGroupConfiguration","nf.ControllerServices","nf.RemoteProcessGroupConfiguration","nf.RemoteProcessGroupPorts","nf.PortConfiguration","nf.LabelConfiguration","nf.ProcessorDetails","nf.PortDetails","nf.ConnectionDetails","nf.RemoteProcessGroupDetails","nf.GoTo","nf.ng.Bridge","nf.ng.AppCtrl","nf.ng.AppConfig","nf.ng.ServiceProvider","nf.ng.BreadcrumbsCtrl","nf.ng.Canvas.HeaderCtrl","nf.ng.Canvas.FlowStatusCtrl","nf.ng.Canvas.GlobalMenuCtrl","nf.ng.Canvas.ToolboxCtrl","nf.ng.ProcessorComponent","nf.ng.InputPortComponent","nf.ng.OutputPortComponent","nf.ng.GroupComponent","nf.ng.RemoteProcessGroupComponent","nf.ng.FunnelComponent","nf.ng.TemplateComponent","nf.ng.LabelComponent","nf.ng.Canvas.GraphControlsCtrl","nf.ng.Canvas.NavigateCtrl","nf.ng.Canvas.OperateCtrl","nf.ng.BreadcrumbsDirective","nf.ng.DraggableDirective"],function(N,B,Y,ai,f,m,V,p,y,E,w,F,X,S,C,aj,K,h,z,A,M,ac,l,u,Z,O,G,ah,Q,T,L,c,P,H,d,x,v,ab,k,s,j,J,aa,o,g,e,r,ae,W,D,I,ak,ad,ag,U,t,R,i,af,n,q){return b(N,B,Y,ai,f,m,V,p,y,E,w,F,X,S,C,aj,K,h,z,A,M,ac,l,u,Z,O,G,ah,Q,T,L,c,P,H,d,x,v,ab,k,s,j,J,aa,o,g,e,r,ae,W,D,I,ak,ad,ag,U,t,R,i,af,n,q)})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=b(require("jquery"),require("angular"),require("nf.Common"),require("nf.CanvasUtils"),require("nf.ErrorHandler"),require("nf.Client"),require("nf.ClusterSummary"),require("nf.Dialog"),require("f.Storage"),require("nf.Canvas"),require("nf.Graph"),require("nf.ContextMenu"),require("nf.Shell"),require("nf.Settings"),require("nf.Actions"),require("nf.Snippet"),require("nf.QueueListing"),require("nf.ComponentState"),require("nf.ComponentVersion"),require("nf.Draggable"),require("nf.Connectable"),require("nf.StatusHistory"),require("nf.Birdseye"),require("nf.ConnectionConfiguration"),require("nf.ControllerService"),require("nf.ReportingTask"),require("nf.PolicyManagement"),require("nf.ProcessorConfiguration"),require("nf.ProcessGroupConfiguration"),require("nf.ControllerServices"),require("nf.RemoteProcessGroupConfiguration"),require("nf.RemoteProcessGroupPorts"),require("nf.PortConfiguration"),require("nf.LabelConfiguration"),require("nf.ProcessorDetails"),require("nf.PortDetails"),require("nf.ConnectionDetails"),require("nf.RemoteProcessGroupDetails"),require("nf.GoTo"),require("nf.ng.Bridge"),require("nf.ng.AppCtrl"),require("nf.ng.AppConfig"),require("nf.ng.ServiceProvider"),require("nf.ng.BreadcrumbsCtrl"),require("nf.ng.Canvas.HeaderCtrl"),require("nf.ng.Canvas.FlowStatusCtrl"),require("nf.ng.Canvas.GlobalMenuCtrl"),require("nf.ng.Canvas.ToolboxCtrl"),require("nf.ng.ProcessorComponent"),require("nf.ng.InputPortComponent"),require("nf.ng.OutputPortComponent"),require("nf.ng.GroupComponent"),require("nf.ng.RemoteProcessGroupComponent"),require("nf.ng.FunnelComponent"),require("nf.ng.TemplateComponent"),require("nf.ng.LabelComponent"),require("nf.ng.Canvas.GraphControlsCtrl"),require("nf.ng.Canvas.NavigateCtrl"),require("nf.ng.Canvas.OperateCtrl"),require("nf.ng.BreadcrumbsDirective"),require("nf.ng.DraggableDirective"))}else{b(a.$,a.angular,a.nf.Common,a.nf.CanvasUtils,a.nf.ErrorHandler,a.nf.Client,a.nf.ClusterSummary,a.nf.Dialog,a.nf.Storage,a.nf.Canvas,a.nf.Graph,a.nf.ContextMenu,a.nf.Shell,a.nf.Settings,a.nf.Actions,a.nf.Snippet,a.nf.QueueListing,a.nf.ComponentState,a.nf.ComponentVersion,a.nf.Draggable,a.nf.Connectable,a.nf.StatusHistory,a.nf.Birdseye,a.nf.ConnectionConfiguration,a.nf.ControllerService,a.nf.ReportingTask,a.nf.PolicyManagement,a.nf.ProcessorConfiguration,a.nf.ProcessGroupConfiguration,a.nf.ControllerServices,a.nf.RemoteProcessGroupConfiguration,a.nf.RemoteProcessGroupPorts,a.nf.PortConfiguration,a.nf.LabelConfiguration,a.nf.ProcessorDetails,a.nf.PortDetails,a.nf.ConnectionDetails,a.nf.RemoteProcessGroupDetails,a.nf.GoTo,a.nf.ng.Bridge,a.nf.ng.AppCtrl,a.nf.ng.AppConfig,a.nf.ng.ServiceProvider,a.nf.ng.BreadcrumbsCtrl,a.nf.ng.Canvas.HeaderCtrl,a.nf.ng.Canvas.FlowStatusCtrl,a.nf.ng.Canvas.GlobalMenuCtrl,a.nf.ng.Canvas.ToolboxCtrl,a.nf.ng.ProcessorComponent,a.nf.ng.InputPortComponent,a.nf.ng.OutputPortComponent,a.nf.ng.GroupComponent,a.nf.ng.RemoteProcessGroupComponent,a.nf.ng.FunnelComponent,a.nf.ng.TemplateComponent,a.nf.ng.LabelComponent,a.nf.ng.Canvas.GraphControlsCtrl,a.nf.ng.Canvas.NavigateCtrl,a.nf.ng.Canvas.OperateCtrl,a.nf.ng.BreadcrumbsDirective,a.nf.ng.DraggableDirective)}}}(this,function(L,z,X,ah,d,k,U,n,w,C,u,D,W,Q,A,ai,I,f,x,y,K,ab,j,s,Y,M,E,ag,O,S,J,a,N,F,b,v,t,aa,i,q,h,H,Z,m,e,c,p,ad,V,B,G,aj,ac,af,T,r,P,g,ae,l,o){var R={urls:{flowConfig:"../nifi-api/flow/config"}};L(document).ready(function(){if(C.SUPPORTS_SVG){var al=z.module("ngCanvasApp",["ngResource","ngRoute","ngMaterial","ngMessages"]);H.$inject=["$mdThemingProvider","$compileProvider"];h.$inject=["$scope","serviceProvider","$compile","headerCtrl","graphControlsCtrl"];Z.$inject=[];m.$inject=["serviceProvider"];e.$inject=["serviceProvider","toolboxCtrl","globalMenuCtrl","flowStatusCtrl"];c.$inject=["serviceProvider"];p.$inject=["serviceProvider"];ad.$inject=["processorComponent","inputPortComponent","outputPortComponent","groupComponent","remoteGroupComponent","funnelComponent","templateComponent","labelComponent"];V.$inject=["serviceProvider"];B.$inject=["serviceProvider"];G.$inject=["serviceProvider"];aj.$inject=["serviceProvider"];ac.$inject=["serviceProvider"];af.$inject=["serviceProvider"];T.$inject=["serviceProvider"];r.$inject=["serviceProvider"];P.$inject=["serviceProvider","navigateCtrl","operateCtrl"];g.$inject=[];ae.$inject=[];l.$inject=["breadcrumbsCtrl"];o.$inject=[];al.config(H);al.controller("ngCanvasAppCtrl",h);al.service("serviceProvider",Z);al.service("breadcrumbsCtrl",m);al.service("headerCtrl",e);al.service("flowStatusCtrl",c);al.service("globalMenuCtrl",p);al.service("toolboxCtrl",ad);al.service("processorComponent",V);al.service("inputPortComponent",B);al.service("outputPortComponent",G);al.service("groupComponent",aj);al.service("remoteGroupComponent",ac);al.service("funnelComponent",af);al.service("templateComponent",T);al.service("labelComponent",r);al.service("graphControlsCtrl",P);al.service("navigateCtrl",g);al.service("operateCtrl",ae);al.directive("nfBreadcrumbs",l);al.directive("nfDraggable",o);ah.init(C,A,ai,j,u);q.injector=z.bootstrap(L("body"),["ngCanvasApp"],{strictDi:true});var ak=C.init();ak.done(function(){var am=k.init();var an=L.ajax({type:"GET",url:R.urls.flowConfig,dataType:"json"});L.when(an,U.loadClusterSummary(),ak,am).done(function(aq){var ar=aq[0];var at=L("#canvas-container");C.CANVAS_OFFSET=at.offset().top;var ap=ar.flowConfiguration;if(U.isClustered()&&!U.isConnectedToCluster()){n.showDisconnectedFromClusterMessage()}var ao=parseInt(ap.autoRefreshIntervalSeconds,10);C.setConfigurableAuthorizer(ap.supportsConfigurableAuthorizer);w.init();C.initCanvas();C.View.init();D.init(A);W.init(D);q.injector.get("headerCtrl").init();Q.init();A.init();I.init();f.init();x.init(Q);y.init();K.init();ab.init(ap.timeOffset);j.init(u);s.init(j,u);Y.init(S);M.init(Q);E.init();ag.init();O.init(S);J.init();a.init();N.init();F.init();b.init(true);v.init();t.init();aa.init();i.init();u.init().done(function(){q.injector.get("graphControlsCtrl").init();var au=ao/2;setTimeout(function(){C.startPolling(ao)},au*1000);C.hideSplash()}).fail(d.handleAjaxError)}).fail(d.handleAjaxError)}).fail(d.handleAjaxError);L(".component-button").qtip(L.extend({},X.config.tooltipConfig))}else{L("#message-title").text("Unsupported Browser");L("#message-content").text("Flow graphs are shown using SVG. Please use a browser that supports rendering SVG.");L("#message-pane").show();C.hideSplash()}})}));
